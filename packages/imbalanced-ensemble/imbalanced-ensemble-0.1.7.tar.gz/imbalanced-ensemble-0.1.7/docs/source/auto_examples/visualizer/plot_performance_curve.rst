
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples\visualizer\plot_performance_curve.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_visualizer_plot_performance_curve.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_visualizer_plot_performance_curve.py:


=========================================================
Plot performance curves
=========================================================

This example illustrates how to use the 
:mod:`imbalanced_ensemble.visualizer` module to visualize or 
compare :mod:`imbalanced_ensemble.ensemble` classifier(s).

This example uses:

    - :class:`imbalanced_ensemble.ensemble.SelfPacedEnsembleClassifier`
    - :class:`imbalanced_ensemble.ensemble.EasyEnsembleClassifier`
    - :class:`imbalanced_ensemble.ensemble.BalancedRandomForestClassifier`
    - :class:`imbalanced_ensemble.ensemble.SMOTEBaggingClassifier`
    - :class:`imbalanced_ensemble.visualizer.ImbalancedEnsembleVisualizer`

.. GENERATED FROM PYTHON SOURCE LINES 18-23

.. code-block:: default


    # Authors: Zhining Liu <zhining.liu@outlook.com>
    # License: MIT









.. GENERATED FROM PYTHON SOURCE LINES 24-41

.. code-block:: default

    print(__doc__)

    from time import time

    # Import imbalanced_ensemble
    import imbalanced_ensemble as imbens

    # Import utilities from sklearn
    import sklearn
    from sklearn.datasets import make_classification
    from sklearn.model_selection import train_test_split

    RANDOM_STATE = 42

    # sphinx_gallery_thumbnail_number = 4









.. GENERATED FROM PYTHON SOURCE LINES 42-45

Prepare data
----------------------------
Make a toy 3-class imbalanced classification task.

.. GENERATED FROM PYTHON SOURCE LINES 45-55

.. code-block:: default


    # make dataset
    X, y = make_classification(n_classes=3, class_sep=2,
        weights=[0.1, 0.3, 0.6], n_informative=3, n_redundant=1, flip_y=0,
        n_features=20, n_clusters_per_class=2, n_samples=2000, random_state=0)

    # train valid split
    X_train, X_valid, y_train, y_valid = train_test_split(
        X, y, test_size=0.5, stratify=y, random_state=RANDOM_STATE)








.. GENERATED FROM PYTHON SOURCE LINES 56-59

Train ensemble classifiers
--------------------------
4 different ensemble classifiers are used.

.. GENERATED FROM PYTHON SOURCE LINES 59-81

.. code-block:: default


    init_kwargs = {'n_estimators': 50, 'random_state': RANDOM_STATE}
    fit_kwargs = {'X': X_train, 'y': y_train}

    # imbalanced_ensemble.ensemble classifiers
    ensemble_dict = {
        'SPE': imbens.ensemble.SelfPacedEnsembleClassifier(**init_kwargs),
        'EasyEns': imbens.ensemble.EasyEnsembleClassifier(**init_kwargs),
        'BalanceForest': imbens.ensemble.BalancedRandomForestClassifier(**init_kwargs),
        'SMOTEBagging': imbens.ensemble.SMOTEBaggingClassifier(**init_kwargs),
    }

    # Train all ensemble classifiers, store the results in fitted_ensembles
    fitted_ensembles = {}
    for clf_name, clf in ensemble_dict.items():
        start_time = time()
        clf.fit(**fit_kwargs)
        fit_time = time() - start_time
        fitted_ensembles[clf_name] = clf
        print ('Training {:^30s} | Time used: {:.3f}s'.format(clf.__name__, fit_time))






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Training  SelfPacedEnsembleClassifier   | Time used: 0.229s
    Training     EasyEnsembleClassifier     | Time used: 0.798s
    Training BalancedRandomForestClassifier | Time used: 0.110s
    Training     SMOTEBaggingClassifier     | Time used: 0.828s




.. GENERATED FROM PYTHON SOURCE LINES 82-87

Fit an ``ImbalancedEnsembleVisualizer``
-----------------------------------------------------
The visualizer fits on a ``dictionary`` like {..., ensemble_name: ensemble_classifier, ...}  
The keys should be strings corresponding to ensemble names.   
The values should be fitted ``imbalance_ensemble.ensemble`` or ``sklearn.ensemble`` estimator objects.

.. GENERATED FROM PYTHON SOURCE LINES 87-105

.. code-block:: default


    # Initialize visualizer
    visualizer = imbens.visualizer.ImbalancedEnsembleVisualizer(
        eval_datasets = {
            'training' : (X_train, y_train),
            'validation' : (X_valid, y_valid),
        },
        eval_metrics = {
            'acc': (sklearn.metrics.accuracy_score, {}),
            'balanced_acc': (sklearn.metrics.balanced_accuracy_score, {}),
            'weighted_f1': (sklearn.metrics.f1_score, {'average':'weighted'}),
        },
    )

    # Fit visualizer
    visualizer.fit(fitted_ensembles)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

      0%|                                                                                           | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model      SPE      on dataset  training  ::   0%|                        | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model      SPE      on dataset  training  :: 100%|#############| 50/50 [00:00<00:00, 1353.36it/s]
      0%|                                                                                           | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model      SPE      on dataset validation ::   0%|                        | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model      SPE      on dataset validation :: 100%|#############| 50/50 [00:00<00:00, 1351.28it/s]
      0%|                                                                                           | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model    EasyEns    on dataset  training  ::   0%|                        | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model    EasyEns    on dataset  training  ::  60%|########4     | 30/50 [00:00<00:00, 188.52it/s]    Visualizer evaluating model    EasyEns    on dataset  training  :: 100%|##############| 50/50 [00:00<00:00, 141.48it/s]    Visualizer evaluating model    EasyEns    on dataset  training  :: 100%|##############| 50/50 [00:00<00:00, 130.61it/s]
      0%|                                                                                           | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model    EasyEns    on dataset validation ::   0%|                        | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model    EasyEns    on dataset validation ::  60%|########4     | 30/50 [00:00<00:00, 183.45it/s]    Visualizer evaluating model    EasyEns    on dataset validation ::  80%|###########2  | 40/50 [00:00<00:00, 142.69it/s]    Visualizer evaluating model    EasyEns    on dataset validation :: 100%|##############| 50/50 [00:00<00:00, 115.94it/s]    Visualizer evaluating model    EasyEns    on dataset validation :: 100%|##############| 50/50 [00:00<00:00, 126.60it/s]
      0%|                                                                                           | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model BalanceForest on dataset  training  ::   0%|                        | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model BalanceForest on dataset  training  :: 100%|#############| 50/50 [00:00<00:00, 1460.42it/s]
      0%|                                                                                           | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model BalanceForest on dataset validation ::   0%|                        | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model BalanceForest on dataset validation :: 100%|#############| 50/50 [00:00<00:00, 1432.41it/s]
      0%|                                                                                           | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model SMOTEBagging  on dataset  training  ::   0%|                        | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model SMOTEBagging  on dataset  training  :: 100%|#############| 50/50 [00:00<00:00, 1114.16it/s]
      0%|                                                                                           | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model SMOTEBagging  on dataset validation ::   0%|                        | 0/50 [00:00<?, ?it/s]    Visualizer evaluating model SMOTEBagging  on dataset validation :: 100%|#############| 50/50 [00:00<00:00, 1180.80it/s]
    Visualizer computing confusion matrices........ Finished!

    <imbalanced_ensemble.visualizer.visualizer.ImbalancedEnsembleVisualizer object at 0x000001E1A470AE20>



.. GENERATED FROM PYTHON SOURCE LINES 106-109

Plot performance curve
----------------------
**Performance w.r.t. number of base estimators**

.. GENERATED FROM PYTHON SOURCE LINES 109-113

.. code-block:: default


    fig, axes = visualizer.performance_lineplot()





.. image:: /auto_examples/visualizer/images/sphx_glr_plot_performance_curve_001.png
    :alt: Performance Curves
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 114-117

Set x-axis
----------
(parameter ``n_samples_as_x_axis``: bool)

.. GENERATED FROM PYTHON SOURCE LINES 119-120

**Performance w.r.t. number of training samples**

.. GENERATED FROM PYTHON SOURCE LINES 120-126

.. code-block:: default


    fig, axes = visualizer.performance_lineplot(
        n_samples_as_x_axis=True,
    )





.. image:: /auto_examples/visualizer/images/sphx_glr_plot_performance_curve_002.png
    :alt: Performance Curves
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 127-130

Select results for visualization
--------------------------------
(parameter ``on_ensembles``: list of ensemble name, ``on_datasets``: list of dataset name, ``on_metrics``: list of metric name)

.. GENERATED FROM PYTHON SOURCE LINES 132-133

**Select: method ('SPE', 'SMOTEBagging'), data ('validation'), metric ('balanced_acc', 'weighted_f1')**

.. GENERATED FROM PYTHON SOURCE LINES 133-142

.. code-block:: default


    fig, axes = visualizer.performance_lineplot(
        on_ensembles=['SPE', 'EasyEns', 'BalanceForest'],
        on_datasets=['validation'],
        on_metrics=['balanced_acc', 'weighted_f1'],
        n_samples_as_x_axis=True,
    )





.. image:: /auto_examples/visualizer/images/sphx_glr_plot_performance_curve_003.png
    :alt: Performance Curves
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 143-146

Customize visual appearance
---------------------------
(parameter ``sub_figsize``: tuple, ``sup_title``: bool or string, kwargs of ``seaborn.lineplot()``)

.. GENERATED FROM PYTHON SOURCE LINES 146-164

.. code-block:: default


    fig, axes = visualizer.performance_lineplot(
        on_ensembles=['SPE', 'EasyEns', 'BalanceForest'],
        on_datasets=['training', 'validation'],
        on_metrics=['balanced_acc', 'weighted_f1'],
        n_samples_as_x_axis=True,
    
        # Customize visual appearance
        sub_figsize=(3, 4),
        sup_title='My Suptitle',
    
        # arguments pass down to seaborn.lineplot()
        linewidth=3,
        markers=True,
        alpha=0.8,
    )





.. image:: /auto_examples/visualizer/images/sphx_glr_plot_performance_curve_004.png
    :alt: My Suptitle
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 165-168

Group results
-------------
(parameter ``split_by``: list of {'method', 'dataset'})

.. GENERATED FROM PYTHON SOURCE LINES 170-171

**Group results by dataset**

.. GENERATED FROM PYTHON SOURCE LINES 171-183

.. code-block:: default


    fig, axes = visualizer.performance_lineplot(
        on_ensembles=['SPE', 'EasyEns', 'BalanceForest'],
        on_datasets=['training', 'validation'],
        on_metrics=['balanced_acc', 'weighted_f1'],
        n_samples_as_x_axis=True,
        sub_figsize=(3, 2.3),
    
        split_by=['dataset'], # Group results by dataset
    )





.. image:: /auto_examples/visualizer/images/sphx_glr_plot_performance_curve_005.png
    :alt: Performance Curves
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 184-185

**Group results by method**

.. GENERATED FROM PYTHON SOURCE LINES 185-195

.. code-block:: default


    fig, axes = visualizer.performance_lineplot(
        on_ensembles=['SPE', 'EasyEns', 'BalanceForest'],
        on_datasets=['training', 'validation'],
        on_metrics=['balanced_acc', 'weighted_f1'],
        n_samples_as_x_axis=True,
        sub_figsize=(3, 2.3),
    
        split_by=['method'], # Group results by method
    )



.. image:: /auto_examples/visualizer/images/sphx_glr_plot_performance_curve_006.png
    :alt: Performance Curves
    :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  49.964 seconds)

**Estimated memory usage:**  24 MB


.. _sphx_glr_download_auto_examples_visualizer_plot_performance_curve.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_performance_curve.py <plot_performance_curve.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_performance_curve.ipynb <plot_performance_curve.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
