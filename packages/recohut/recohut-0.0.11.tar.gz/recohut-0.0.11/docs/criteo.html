---

title: Criteo Dataset Transformation


keywords: fastai
sidebar: home_sidebar

summary: "Implementation of transformation functions specific to criteo ad-display dataset."
description: "Implementation of transformation functions specific to criteo ad-display dataset."
nb_path: "nbs/transforms/datasets/criteo.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/transforms/datasets/criteo.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sparseFeature" class="doc_header"><code>sparseFeature</code><a href="https://github.com/RecoHut-Projects/recohut/tree/master/recohut/transforms/datasets/criteo.py#L13" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sparseFeature</code>(<strong><code>feat</code></strong>, <strong><code>feat_num</code></strong>, <strong><code>embed_dim</code></strong>=<em><code>4</code></em>)</p>
</blockquote>
<p>create dictionary for sparse feature
:param feat: feature name
:param feat_num: the total number of sparse features that do not repeat
:param embed_dim: embedding dimension
:return:</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="denseFeature" class="doc_header"><code>denseFeature</code><a href="https://github.com/RecoHut-Projects/recohut/tree/master/recohut/transforms/datasets/criteo.py#L24" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>denseFeature</code>(<strong><code>feat</code></strong>)</p>
</blockquote>
<p>create dictionary for dense feature
:param feat: dense feature name
:return:</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_criteo_dataset" class="doc_header"><code>create_criteo_dataset</code><a href="https://github.com/RecoHut-Projects/recohut/tree/master/recohut/transforms/datasets/criteo.py#L33" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_criteo_dataset</code>(<strong><code>file</code></strong>, <strong><code>embed_dim</code></strong>=<em><code>8</code></em>, <strong><code>read_part</code></strong>=<em><code>True</code></em>, <strong><code>sample_num</code></strong>=<em><code>100000</code></em>, <strong><code>test_size</code></strong>=<em><code>0.2</code></em>)</p>
</blockquote>
<p>a example about creating criteo dataset
:param file: dataset's path
:param embed_dim: the embedding dimension of sparse features
:param read_part: whether to read part of it
:param sample_num: the number of instances if read_part is True
:param test_size: ratio of test dataset
:return: feature columns, train, test</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># !pip install --upgrade --force-reinstall --no-deps kaggle</span>
<span class="c1"># !mkdir ~/.kaggle</span>
<span class="c1"># !cp /content/drive/MyDrive/kaggle.json ~/.kaggle/</span>
<span class="c1"># !chmod 600 ~/.kaggle/kaggle.json</span>
<span class="c1"># !kaggle datasets download -d mrkmakr/criteo-dataset</span>
<span class="c1"># !unzip criteo-dataset.zip</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting kaggle
  Downloading kaggle-1.5.12.tar.gz (58 kB)
     |████████████████████████████████| 58 kB 2.7 MB/s 
Building wheels for collected packages: kaggle
  Building wheel for kaggle (setup.py) ... done
  Created wheel for kaggle: filename=kaggle-1.5.12-py3-none-any.whl size=73051 sha256=a09d2576937c68b6341e6bce9eeefa020563e125d97e69548f4d591568008b5f
  Stored in directory: /root/.cache/pip/wheels/62/d6/58/5853130f941e75b2177d281eb7e44b4a98ed46dd155f556dc5
Successfully built kaggle
Installing collected packages: kaggle
  Attempting uninstall: kaggle
    Found existing installation: kaggle 1.5.12
    Uninstalling kaggle-1.5.12:
      Successfully uninstalled kaggle-1.5.12
Successfully installed kaggle-1.5.12
Downloading criteo-dataset.zip to /content
100% 4.31G/4.31G [01:20&lt;00:00, 58.4MB/s]
100% 4.31G/4.31G [01:20&lt;00:00, 57.4MB/s]
Archive:  criteo-dataset.zip
  inflating: dac/readme.txt          
  inflating: dac/test.txt            
  inflating: dac/train.txt           
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;dac/train.txt&#39;</span>
<span class="n">read_part</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">sample_num</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="n">feature_columns</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">create_criteo_dataset</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
                                        <span class="n">read_part</span><span class="o">=</span><span class="n">read_part</span><span class="p">,</span>
                                        <span class="n">sample_num</span><span class="o">=</span><span class="n">sample_num</span><span class="p">,</span>
                                        <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">feature_columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C1&#39;, &#39;feat_num&#39;: 175},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C2&#39;, &#39;feat_num&#39;: 386},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C3&#39;, &#39;feat_num&#39;: 5521},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C4&#39;, &#39;feat_num&#39;: 4033},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C5&#39;, &#39;feat_num&#39;: 56},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C6&#39;, &#39;feat_num&#39;: 8},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C7&#39;, &#39;feat_num&#39;: 3184},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C8&#39;, &#39;feat_num&#39;: 93},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C9&#39;, &#39;feat_num&#39;: 3},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C10&#39;, &#39;feat_num&#39;: 2986},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C11&#39;, &#39;feat_num&#39;: 2084},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C12&#39;, &#39;feat_num&#39;: 5284},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C13&#39;, &#39;feat_num&#39;: 1725},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C14&#39;, &#39;feat_num&#39;: 24},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C15&#39;, &#39;feat_num&#39;: 2035},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C16&#39;, &#39;feat_num&#39;: 4724},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C17&#39;, &#39;feat_num&#39;: 9},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C18&#39;, &#39;feat_num&#39;: 1149},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C19&#39;, &#39;feat_num&#39;: 547},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C20&#39;, &#39;feat_num&#39;: 4},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C21&#39;, &#39;feat_num&#39;: 5037},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C22&#39;, &#39;feat_num&#39;: 8},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C23&#39;, &#39;feat_num&#39;: 12},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C24&#39;, &#39;feat_num&#39;: 2525},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C25&#39;, &#39;feat_num&#39;: 40},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;C26&#39;, &#39;feat_num&#39;: 1939},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;I1&#39;, &#39;feat_num&#39;: 100},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;I2&#39;, &#39;feat_num&#39;: 100},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;I3&#39;, &#39;feat_num&#39;: 100},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;I4&#39;, &#39;feat_num&#39;: 100},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;I5&#39;, &#39;feat_num&#39;: 100},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;I6&#39;, &#39;feat_num&#39;: 100},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;I7&#39;, &#39;feat_num&#39;: 100},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;I8&#39;, &#39;feat_num&#39;: 100},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;I9&#39;, &#39;feat_num&#39;: 100},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;I10&#39;, &#39;feat_num&#39;: 100},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;I11&#39;, &#39;feat_num&#39;: 100},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;I12&#39;, &#39;feat_num&#39;: 100},
 {&#39;embed_dim&#39;: 8, &#39;feat_name&#39;: &#39;I13&#39;, &#39;feat_num&#39;: 100}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([[   1,  293, 2491, ...,    0,    0,    1],
        [   1,   88,    0, ...,    1,    0,    1],
        [   1,   17, 5197, ...,    1,    0,    0],
        ...,
        [   1,  355, 4284, ...,    3,    0,    0],
        [   1,  192,   56, ...,    1,    0,    0],
        [  75,   18, 2613, ...,    3,    0,    0]], dtype=int32),
 array([0, 0, 0, ..., 0, 0, 0], dtype=int32))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([[ 111,  105,  695, ...,    3,    0,    0],
        [ 102,  337, 2613, ...,    0,    0,    1],
        [  75,  301,  155, ...,    1,    0,    0],
        ...,
        [  75,   86,  507, ...,    1,    1,    1],
        [   1,  347, 2205, ...,    2,    1,    1],
        [ 102,  125,    5, ...,    1,    1,    0]], dtype=int32),
 array([1, 0, 1, ..., 0, 0, 0], dtype=int32))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

