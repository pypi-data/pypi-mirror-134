---

title: recohut


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div id="top"></div><p><a href="https://github.com/RecoHut-Projects/recohut/graphs/contributors"><img src="https://img.shields.io/github/contributors/RecoHut-Projects/recohut.svg?style=for-the-badge" alt="Contributors"></a>
<a href="https://github.com/RecoHut-Projects/recohut/network/members"><img src="https://img.shields.io/github/forks/RecoHut-Projects/recohut.svg?style=for-the-badge" alt="Forks"></a>
<a href="https://github.com/RecoHut-Projects/recohut/stargazers"><img src="https://img.shields.io/github/stars/RecoHut-Projects/recohut.svg?style=for-the-badge" alt="Stargazers"></a>
<a href="https://github.com/RecoHut-Projects/recohut/issues"><img src="https://img.shields.io/github/issues/RecoHut-Projects/recohut.svg?style=for-the-badge" alt="Issues"></a>
<a href="https://github.com/RecoHut-Projects/recohut/blob/master/LICENSE.txt"><img src="https://img.shields.io/github/license/RecoHut-Projects/recohut.svg?style=for-the-badge" alt="MIT License"></a></p>
<!-- PROJECT LOGO -->
<br />
<div align="center">
  <a href="https://github.com/RecoHut-Projects/recohut">
    <img src="https://github.com/recohut/reco-static/raw/master/media/diagrams/recohut_logo.svg" alt="Logo" width="80" height="80">
  </a>

<!-- <h3 align="center">recohut</h3> -->

<p align="center">
    a python library for building recommender systems.
    <br />
    <a href="https://recohut-projects.github.io/recohut"><strong>Explore the docs »</strong></a>
    <br />
    <br />
    <a href="https://github.com/RecoHut-Projects/recohut/tree/master/tutorials">View Demo</a>
    ·
    <a href="https://github.com/RecoHut-Projects/recohut/issues">Report Bug</a>
    ·
    <a href="https://github.com/RecoHut-Projects/recohut/issues">Request Feature</a>
  </p>
</div>



## About The Project

<img src="https://github.com/recohut/reco-static/raw/master/media/diagrams/recohut_lib_main.svg">


<p align="right">(<a href="#top">back to top</a>)</p><h3 id="Built-With">Built With<a class="anchor-link" href="#Built-With"> </a></h3><ul>
<li><a href="https://www.python.org/">Python</a></li>
<li><a href="https://pytorch.org/">PyTorch</a></li>
<li><a href="https://www.pytorchlightning.ai/">Lightning</a></li>
<li><a href="https://github.com/fastai/nbdev">nbdev</a></li>
</ul>
<p align="right">(<a href="#top">back to top</a>)</p><p><!-- GETTING STARTED --></p>
<h2 id="Getting-Started">Getting Started<a class="anchor-link" href="#Getting-Started"> </a></h2><p>To get a local copy up and running follow these simple example steps.</p>
<h3 id="Prerequisites">Prerequisites<a class="anchor-link" href="#Prerequisites"> </a></h3><ul>
<li>pytorch<div class="highlight"><pre><span></span>pip install torch
</pre></div>
</li>
<li>lightning<div class="highlight"><pre><span></span>pip install pytorch-lightning
</pre></div>
</li>
</ul>
<h3 id="Installation">Installation<a class="anchor-link" href="#Installation"> </a></h3>
<pre><code>pip install recohut</code></pre>
<p align="right">(<a href="#top">back to top</a>)</p><p><!-- USAGE EXAMPLES --></p>
<h2 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h2><div class="highlight"><pre><span></span><span class="c1"># import the required modules</span>
<span class="kn">from</span> <span class="nn">recohut.datasets.movielens</span> <span class="kn">import</span> <span class="n">ML1mDataModule</span>
<span class="kn">from</span> <span class="nn">recohut.models.nmf</span> <span class="kn">import</span> <span class="n">NMF</span>
<span class="kn">from</span> <span class="nn">recohut.trainers.pl_trainer</span> <span class="kn">import</span> <span class="n">pl_trainer</span>

<span class="c1"># build the dataset</span>
<span class="k">class</span> <span class="nc">Args</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="s1">&#39;/content/data&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_rating</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_negative_samples</span> <span class="o">=</span> <span class="mi">99</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_uc</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_sc</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">val_p</span> <span class="o">=</span> <span class="mf">0.2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_p</span> <span class="o">=</span> <span class="mf">0.2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drop_last</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">split_type</span> <span class="o">=</span> <span class="s1">&#39;stratified&#39;</span>

<span class="n">args</span> <span class="o">=</span> <span class="n">Args</span><span class="p">()</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">ML1mDataModule</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">()</span>

<span class="c1"># build the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">NMF</span><span class="p">(</span><span class="n">n_items</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">num_items</span><span class="p">,</span> <span class="n">n_users</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">num_users</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># train and evaluate the matrix factorization model</span>
<span class="n">pl_trainer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span> <span class="n">max_epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
<p>Check <a href="https://github.com/recohut/notebooks/blob/main/nbs/recohut_quick_tutorial.ipynb">this</a> quick tutorial.</p>
<p><em>For more examples, please refer to the <a href="https://recohut-projects.github.io/recohut">Documentation</a> and <a href="https://github.com/RecoHut-Projects/recohut/tree/master/tutorials">Tutorials</a>.</em></p>
<p align="right">(<a href="#top">back to top</a>)</p><p><!-- ROADMAP --></p>
<h2 id="Roadmap">Roadmap<a class="anchor-link" href="#Roadmap"> </a></h2><ul>
<li>[] RecSys Model Deployment and MLOps features</li>
<li>[] RL agents and environment specific to recommender systems</li>
<li>[] Visualization utilities and EDA</li>
</ul>
<p>See the <a href="https://github.com/RecoHut-Projects/recohut/issues">open issues</a> for a full list of proposed features (and known issues).</p>
<p align="right">(<a href="#top">back to top</a>)</p><p><!-- CONTRIBUTING --></p>
<h2 id="Contributing">Contributing<a class="anchor-link" href="#Contributing"> </a></h2><p>Contributions are what make the open source community such an amazing place to learn, inspire, and create. Any contributions you make are <strong>greatly appreciated</strong>.</p>
<p>If you have a suggestion that would make this better, please fork the repo and create a pull request. You can also simply open an issue with the tag "enhancement".
Don't forget to give the project a star! Thanks again!</p>
<ol>
<li>Fork the Project</li>
<li>Create your Feature Branch (<code>git checkout -b feature/AmazingFeature</code>)</li>
<li>Commit your Changes (<code>git commit -m 'Add some AmazingFeature'</code>)</li>
<li>Push to the Branch (<code>git push origin feature/AmazingFeature</code>)</li>
<li>Open a Pull Request</li>
</ol>
<p align="right">(<a href="#top">back to top</a>)</p><p><!-- LICENSE --></p>
<h2 id="License">License<a class="anchor-link" href="#License"> </a></h2><p>Distributed under the MIT License. See <code>LICENSE.txt</code> for more information.</p>
<p align="right">(<a href="#top">back to top</a>)</p><p><!-- CONTACT --></p>
<h2 id="Contact">Contact<a class="anchor-link" href="#Contact"> </a></h2><p>Sparsh A.</p>
<p><a href="https://github.com/RecoHut-Projects/recohut">@sparsh-ai</a></p>
<p align="right">(<a href="#top">back to top</a>)</p><p><!-- ACKNOWLEDGMENTS --></p>
<h2 id="Acknowledgments">Acknowledgments<a class="anchor-link" href="#Acknowledgments"> </a></h2><ul>
<li><a href="https://nbdev.fast.ai/tutorial.html">nbdev team</a> for providing supporting tools to build this library.</li>
<li><a href="https://colab.research.google.com/">colab team</a> for providing running VMs instances for development and testing.</li>
</ul>
<p align="right">(<a href="#top">back to top</a>)</p><p><!-- MARKDOWN LINKS & IMAGES --></p>

</div>
</div>
</div>
</div>
 

