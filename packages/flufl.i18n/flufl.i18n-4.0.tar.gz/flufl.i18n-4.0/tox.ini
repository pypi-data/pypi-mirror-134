[tox]
envlist = {py37,py38,py39,py310},qa,docs
skip_missing_interpreters = true
isolated_build = true
passenv = PDM_IGNORE_SAVED_PYTHON=1

[testenv]
setenv =
    PDM_IGNORE_SAVED_PYTHON="1"
    PYTHONPATH=""
deps = pdm
commands =
    pdm config --local use_venv true
    pdm install -G testing
    pytest {posargs}
    # The following is only useful in a git repository.
    -diff-cover coverage.xml
usedevelop = true

[testenv:qa]
deps = pdm
commands =
    pdm config --local use_venv true
    pdm install -G qa
    flake8 src/flufl/i18n
    isort src/flufl/i18n
    blue --check src/flufl/i18n
    mypy -p flufl.i18n

[testenv:docs]
deps = pdm
commands =
    pdm config --local use_venv true
    pdm install -G docs
    sphinx-build docs build/html
