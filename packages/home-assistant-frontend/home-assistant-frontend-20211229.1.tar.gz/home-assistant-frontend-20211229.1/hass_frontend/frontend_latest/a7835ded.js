"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[76478],{23682:(t,e,n)=>{function s(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}n.d(e,{Z:()=>s})},90394:(t,e,n)=>{function s(t){if(null===t||!0===t||!1===t)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}n.d(e,{Z:()=>s})},59699:(t,e,n)=>{n.d(e,{Z:()=>a});var s=n(90394),r=n(39244),i=n(23682),o=36e5;function a(t,e){(0,i.Z)(2,arguments);var n=(0,s.Z)(e);return(0,r.Z)(t,n*o)}},39244:(t,e,n)=>{n.d(e,{Z:()=>o});var s=n(90394),r=n(34327),i=n(23682);function o(t,e){(0,i.Z)(2,arguments);var n=(0,r.Z)(t).getTime(),o=(0,s.Z)(e);return new Date(n+o)}},4535:(t,e,n)=>{n.d(e,{Z:()=>l});var s=n(34327);function r(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}var i=n(59429),o=n(23682),a=864e5;function c(t,e){(0,o.Z)(2,arguments);var n=(0,i.Z)(t),s=(0,i.Z)(e),c=n.getTime()-r(n),u=s.getTime()-r(s);return Math.round((c-u)/a)}function u(t,e){var n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function l(t,e){(0,o.Z)(2,arguments);var n=(0,s.Z)(t),r=(0,s.Z)(e),i=u(n,r),a=Math.abs(c(n,r));n.setDate(n.getDate()-i*a);var l=Number(u(n,r)===-i),_=i*(a-l);return 0===_?0:_}},93752:(t,e,n)=>{n.d(e,{Z:()=>i});var s=n(34327),r=n(23682);function i(t){(0,r.Z)(1,arguments);var e=(0,s.Z)(t);return e.setHours(23,59,59,999),e}},70390:(t,e,n)=>{n.d(e,{Z:()=>r});var s=n(93752);function r(){return(0,s.Z)(Date.now())}},47538:(t,e,n)=>{function s(){var t=new Date,e=t.getFullYear(),n=t.getMonth(),s=t.getDate(),r=new Date(0);return r.setFullYear(e,n,s-1),r.setHours(23,59,59,999),r}n.d(e,{Z:()=>s})},59429:(t,e,n)=>{n.d(e,{Z:()=>i});var s=n(34327),r=n(23682);function i(t){(0,r.Z)(1,arguments);var e=(0,s.Z)(t);return e.setHours(0,0,0,0),e}},27088:(t,e,n)=>{n.d(e,{Z:()=>r});var s=n(59429);function r(){return(0,s.Z)(Date.now())}},83008:(t,e,n)=>{function s(){var t=new Date,e=t.getFullYear(),n=t.getMonth(),s=t.getDate(),r=new Date(0);return r.setFullYear(e,n,s-1),r.setHours(0,0,0,0),r}n.d(e,{Z:()=>s})},34327:(t,e,n)=>{n.d(e,{Z:()=>r});var s=n(23682);function r(t){(0,s.Z)(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===e?new Date(t.getTime()):"number"==typeof t||"[object Number]"===e?new Date(t):("string"!=typeof t&&"[object String]"!==e||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}},7323:(t,e,n)=>{n.d(e,{p:()=>s});const s=(t,e)=>t&&t.config.components.includes(e)},34007:(t,e,n)=>{n.d(e,{N:()=>s});const s=(t,e)=>{if(!t.toLowerCase().startsWith(e))return;const n=t.substring(e.length);return r(n.substr(0,n.indexOf(" ")))?n:n[0].toUpperCase()+n.slice(1)},r=t=>t.toLowerCase()!==t},85415:(t,e,n)=>{n.d(e,{$:()=>s,f:()=>r});const s=(t,e)=>t<e?-1:t>e?1:0,r=(t,e)=>s(t.toLowerCase(),e.toLowerCase())},92306:(t,e,n)=>{n.d(e,{v:()=>s});const s=(t,e)=>{const n={};for(const s of t){const t=e(s);t in n?n[t].push(s):n[t]=[s]}return n}},11950:(t,e,n)=>{n.d(e,{l:()=>s});const s=async(t,e)=>new Promise((n=>{const s=e(t,(t=>{s(),n(t)}))}))},57066:(t,e,n)=>{n.d(e,{Lo:()=>o,IO:()=>a,qv:()=>c,sG:()=>_});var s=n(97330),r=n(85415),i=n(38346);const o=(t,e)=>t.callWS({type:"config/area_registry/create",...e}),a=(t,e,n)=>t.callWS({type:"config/area_registry/update",area_id:e,...n}),c=(t,e)=>t.callWS({type:"config/area_registry/delete",area_id:e}),u=t=>t.sendMessagePromise({type:"config/area_registry/list"}).then((t=>t.sort(((t,e)=>(0,r.$)(t.name,e.name))))),l=(t,e)=>t.subscribeEvents((0,i.D)((()=>u(t).then((t=>e.setState(t,!0)))),500,!0),"area_registry_updated"),_=(t,e)=>(0,s.B)("_areaRegistry",u,l,t,e)},81582:(t,e,n)=>{n.d(e,{LZ:()=>s,pB:()=>r,SO:()=>i,iJ:()=>o,Nn:()=>a,Ny:()=>c,T0:()=>u});const s=32143==n.j?["migration_error","setup_error","setup_retry"]:null,r=t=>t.callApi("GET","config/config_entries/entry"),i=(t,e,n)=>t.callWS({type:"config_entries/update",entry_id:e,...n}),o=(t,e)=>t.callApi("DELETE",`config/config_entries/entry/${e}`),a=(t,e)=>t.callApi("POST",`config/config_entries/entry/${e}/reload`),c=(t,e)=>t.callWS({type:"config_entries/disable",entry_id:e,disabled_by:"user"}),u=(t,e)=>t.callWS({type:"config_entries/disable",entry_id:e,disabled_by:null})},57292:(t,e,n)=>{n.d(e,{jL:()=>o,t1:()=>a,_Y:()=>c,q4:()=>l});var s=n(97330),r=n(91741),i=n(38346);const o=(t,e,n)=>t.name_by_user||t.name||n&&((t,e)=>{for(const n of e||[]){const e="string"==typeof n?n:n.entity_id,s=t.states[e];if(s)return(0,r.C)(s)}})(e,n)||e.localize("ui.panel.config.devices.unnamed_device"),a=(t,e,n)=>t.callWS({type:"config/device_registry/update",device_id:e,...n}),c=t=>t.sendMessagePromise({type:"config/device_registry/list"}),u=(t,e)=>t.subscribeEvents((0,i.D)((()=>c(t).then((t=>e.setState(t,!0)))),500,!0),"device_registry_updated"),l=(t,e)=>(0,s.B)("_dr",c,u,t,e)},55424:(t,e,n)=>{n.a(t,(async t=>{n.d(e,{Bm:()=>m,o1:()=>h,iK:()=>b,rl:()=>v,P:()=>w,KU:()=>S,xZ:()=>Z,gy:()=>E,ZC:()=>T,_Z:()=>D,Jj:()=>C,UB:()=>M,jB:()=>k,gM:()=>N,yT:()=>O,_n:()=>P,vR:()=>j,vE:()=>L});var s=n(4535),r=n(59699),i=n(27088),o=n(83008),a=n(70390),c=n(47538),u=n(97330),l=n(92306),_=n(11950),y=n(81582),d=n(74186),g=n(58763),f=t([g]);g=(f.then?await f:f)[0];const p=[],m=()=>({stat_energy_from:"",stat_cost:null,entity_energy_from:null,entity_energy_price:null,number_energy_price:null}),h=()=>({stat_energy_to:"",stat_compensation:null,entity_energy_to:null,entity_energy_price:null,number_energy_price:null}),b=()=>({type:"grid",flow_from:[],flow_to:[],cost_adjustment_day:0}),v=()=>({type:"solar",stat_energy_from:"",config_entry_solar_forecast:null}),w=()=>({type:"battery",stat_energy_from:"",stat_energy_to:""}),S=()=>({type:"gas",stat_energy_from:"",stat_cost:null,entity_energy_from:null,entity_energy_price:null,number_energy_price:null}),Z=t=>t.callWS({type:"energy/info"}),E=t=>t.callWS({type:"energy/validate"}),T=t=>t.callWS({type:"energy/get_prefs"}),D=async(t,e)=>{const n=t.callWS({type:"energy/save_prefs",...e});return W(t),n},C=t=>(0,l.v)(t.energy_sources,(t=>t.type)),W=t=>{p.forEach((e=>{const n=M(t,{key:e});n.clearPrefs(),n._active&&n.refresh()}))},M=(t,e={})=>{let n="_energy";if(e.key){if(!e.key.startsWith("energy_"))throw new Error("Key need to start with energy_");n=`_${e.key}`}if(t.connection[n])return t.connection[n];p.push(e.key);const l=(0,u._)(t.connection,n,(async()=>{if(l.prefs||(l.prefs=await T(t)),l._refreshTimeout&&clearTimeout(l._refreshTimeout),l._active&&(!l.end||l.end>new Date)){const t=new Date;t.getMinutes()>=20&&t.setHours(t.getHours()+1),t.setMinutes(20,0,0),l._refreshTimeout=window.setTimeout((()=>l.refresh()),t.getTime()-Date.now())}return(async(t,e,n,i)=>{const[o,a,c]=await Promise.all([(0,y.pB)(t),(0,_.l)(t.connection,d.LM),Z(t)]),u=o.find((t=>"co2signal"===t.domain));let l;if(u)for(const e of a){if(e.config_entry_id!==u.entry_id)continue;const n=t.states[e.entity_id];if(n&&"%"===n.attributes.unit_of_measurement){l=n.entity_id;break}}const f=[],p=[];for(const t of e.energy_sources)if("solar"!==t.type)if("gas"!==t.type)if("battery"!==t.type){for(const e of t.flow_from){f.push(e.stat_energy_from),p.push(e.stat_energy_from),e.stat_cost&&p.push(e.stat_cost);const t=c.cost_sensors[e.stat_energy_from];t&&p.push(t)}for(const e of t.flow_to){p.push(e.stat_energy_to),e.stat_compensation&&p.push(e.stat_compensation);const t=c.cost_sensors[e.stat_energy_to];t&&p.push(t)}}else p.push(t.stat_energy_from),p.push(t.stat_energy_to);else{p.push(t.stat_energy_from),t.stat_cost&&p.push(t.stat_cost);const e=c.cost_sensors[t.stat_energy_from];e&&p.push(e)}else p.push(t.stat_energy_from);const m=(0,s.Z)(i||new Date,n),h=(0,r.Z)(n,-1),b=await(0,g.dL)(t,h,i,p,m>35?"month":m>2?"day":"hour");let v;return void 0!==l&&(v=await(async(t,e,n,s,r,i="hour")=>t.callWS({type:"energy/fossil_energy_consumption",start_time:e.toISOString(),end_time:null==r?void 0:r.toISOString(),energy_statistic_ids:n,co2_statistic_id:s,period:i}))(t,n,f,l,i,m>35?"month":m>2?"day":"hour")),Object.values(b).forEach((t=>{t.length&&new Date(t[0].start)>h&&t.unshift({...t[0],start:h.toISOString(),end:h.toISOString(),sum:0,state:0})})),{start:n,end:i,info:c,prefs:e,stats:b,co2SignalConfigEntry:u,co2SignalEntity:l,fossilEnergyConsumption:v}})(t,l.prefs,l.start,l.end)})),f=l.subscribe;l.subscribe=t=>{const e=f(t);return l._active++,()=>{l._active--,l._active<1&&(clearTimeout(l._refreshTimeout),l._refreshTimeout=void 0),e()}},l._active=0,l.prefs=e.prefs;const m=new Date;l.start=m.getHours()>0?(0,i.Z)():(0,o.Z)(),l.end=m.getHours()>0?(0,a.Z)():(0,c.Z)();const h=()=>{l._updatePeriodTimeout=window.setTimeout((()=>{l.start=(0,i.Z)(),l.end=(0,a.Z)(),h()}),(0,r.Z)((0,a.Z)(),1).getTime()-Date.now())};return h(),l.clearPrefs=()=>{l.prefs=void 0},l.setPeriod=(t,e)=>{var n;l.start=t,l.end=e,l.start.getTime()!==(0,i.Z)().getTime()||(null===(n=l.end)||void 0===n?void 0:n.getTime())!==(0,a.Z)().getTime()||l._updatePeriodTimeout?l._updatePeriodTimeout&&(clearTimeout(l._updatePeriodTimeout),l._updatePeriodTimeout=void 0):h()},l},k=t=>t.callWS({type:"energy/solar_forecast"}),N=["m³","ft³"],O=["kWh"],P=[...N,...O],j=(t,e)=>{for(const n of e.energy_sources){if("gas"!==n.type)continue;const e=t.states[n.stat_energy_from];if(e)return N.includes(e.attributes.unit_of_measurement)?"volume":"energy"}},L=(t,e)=>{for(const n of e.energy_sources){if("gas"!==n.type)continue;const e=t.states[n.stat_energy_from];if(null!=e&&e.attributes.unit_of_measurement)return"Wh"===e.attributes.unit_of_measurement?"kWh":e.attributes.unit_of_measurement}}}))},74186:(t,e,n)=>{n.d(e,{eD:()=>o,Mw:()=>a,vA:()=>c,L3:()=>u,Nv:()=>l,z3:()=>_,LM:()=>g});var s=n(97330),r=n(91741),i=n(38346);const o=(t,e)=>e.find((e=>t.states[e.entity_id]&&"battery"===t.states[e.entity_id].attributes.device_class)),a=(t,e)=>e.find((e=>t.states[e.entity_id]&&"battery_charging"===t.states[e.entity_id].attributes.device_class)),c=(t,e)=>{if(e.name)return e.name;const n=t.states[e.entity_id];return n?(0,r.C)(n):e.entity_id},u=(t,e)=>t.callWS({type:"config/entity_registry/get",entity_id:e}),l=(t,e,n)=>t.callWS({type:"config/entity_registry/update",entity_id:e,...n}),_=(t,e)=>t.callWS({type:"config/entity_registry/remove",entity_id:e}),y=t=>t.sendMessagePromise({type:"config/entity_registry/list"}),d=(t,e)=>t.subscribeEvents((0,i.D)((()=>y(t).then((t=>e.setState(t,!0)))),500,!0),"entity_registry_updated"),g=(t,e)=>(0,s.B)("_entityRegistry",y,d,t,e)},58763:(t,e,n)=>{n.a(t,(async t=>{n.d(e,{vq:()=>u,_J:()=>l,Nu:()=>y,uR:()=>d,dL:()=>g,h_:()=>f,Cj:()=>p,hN:()=>m,Kj:()=>h,q6:()=>b,Nw:()=>v});var s=n(29171),r=n(22311),i=n(91741),o=t([s]);s=(o.then?await o:o)[0];const a=["climate","humidifier","water_heater"],c=["temperature","current_temperature","target_temp_low","target_temp_high","hvac_action","humidity","mode"],u=(t,e,n,s,r=!1,i,o=!0)=>{let a="history/period";return n&&(a+="/"+n.toISOString()),a+="?filter_entity_id="+e,s&&(a+="&end_time="+s.toISOString()),r&&(a+="&skip_initial_state"),void 0!==i&&(a+=`&significant_changes_only=${Number(i)}`),o&&(a+="&minimal_response"),t.callApi("GET",a)},l=(t,e,n,s)=>t.callApi("GET",`history/period/${e.toISOString()}?end_time=${n.toISOString()}&minimal_response${s?`&filter_entity_id=${s}`:""}`),_=(t,e)=>t.state===e.state&&(!t.attributes||!e.attributes||c.every((n=>t.attributes[n]===e.attributes[n]))),y=(t,e,n)=>{const o={},u=[];if(!e)return{line:[],timeline:[]};e.forEach((e=>{if(0===e.length)return;const a=e.find((t=>t.attributes&&("unit_of_measurement"in t.attributes||"state_class"in t.attributes)));let c;c=a?a.attributes.unit_of_measurement||" ":{climate:t.config.unit_system.temperature,counter:"#",humidifier:"%",input_number:"#",number:"#",water_heater:t.config.unit_system.temperature}[(0,r.N)(e[0])],c?c in o?o[c].push(e):o[c]=[e]:u.push(((t,e,n)=>{const r=[],o=n.length-1;for(const i of n)r.length>0&&i.state===r[r.length-1].state||(i.entity_id||(i.attributes=n[o].attributes,i.entity_id=n[o].entity_id),r.push({state_localize:(0,s.D)(t,i,e),state:i.state,last_changed:i.last_changed}));return{name:(0,i.C)(n[0]),entity_id:n[0].entity_id,data:r}})(n,t.locale,e))}));return{line:Object.keys(o).map((t=>((t,e)=>{const n=[];for(const t of e){const e=t[t.length-1],s=(0,r.N)(e),o=[];for(const e of t){let t;if(a.includes(s)){t={state:e.state,last_changed:e.last_updated,attributes:{}};for(const n of c)n in e.attributes&&(t.attributes[n]=e.attributes[n])}else t=e;o.length>1&&_(t,o[o.length-1])&&_(t,o[o.length-2])||o.push(t)}n.push({domain:s,name:(0,i.C)(e),entity_id:e.entity_id,states:o})}return{unit:t,identifier:e.map((t=>t[0].entity_id)).join(""),data:n}})(t,o[t]))),timeline:u}},d=(t,e)=>t.callWS({type:"history/list_statistic_ids",statistic_type:e}),g=(t,e,n,s,r="hour")=>t.callWS({type:"history/statistics_during_period",start_time:e.toISOString(),end_time:null==n?void 0:n.toISOString(),statistic_ids:s,period:r}),f=t=>t.callWS({type:"recorder/validate_statistics"}),p=(t,e,n)=>t.callWS({type:"recorder/update_statistics_metadata",statistic_id:e,unit_of_measurement:n}),m=(t,e)=>t.callWS({type:"recorder/clear_statistics",statistic_ids:e}),h=t=>{if(!t||t.length<2)return null;const e=t[t.length-1].sum;if(null===e)return null;const n=t[0].sum;return null===n?e:e-n},b=(t,e)=>{let n=null;for(const s of e){if(!(s in t))continue;const e=h(t[s]);null!==e&&(null===n?n=e:n+=e)}return n},v=(t,e)=>t.some((t=>null!==t[e]))}))},65253:(t,e,n)=>{n.d(e,{Pb:()=>s,CE:()=>r,uh:()=>i,r4:()=>o,Nq:()=>a,h8:()=>c,fm:()=>u});const s="system-admin",r="system-users",i=async t=>t.callWS({type:"config/auth/list"}),o=async(t,e,n,s)=>t.callWS({type:"config/auth/create",name:e,group_ids:n,local_only:s}),a=async(t,e,n)=>t.callWS({...n,type:"config/auth/update",user_id:e}),c=async(t,e)=>t.callWS({type:"config/auth/delete",user_id:e}),u=t=>t?t.trim().split(" ").slice(0,3).map((t=>t.substr(0,1))).join(""):"?"},38926:(t,e,n)=>{n.d(e,{VG:()=>d,AP:()=>f});var s=n(58831),r=n(22311),i=n(91741);var o=n(34007),a=n(85415),c=n(5986),u=n(41499),l=n(65253);const _=new Set(["automation","configurator","device_tracker","geo_location","persistent_notification","script","sun","zone"]),y=new Set(["mobile_app"]),d=(t,e,n=!0)=>{const r=[],a=[],c=e.title?`${e.title} `.toLowerCase():void 0,l=[];for(const[e,_]of t){const t=(0,s.M)(e);if("alarm_control_panel"===t){const t={type:"alarm-panel",entity:e};r.push(t)}else if("camera"===t){const t={type:"picture-entity",entity:e};r.push(t)}else if("climate"===t){const t={type:"thermostat",entity:e};r.push(t)}else if("humidifier"===t){const t={type:"humidifier",entity:e};r.push(t)}else if("media_player"===t){const t={type:"media-control",entity:e};r.push(t)}else if("plant"===t){const t={type:"plant-status",entity:e};r.push(t)}else if("weather"===t){const t={type:"weather-forecast",entity:e,show_forecast:!1};r.push(t)}else if(!n||"scene"!==t&&"script"!==t)if("sensor"===t&&(null==_?void 0:_.attributes.device_class)===u.A);else{let t;const n=c&&_&&(t=(0,o.N)((0,i.C)(_),c))?{entity:e,name:t}:e;a.push(n)}else{const t={entity:e,show_icon:!0,show_name:!0};let n;c&&_&&(n=(0,o.N)((0,i.C)(_),c))&&(t.name=n),l.push(t)}}if(0===a.length&&l.length>0)return d(t,e,!1);if(a.length>0||l.length>0){const t={type:"entities",entities:a,...e};l.length>0&&(t.footer={type:"buttons",entities:l}),r.unshift(t)}return r.length<2?r:[{type:"grid",square:!1,columns:1,cards:r}]},g=(t,e,n,o,u,_)=>{const y=(t=>{const e=[],n={};return Object.keys(t).forEach((r=>{const i=t[r];"group"===(0,s.M)(r)?e.push(i):n[r]=i})),e.forEach((t=>t.attributes.entity_id.forEach((t=>{delete n[t]})))),{groups:e,ungrouped:n}})(u);y.groups.sort(((t,e)=>_[t.entity_id]-_[e.entity_id]));const g={};Object.keys(y.ungrouped).forEach((t=>{const e=y.ungrouped[t],n=(0,r.N)(e);n in g||(g[n]=[]),g[n].push(e.entity_id)}));let f=[];if("person"in g){const t=[];if(1===g.person.length)f.push({type:"entities",entities:g.person});else{let e,n="";for(const s of g.person){const r=u[s];let i=r.attributes.entity_picture;if(!i){if(void 0===e){const t=getComputedStyle(document.body);e=encodeURIComponent(t.getPropertyValue("--light-primary-color").trim()),n=encodeURIComponent((t.getPropertyValue("--text-light-primary-color")||t.getPropertyValue("--primary-text-color")).trim())}i=`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50' width='50' height='50' style='background-color:${e}'%3E%3Cg%3E%3Ctext font-family='roboto' x='50%25' y='50%25' text-anchor='middle' stroke='${n}' font-size='1.3em' dy='.3em'%3E${(0,l.fm)(r.attributes.friendly_name||"")}%3C/text%3E%3C/g%3E%3C/svg%3E`}t.push({type:"picture-entity",entity:s,aspect_ratio:"1",show_name:!1,image:i})}f.push({type:"grid",square:!0,columns:3,cards:t})}delete g.person}y.groups.forEach((t=>{f=f.concat(d(t.attributes.entity_id.map((t=>[t,u[t]])),{title:(0,i.C)(t),show_header_toggle:"hidden"!==t.attributes.control}))})),Object.keys(g).sort().forEach((e=>{f=f.concat(d(g[e].sort(((t,e)=>(0,a.$)((0,i.C)(u[t]),(0,i.C)(u[e])))).map((t=>[t,u[t]])),{title:(0,c.Lh)(t,e)}))}));const p={path:e,title:n,cards:f};return o&&(p.icon=o),p},f=(t,e,n,s,i,o)=>{const a=((t,e)=>{const n={},s=new Set(e.filter((t=>t.entity_category||y.has(t.platform))).map((t=>t.entity_id)));return Object.keys(t).forEach((e=>{const i=t[e];_.has((0,r.N)(i))||s.has(i.entity_id)||(n[e]=t[e])})),n})(s,n),c={};Object.keys(a).forEach((t=>{const e=a[t];e.attributes.order&&(c[t]=e.attributes.order)}));const u=((t,e,n,s)=>{const r={...s},i=[];for(const s of t){const t=[],o=new Set(e.filter((t=>t.area_id===s.area_id)).map((t=>t.id)));for(const e of n)(o.has(e.device_id)&&!e.area_id||e.area_id===s.area_id)&&e.entity_id in r&&(t.push(r[e.entity_id]),delete r[e.entity_id]);t.length>0&&i.push([s,t])}return{areasWithEntities:i,otherEntities:r}})(t,e,n,a),l=g(i,"default_view","Home",undefined,u.otherEntities,c),f=[];if(u.areasWithEntities.forEach((([t,e])=>{f.push(...d(e.map((t=>[t.entity_id,t])),{title:t.name}))})),o){const t=o.energy_sources.find((t=>"grid"===t.type));t&&t.flow_from.length>0&&f.push({title:i("ui.panel.lovelace.cards.energy.energy_distribution.title_today"),type:"energy-distribution",link_dashboard:!0})}return l.cards.unshift(...f),l}},76478:(t,e,n)=>{n.a(t,(async t=>{n.r(e),n.d(e,{OriginalStatesStrategy:()=>d});var s=n(28101),r=n(7323),i=n(11950),o=n(57066),a=n(57292),c=n(55424),u=n(74186),l=n(38926),_=t([c]);c=(_.then?await _:_)[0];let y=!1;class d{static async generateView(t){const e=t.hass;if(e.config.state===s.UE)return{cards:[{type:"starting"}]};if(e.config.safe_mode)return{cards:[{type:"safe-mode"}]};let n;y||(y=!0,(0,o.sG)(e.connection,(()=>{})),(0,a.q4)(e.connection,(()=>{})),(0,u.LM)(e.connection,(()=>{}))),(0,r.p)(e,"energy")&&(n=(0,c.ZC)(e));const[_,d,g,f]=await Promise.all([(0,i.l)(e.connection,o.sG),(0,i.l)(e.connection,a.q4),(0,i.l)(e.connection,u.LM),e.loadBackendTranslation("title")]);let p;if(n)try{p=await n}catch(t){}const m=(0,l.AP)(_,d,g,e.states,f,p);return e.config.components.includes("geo_location")&&m&&m.cards&&m.cards.push({type:"map",geo_location_sources:["all"]}),0===m.cards.length&&m.cards.push({type:"empty-state"}),m}static async generateDashboard(t){return{title:t.hass.config.location_name,views:[{strategy:{type:"original-states"}}]}}}}))}}]);