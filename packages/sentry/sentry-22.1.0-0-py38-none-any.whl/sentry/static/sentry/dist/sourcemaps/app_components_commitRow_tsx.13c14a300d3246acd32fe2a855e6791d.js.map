{"version":3,"file":"chunks/app_components_commitRow_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/commitLink.tsx","webpack:///./app/components/commitRow.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport Button from 'sentry/components/button';\nimport ExternalLink from 'sentry/components/links/externalLink';\nimport {IconBitbucket, IconGithub, IconGitlab, IconVsts} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport {Repository} from 'sentry/types';\nimport {getShortCommitHash} from 'sentry/utils';\n\ntype CommitFormatterParameters = {\n  baseUrl: string;\n  commitId: string;\n};\n\ntype CommitProvider = {\n  icon: React.ReactNode;\n  providerIds: string[];\n  commitUrl: (opts: CommitFormatterParameters) => string;\n};\n\n// TODO(epurkhiser, jess): This should be moved into plugins.\nconst SUPPORTED_PROVIDERS: Readonly<CommitProvider[]> = [\n  {\n    icon: <IconGithub size=\"xs\" />,\n    providerIds: ['github', 'integrations:github', 'integrations:github_enterprise'],\n    commitUrl: ({baseUrl, commitId}) => `${baseUrl}/commit/${commitId}`,\n  },\n  {\n    icon: <IconBitbucket size=\"xs\" />,\n    providerIds: ['bitbucket', 'integrations:bitbucket'],\n    commitUrl: ({baseUrl, commitId}) => `${baseUrl}/commits/${commitId}`,\n  },\n  {\n    icon: <IconVsts size=\"xs\" />,\n    providerIds: ['visualstudio', 'integrations:vsts'],\n    commitUrl: ({baseUrl, commitId}) => `${baseUrl}/commit/${commitId}`,\n  },\n  {\n    icon: <IconGitlab size=\"xs\" />,\n    providerIds: ['gitlab', 'integrations:gitlab'],\n    commitUrl: ({baseUrl, commitId}) => `${baseUrl}/commit/${commitId}`,\n  },\n];\n\ntype Props = {\n  commitId: string;\n  repository?: Repository;\n  inline?: boolean;\n};\n\nfunction CommitLink({inline, commitId, repository}: Props) {\n  if (!commitId || !repository) {\n    return <span>{t('Unknown Commit')}</span>;\n  }\n\n  const shortId = getShortCommitHash(commitId);\n\n  const providerData = SUPPORTED_PROVIDERS.find(provider => {\n    if (!repository.provider) {\n      return false;\n    }\n    return provider.providerIds.includes(repository.provider.id);\n  });\n\n  if (providerData === undefined) {\n    return <span>{shortId}</span>;\n  }\n\n  const commitUrl =\n    repository.url &&\n    providerData.commitUrl({\n      commitId,\n      baseUrl: repository.url,\n    });\n\n  return !inline ? (\n    <Button external href={commitUrl} size=\"small\" icon={providerData.icon}>\n      {shortId}\n    </Button>\n  ) : (\n    <ExternalLink className=\"inline-commit\" href={commitUrl}>\n      {providerData.icon}\n      {' ' + shortId}\n    </ExternalLink>\n  );\n}\n\nexport default CommitLink;\n","import * as React from 'react';\nimport styled from '@emotion/styled';\n\nimport {openInviteMembersModal} from 'sentry/actionCreators/modal';\nimport UserAvatar from 'sentry/components/avatar/userAvatar';\nimport CommitLink from 'sentry/components/commitLink';\nimport Hovercard from 'sentry/components/hovercard';\nimport Link from 'sentry/components/links/link';\nimport {PanelItem} from 'sentry/components/panels';\nimport TextOverflow from 'sentry/components/textOverflow';\nimport TimeSince from 'sentry/components/timeSince';\nimport {IconWarning} from 'sentry/icons';\nimport {t, tct} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {Commit, User} from 'sentry/types';\n\ntype Props = {\n  commit: Commit;\n  customAvatar?: React.ReactNode;\n};\n\nclass CommitRow extends React.Component<Props> {\n  renderMessage(message: Commit['message']): string {\n    if (!message) {\n      return t('No message provided');\n    }\n\n    const firstLine = message.split(/\\n/)[0];\n\n    return firstLine;\n  }\n\n  renderHovercardBody(author: User) {\n    return (\n      <EmailWarning>\n        {tct(\n          'The email [actorEmail] is not a member of your organization. [inviteUser:Invite] them or link additional emails in [accountSettings:account settings].',\n          {\n            actorEmail: <strong>{author.email}</strong>,\n            accountSettings: <StyledLink to=\"/settings/account/emails/\" />,\n            inviteUser: (\n              <StyledLink\n                to=\"\"\n                onClick={() =>\n                  openInviteMembersModal({\n                    initialData: [\n                      {\n                        emails: new Set([author.email]),\n                      },\n                    ],\n                    source: 'suspect_commit',\n                  })\n                }\n              />\n            ),\n          }\n        )}\n      </EmailWarning>\n    );\n  }\n\n  render() {\n    const {commit, customAvatar, ...props} = this.props;\n    const {id, dateCreated, message, author, repository} = commit;\n    const nonMemberEmail = author && author.id === undefined;\n\n    return (\n      <PanelItem key={id} {...props}>\n        {customAvatar ? (\n          customAvatar\n        ) : nonMemberEmail ? (\n          <AvatarWrapper>\n            <Hovercard body={this.renderHovercardBody(author!)}>\n              <UserAvatar size={36} user={author} />\n              <EmailWarningIcon>\n                <IconWarning size=\"xs\" />\n              </EmailWarningIcon>\n            </Hovercard>\n          </AvatarWrapper>\n        ) : (\n          <AvatarWrapper>\n            <UserAvatar size={36} user={author} />\n          </AvatarWrapper>\n        )}\n\n        <CommitMessage>\n          <Message>{this.renderMessage(message)}</Message>\n          <Meta>\n            {tct('[author] committed [timeago]', {\n              author: <strong>{(author && author.name) || t('Unknown author')}</strong>,\n              timeago: <TimeSince date={dateCreated} />,\n            })}\n          </Meta>\n        </CommitMessage>\n\n        <div>\n          <CommitLink commitId={id} repository={repository} />\n        </div>\n      </PanelItem>\n    );\n  }\n}\n\nconst AvatarWrapper = styled('div')`\n  position: relative;\n  align-self: flex-start;\n  margin-right: ${space(2)};\n`;\n\nconst EmailWarning = styled('div')`\n  font-size: ${p => p.theme.fontSizeSmall};\n  line-height: 1.4;\n  margin: -4px;\n`;\n\nconst StyledLink = styled(Link)`\n  color: ${p => p.theme.textColor};\n  border-bottom: 1px dotted ${p => p.theme.textColor};\n\n  &:hover {\n    color: ${p => p.theme.textColor};\n  }\n`;\n\nconst EmailWarningIcon = styled('span')`\n  position: absolute;\n  bottom: -6px;\n  right: -7px;\n  line-height: 12px;\n  border-radius: 50%;\n  border: 1px solid ${p => p.theme.background};\n  background: ${p => p.theme.yellow200};\n  padding: 1px 2px 3px 2px;\n`;\n\nconst CommitMessage = styled('div')`\n  flex: 1;\n  flex-direction: column;\n  min-width: 0;\n  margin-right: ${space(2)};\n`;\n\nconst Message = styled(TextOverflow)`\n  font-size: 15px;\n  line-height: 1.1;\n  font-weight: bold;\n`;\n\nconst Meta = styled(TextOverflow)`\n  font-size: 13px;\n  line-height: 1.5;\n  margin: 0;\n  color: ${p => p.theme.subText};\n`;\n\nexport default styled(CommitRow)`\n  align-items: center;\n`;\n"],"names":["SUPPORTED_PROVIDERS","icon","size","providerIds","commitUrl","baseUrl","commitId","inline","repository","t","shortId","getShortCommitHash","providerData","find","provider","includes","id","undefined","url","className","href","external","CommitRow","React","renderMessage","message","split","renderHovercardBody","author","EmailWarning","tct","actorEmail","email","accountSettings","StyledLink","to","inviteUser","onClick","openInviteMembersModal","initialData","emails","Set","source","render","commit","customAvatar","props","this","dateCreated","nonMemberEmail","AvatarWrapper","body","user","EmailWarningIcon","CommitMessage","Message","Meta","name","timeago","date","space","p","theme","fontSizeSmall","Link","textColor","background","yellow200","TextOverflow","subText"],"sourceRoot":""}