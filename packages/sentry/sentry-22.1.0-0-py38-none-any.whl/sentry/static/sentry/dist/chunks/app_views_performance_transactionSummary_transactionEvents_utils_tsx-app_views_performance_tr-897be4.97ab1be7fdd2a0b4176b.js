"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_performance_transactionSummary_transactionEvents_utils_tsx-app_views_performance_tr-897be4"],{"./app/utils/discover/charts.tsx":(t,e,n)=>{n.d(e,{CX:()=>i,gu:()=>c});var r=n("./app/locale.tsx"),a=n("./app/utils.tsx"),s=n("./app/utils/discover/fields.tsx"),o=n("./app/utils/formatters.tsx");function i(t,e=""){if(!(0,a.ri)(t))return"—";switch((0,s.Px)(e)){case"integer":case"number":return t.toLocaleString();case"percentage":return(0,o.rl)(t,2);case"duration":return(0,o.g9)(t/1e3,2,!0);default:return t.toString()}}function c(t,e,n=!1){switch((0,s.Px)(e)){case"integer":case"number":return n?(0,o.Du)(t):t.toLocaleString();case"percentage":return(0,o.rl)(t,0);case"duration":return function(t){if(0===t)return"0";if(t>=o.ps){const e=(t/o.ps).toFixed(0);return(0,r.t)("%swk",e)}if(t>=o.x4){const e=(t/o.x4).toFixed(0);return(0,r.t)("%sd",e)}if(t>=o.kr){const e=(t/o.kr).toFixed(0);return(0,r.t)("%shr",e)}if(t>=o.EB){const e=(t/o.EB).toFixed(0);return(0,r.t)("%smin",e)}if(t>=o.sh){const e=(t/o.sh).toFixed(0);return(0,r.t)("%ss",e)}const e=t.toFixed(0);return(0,r.t)("%sms",e)}(t);default:return t.toString()}}},"./app/views/performance/transactionSummary/transactionEvents/utils.tsx":(t,e,n)=>{n.d(e,{q3:()=>i,_S:()=>c,xr:()=>l,tb:()=>d,qg:()=>p,Zq:()=>u});var r=n("./app/locale.tsx"),a=n("./app/utils/queryString.tsx"),s=n("./app/views/performance/transactionSummary/filter.tsx"),o=n("./app/views/performance/transactionSummary/utils.tsx");let i;function c(t,e){const{p99:n,p95:a,p75:o,p50:c}=e||{p99:0,p95:0,p75:0,p50:0};return{[i.p50]:{name:i.p50,query:c?[["transaction.duration","<=".concat(c.toFixed(0))]]:void 0,sort:{kind:"desc",field:(0,s.T$)(t)||"transaction.duration"},label:(0,r.t)("p50")},[i.p75]:{name:i.p75,query:o?[["transaction.duration","<=".concat(o.toFixed(0))]]:void 0,sort:{kind:"desc",field:(0,s.T$)(t)||"transaction.duration"},label:(0,r.t)("p75")},[i.p95]:{name:i.p95,query:a?[["transaction.duration","<=".concat(a.toFixed(0))]]:void 0,sort:{kind:"desc",field:(0,s.T$)(t)||"transaction.duration"},label:(0,r.t)("p95")},[i.p99]:{name:i.p99,query:n?[["transaction.duration","<=".concat(n.toFixed(0))]]:void 0,sort:{kind:"desc",field:(0,s.T$)(t)||"transaction.duration"},label:(0,r.t)("p99")},[i.p100]:{name:i.p100,label:(0,r.t)("p100")}}}function l({orgSlug:t,transaction:e,projectID:n,query:r}){return{pathname:"/organizations/".concat(t,"/performance/summary/events/"),query:{transaction:e,project:n,environment:r.environment,statsPeriod:r.statsPeriod,start:r.start,end:r.end,query:r.query}}}function d(t){return e=(0,a.ro)(t.query.showTransactions,i.p100),Object.values(i).includes(e)?e:i.p100;var e}function p(t,e){var n,r;const a=c(e),s=null===(n=a[t].sort)||void 0===n?void 0:n.kind,o=null===(r=a[t].sort)||void 0===r?void 0:r.field,i={showTransactions:t};return s&&o&&(i.sort="".concat("desc"===s?"-":"").concat(o)),i}function u(t){switch(t){case o.K0.OUTLIER:return i.p100;case o.K0.SLOW:return i.p95;default:return}}!function(t){t.p50="p50",t.p75="p75",t.p95="p95",t.p99="p99",t.p100="p100"}(i||(i={}))},"./app/views/performance/trends/changedTransactions.tsx":(t,e,n)=>{n.d(e,{H:()=>H,Z:()=>dt});var r,a=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/react/index.js")),o=n("../node_modules/react-router/es/index.js"),i=n("./app/components/button.tsx"),c=n("./app/components/charts/styles.tsx"),l=n("./app/components/count.tsx"),d=n("./app/components/dropdownLink.tsx"),p=n("./app/components/duration.tsx"),u=n("./app/components/emptyStateWarning.tsx"),m=n("./app/components/idBadge/index.tsx"),g=n("./app/components/links/link.tsx"),h=n("./app/components/loadingIndicator.tsx"),x=n("./app/components/menuItem.tsx"),f=n("./app/components/pagination.tsx"),Z=n("./app/components/panels/index.tsx"),v=n("./app/components/questionTooltip.tsx"),y=n("./app/components/radio.tsx"),w=n("./app/components/tooltip.tsx"),b=n("./app/icons/index.tsx"),_=n("./app/locale.tsx"),S=n("./app/styles/overflowEllipsis.tsx"),E=n("./app/styles/space.tsx"),T=n("./app/utils/formatters.tsx"),j=n("./app/utils/performance/trends/trendsDiscoverQuery.tsx"),k=n("./app/utils/queryString.tsx"),C=n("./app/utils/tokenizeSearch.tsx"),q=n("./app/utils/useApi.tsx"),L=n("./app/utils/withOrganization.tsx"),R=n("./app/utils/withProjects.tsx"),F=n("./app/views/settings/components/forms/controls/radioGroup.tsx"),z=n("./app/views/performance/transactionSummary/transactionOverview/charts.tsx"),N=n("./app/views/performance/transactionSummary/utils.tsx"),P=n("./app/views/performance/trends/chart.tsx"),B=n("./app/views/performance/trends/types.tsx"),D=n("./app/views/performance/trends/utils.tsx"),A=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function I(t,e,n){const r=(0,D.j_)(e),a=(0,k.ro)(t.query[r]);if(!n)return;return n.find((t=>"".concat(t.transaction,"-").concat(t.project)===a))||(n.length>0?n[0]:void 0)}function M(t,e){return function(n){const r=(0,D.j_)(e),a={...t.query};n?a[r]=n?"".concat(n.transaction,"-").concat(n.project):void 0:delete a[r],o.browserHistory.push({pathname:t.pathname,query:a})}}function O(t,e,n){const a=(0,D.IO)(t).column,s=(0,k.ro)(t.query.query),i=new C.MY(null!=s?s:""),c=i.getFilterValues(a),l=n===r.GREATER_THAN_EQUALS?">":"<";c&&c.forEach((t=>{(t.startsWith(n)||t.startsWith(l))&&i.removeFilterValue(a,t)})),i.addFilterValues(a,["".concat(n).concat(e)]);const d=i.formatString();o.browserHistory.push({pathname:t.pathname,query:{...t.query,query:String(d).trim()}})}function X(t){const{location:e,trendChangeType:n,previousTrendFunction:r,previousTrendColumn:a,organization:i,projects:c,setError:l}=t,d=(0,q.Z)(),p=t.trendView.clone(),u=function(t){switch(t){case B.ER.IMPROVED:return(0,_.t)("Most Improved Transactions");case B.ER.REGRESSION:return(0,_.t)("Most Regressed Transactions");default:throw new Error("No trend type passed")}}(n);(0,D.kM)(p,e,n);const m=(t=>(e,n,r)=>{const a={};t===B.ER.IMPROVED?a.improvedCursor=e:t===B.ER.REGRESSION&&(a.regressionCursor=e),delete r[(0,D.j_)(t)],o.browserHistory.push({pathname:n,query:{...r,...a}})})(n),g=(0,k.ro)(e.query[D.vt[n]]);return(0,A.tZ)(j.ZP,{eventView:p,orgSlug:i.slug,location:e,trendChangeType:n,cursor:g,limit:5,setError:l,children:({isLoading:o,trendsData:l,pageLinks:g})=>{const x=(0,D.CE)(e),Z=(0,D.IO)(e),y=(0,D.RP)(l&&l.events&&l.events.data||[]),w=I(e,n,y),b=(null==l?void 0:l.stats)||{},S=y&&y.slice?y.slice(0,5):[],E=o&&r?r:x.field,T=o&&a?a:Z.column,j=(0,_.t)("This compares the baseline (%s) of the past with the present.",x.legendLabel);return(0,A.BX)(Q,{children:[(0,A.BX)(K,{children:[(0,A.BX)($,{children:[u,(0,A.tZ)(v.Z,{size:"sm",position:"top",title:j})]}),o?(0,A.tZ)(h.Z,{style:{margin:"237px auto"}}):(0,A.tZ)(s.Fragment,{children:S.length?(0,A.BX)(s.Fragment,{children:[(0,A.tZ)(W,{children:(0,A.tZ)(P.Z,{statsData:b,query:p.query,project:p.project,environment:p.environment,start:p.start,end:p.end,statsPeriod:p.statsPeriod,transaction:w,isLoading:o,...t})}),S.map(((r,a)=>(0,A.tZ)(V,{api:d,currentTrendFunction:E,currentTrendColumn:T,trendView:t.trendView,organization:i,transaction:r,index:a,trendChangeType:n,transactions:S,location:e,projects:c,statsData:b,handleSelectTransaction:M(e,n)},r.transaction)))]}):(0,A.tZ)(tt,{small:!0,children:(0,_.t)("No results")})})]}),(0,A.tZ)(f.Z,{pageLinks:g,onCursor:m})]})}})}function V(t){const{transaction:e,transactions:n,trendChangeType:a,currentTrendFunction:i,currentTrendColumn:c,index:p,location:u,projects:g,handleSelectTransaction:h}=t,f=D.es[a].default,Z=I(u,a,n)===e,v=g.find((({slug:t})=>t===e.project)),S=e.aggregate_range_2,E=e.aggregate_range_1,j=(0,T.rl)(Math.abs(e.trend_percentage-1),0),q=(0,T.g9)(E/1e3,E<1e3&&E>10?0:2),L=(0,T.g9)(S/1e3,S<1e3&&S>10?0:2),R=(0,_.t)("Over this period, the %s for %s has %s %s from %s to %s",i,c,a===B.ER.IMPROVED?(0,_.t)("decreased"):(0,_.t)("increased"),j,q,L),z=a===B.ER.IMPROVED?E:S,N=a===B.ER.IMPROVED?q:L;return(0,A.BX)(et,{"data-test-id":"trends-list-item-"+a,children:[(0,A.tZ)(nt,{color:f,children:(0,A.tZ)(w.Z,{title:(0,A.BX)(ct,{children:[(0,A.tZ)("span",{children:(0,_.t)("Total Events")}),(0,A.BX)("span",{children:[(0,A.tZ)(l.Z,{value:e.count_range_1}),(0,A.tZ)(lt,{direction:"right",size:"xs"}),(0,A.tZ)(l.Z,{value:e.count_range_2})]})]}),disableForVisualTest:!0,children:(0,A.tZ)(F.V,{index:p,role:"radio",children:(0,A.tZ)(y.Z,{checked:Z,onChange:()=>h(e)})})})}),(0,A.tZ)(U,{...t}),(0,A.tZ)(ot,{children:(0,A.tZ)(w.Z,{title:R,children:(0,A.BX)(s.Fragment,{children:[a===B.ER.REGRESSION?"+":"",(0,T.rl)(e.trend_percentage-1,0)]})})}),(0,A.BX)(d.Z,{caret:!1,anchorRight:!0,title:(0,A.tZ)(Y,{size:"xsmall",icon:(0,A.tZ)(b.YR,{"data-test-id":"trends-item-action",size:"xs"})}),children:[(0,A.tZ)(x.Z,{onClick:()=>O(u,z,r.LESS_THAN_EQUALS),children:(0,A.tZ)(J,{children:(0,_.t)("Show ≤ %s",N)})}),(0,A.tZ)(x.Z,{onClick:()=>O(u,z,r.GREATER_THAN_EQUALS),children:(0,A.tZ)(J,{children:(0,_.t)("Show ≥ %s",N)})}),(0,A.tZ)(x.Z,{onClick:()=>function(t,e){const n=(0,k.ro)(t.query.query),r=new C.MY(null!=n?n:"");r.addFilterValues("!transaction",[e]);const a=r.formatString();o.browserHistory.push({pathname:t.pathname,query:{...t.query,query:String(a).trim()}})}(u,e.transaction),children:(0,A.tZ)(J,{children:(0,_.t)("Hide from list")})})]}),(0,A.BX)(at,{children:[v&&(0,A.tZ)(w.Z,{title:e.project,children:(0,A.tZ)(m.Z,{avatarSize:16,project:v,hideName:!0})}),(0,A.tZ)(H,{...t})]}),(0,A.tZ)(it,{color:f,children:(0,A.tZ)(G,{...t})})]})}!function(t){t.GREATER_THAN_EQUALS=">=",t.LESS_THAN_EQUALS="<="}(r||(r={})),X.displayName="ChangedTransactions",V.displayName="TrendsListItem";const H=({transaction:t})=>{const{fromSeconds:e,toSeconds:n,showDigits:r}=(0,D.Kt)(t.aggregate_range_1,t.aggregate_range_2);return(0,A.BX)(st,{children:[(0,A.tZ)(p.Z,{seconds:e,fixedDigits:r?1:0,abbreviation:!0}),(0,A.tZ)(lt,{direction:"right",size:"xs"}),(0,A.tZ)(p.Z,{seconds:n,fixedDigits:r?1:0,abbreviation:!0})]})};H.displayName="CompareDurations";const G=({transaction:t,trendChangeType:e})=>{const{seconds:n,fixedDigits:r,changeLabel:a}=(0,D.wx)(t.trend_difference,e);return(0,A.BX)("span",{children:[(0,A.tZ)(p.Z,{seconds:n,fixedDigits:r,abbreviation:!0})," ",a]})};G.displayName="ValueDelta";const U=t=>{const{organization:e,trendView:n,transaction:r,projects:a,currentTrendFunction:s,currentTrendColumn:o}=t,i=n.clone(),c=(0,D._H)(r,a),l=(0,N.e1)({orgSlug:e.slug,transaction:String(r.transaction),query:i.generateQueryStringObject(),projectID:c,display:z.D.TREND,trendFunction:s,trendColumn:o});return(0,A.tZ)(rt,{to:l,children:r.transaction})};U.displayName="TransactionSummaryLink";const Q=(0,a.Z)("div",{target:"e11bn3w115"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"}),K=(0,a.Z)(Z.s_,{target:"e11bn3w114"})({name:"154zghl",styles:"margin:0;flex-grow:1"}),W=(0,a.Z)("div",{target:"e11bn3w113"})("padding:",(0,E.Z)(3),";"),$=(0,a.Z)(c.ws,{target:"e11bn3w112"})("border-radius:",(t=>t.theme.borderRadius),";margin:",(0,E.Z)(2)," ",(0,E.Z)(3),";"),Y=(0,a.Z)(i.ZP,{target:"e11bn3w111"})({name:"1989ovb",styles:"vertical-align:middle"}),J=(0,a.Z)("div",{target:"e11bn3w110"})("white-space:nowrap;color:",(t=>t.theme.textColor),";"),tt=(0,a.Z)(u.Z,{target:"e11bn3w19"})({name:"1t1oqhu",styles:"min-height:300px;justify-content:center"}),et=(0,a.Z)("div",{target:"e11bn3w18"})("display:grid;grid-template-columns:24px auto 100px 30px;grid-template-rows:repeat(2, auto);grid-column-gap:",(0,E.Z)(1),";border-top:1px solid ",(t=>t.theme.border),";padding:",(0,E.Z)(1)," ",(0,E.Z)(2),";"),nt=(0,a.Z)("div",{target:"e11bn3w17"})("grid-row:1/3;input{cursor:pointer;}input:checked::after{background-color:",(t=>t.color),";}"),rt=(0,a.Z)(g.Z,{target:"e11bn3w16"})("font-size:",(t=>t.theme.fontSizeMedium),";margin-right:",(0,E.Z)(1),";",S.Z,";"),at=(0,a.Z)("div",{target:"e11bn3w15"})("display:flex;align-items:center;font-size:",(t=>t.theme.fontSizeSmall),";"),st=(0,a.Z)("span",{target:"e11bn3w14"})("color:",(t=>t.theme.gray300),";margin:0 ",(0,E.Z)(1),";"),ot=(0,a.Z)("div",{target:"e11bn3w13"})("text-align:right;font-size:",(t=>t.theme.fontSizeMedium),";"),it=(0,a.Z)("div",{target:"e11bn3w12"})("color:",(t=>t.color),";text-align:right;font-size:",(t=>t.theme.fontSizeSmall),";"),ct=(0,a.Z)("div",{target:"e11bn3w11"})({name:"zigog8",styles:"display:flex;flex-direction:column;align-items:center"}),lt=(0,a.Z)(b.CC,{target:"e11bn3w10"})("margin:0 ",(0,E.Z)(1),";"),dt=(0,R.Z)((0,L.Z)(X))},"./app/views/performance/trends/chart.tsx":(t,e,n)=>{n.d(e,{k:()=>v,Z:()=>y}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../node_modules/react-router/es/index.js"),a=n("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),s=n("./app/components/charts/chartZoom.tsx"),o=n("./app/components/charts/lineChart.tsx"),i=n("./app/components/charts/transitionChart.tsx"),c=n("./app/components/charts/transparentLoadingMask.tsx"),l=n("./app/components/charts/utils.tsx"),d=n("./app/components/organizations/pageFilters/parse.tsx"),p=n("./app/locale.tsx"),u=n("./app/utils/dates.tsx"),m=n("./app/utils/discover/charts.tsx"),g=n("./app/utils/getDynamicText.tsx"),h=n("./app/utils/queryString.tsx"),x=n("./app/views/performance/trends/utils.tsx"),f=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function Z(t){return{right:10,top:0,itemGap:12,align:"left",data:[{name:"Baseline",icon:"path://M180 1000 l0 -40 200 0 200 0 0 40 0 40 -200 0 -200 0 0 -40z, M810 1000 l0 -40 200 0 200 0 0 40 0 40 -200 0 -200 0 0 -40zm, M1440 1000 l0 -40 200 0 200 0 0 40 0 40 -200 0 -200 0 0 -40z"},{name:"Releases"},{name:t}]}}function v({trendChangeType:t,router:e,statsPeriod:n,transaction:v,statsData:y,isLoading:w,location:b,start:_,end:S,trendFunctionField:E,disableXAxis:T,disableLegend:j,grid:k,height:C}){var q;const L=(0,a.u)(),R=e=>{const{selected:n}=e,a=Object.keys(n).filter((t=>!n[t])),s={...b.query};s[(0,x.P4)(t)]=a;const o={...b,query:s};r.browserHistory.push(o)},F=x.es[t||""],z=y&&null!=v&&v.project&&null!=v&&v.transaction?y[[v.project,v.transaction].join(",")]:void 0,N=null!==(q=null==z?void 0:z.data)&&void 0!==q?q:[],P=(0,x.CE)(b,E),B=(0,x.IO)(b),D=(0,x.ed)(P.field,B.column),A=function(t,e){return[{seriesName:e||"Current",data:t.map((([t,e])=>({name:1e3*t,value:e.reduce(((t,{count:e})=>t+e),0)})))}]}(N,D),{smoothedResults:I,minValue:M,maxValue:O}=(0,x.vq)(A,D),X=_?(0,u.hC)(_):null,V=S?(0,u.hC)(S):null,{utc:H}=(0,d.fK)(b.query),G=(0,h.qP)(b.query[(0,x.P4)(t)]).reduce(((t,e)=>(t[e]=!1,t)),{}),U=j?{show:!1}:{...Z(D),selected:G},Q=w,K=w,W=Math.max(O,(null==v?void 0:v.aggregate_range_2)||0,(null==v?void 0:v.aggregate_range_1)||0),$=Math.min(M,(null==v?void 0:v.aggregate_range_1)||Number.MAX_SAFE_INTEGER,(null==v?void 0:v.aggregate_range_2)||Number.MAX_SAFE_INTEGER),Y=.1*(W-$),J={tooltip:{valueFormatter:(t,e)=>(0,m.CX)(t,e)},yAxis:{min:Math.max(0,$-Y),max:W+Y,axisLabel:{color:L.chartLabel,formatter:t=>(0,m.gu)(t,"p50()")}}};return(0,f.tZ)(s.Z,{router:e,period:n,start:X,end:V,utc:"true"===H,children:t=>{const e=I?I.map((t=>({...t,color:F.default,lineStyle:{opacity:1}}))):[],n=function(t,e,n,r){if(!(r&&e.length&&e[0].data&&e[0].data.length))return[];const a=parseInt(e[0].data[0].name,0),s=parseInt(e[0].data.slice(-1)[0].name,0);if(s<a)return[];const o={data:[],color:t.textColor,markLine:{data:[],label:{},lineStyle:{color:t.textColor,type:"dashed",width:1},symbol:["none","none"],tooltip:{show:!1}},seriesName:"Baseline"},i={fontSize:11,show:!0,color:t.textColor,silent:!0},c={...o,markLine:{...o.markLine},seriesName:"Baseline"},d={...o,markLine:{...o.markLine},seriesName:"Baseline"},u={...o,markLine:{...o.markLine},seriesName:"Period split"},g=.5*(s-a)+a;return c.markLine.data=[[{value:"Past",coord:[a,r.aggregate_range_1]},{coord:[g,r.aggregate_range_1]}]],c.markLine.tooltip={formatter:()=>['<div class="tooltip-series tooltip-series-solo">',"<div>",'<span class="tooltip-label"><strong>'.concat((0,p.t)("Past Baseline"),"</strong></span>"),(0,m.CX)(r.aggregate_range_1,"p50()"),"</div>","</div>",(0,l.U8)()].join("")},d.markLine.data=[[{value:"Present",coord:[g,r.aggregate_range_2]},{coord:[s,r.aggregate_range_2]}]],d.markLine.tooltip={formatter:()=>['<div class="tooltip-series tooltip-series-solo">',"<div>",'<span class="tooltip-label"><strong>'.concat((0,p.t)("Present Baseline"),"</strong></span>"),(0,m.CX)(r.aggregate_range_2,"p50()"),"</div>","</div>",(0,l.U8)()].join("")},u.markLine={data:[{xAxis:g}],label:{show:!1},lineStyle:{color:t.textColor,type:"solid",width:2},symbol:["none","none"],tooltip:{show:!1},silent:!0},c.markLine.label={...i,formatter:"Past",position:"insideStartBottom"},d.markLine.label={...i,formatter:"Present",position:"insideEndBottom"},[c,d,u]}(L,I||[],0,v);return(0,f.BX)(i.Z,{loading:Q,reloading:K,children:[(0,f.tZ)(c.Z,{visible:K}),(0,g.Z)({value:(0,f.tZ)(o.Z,{height:C,...t,...J,onLegendSelectChanged:R,series:[...e,...n],seriesOptions:{showSymbol:!1},legend:U,toolBox:{show:!1},grid:null!=k?k:{left:"10px",right:"10px",top:"40px",bottom:"0px"},xAxis:T?{show:!1}:void 0}),fixed:"Duration Chart"})]})}})}v.displayName="Chart";const y=(0,r.withRouter)(v)}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_transactionSummary_transactionEvents_utils_tsx-app_views_performance_tr-897be4.dda0974c81d45b53addd6fbf3484aa15.js.map