"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_organizationGroupDetails_groupTagValues_tsx"],{"./app/components/dataExport.tsx":(e,t,s)=>{s.d(t,{tD:()=>y,ZP:()=>x});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),n=s("../node_modules/lodash/debounce.js"),a=s.n(n),r=s("../node_modules/lodash/isEqual.js"),l=s.n(r),d=s("./app/actionCreators/indicator.tsx"),c=s("./app/components/acl/feature.tsx"),p=s("./app/components/button.tsx"),u=s("./app/locale.tsx"),m=s("./app/utils/withApi.tsx"),h=s("./app/utils/withOrganization.tsx"),g=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");let y;!function(e){e.IssuesByTag="Issues-by-Tag",e.Discover="Discover"}(y||(y={}));class Z extends o.Component{constructor(...e){super(...e),(0,i.Z)(this,"state",this.initialState),(0,i.Z)(this,"resetState",(()=>{this.setState(this.initialState)})),(0,i.Z)(this,"startDataExport",(()=>{const{api:e,organization:{slug:t},payload:{queryType:s,queryInfo:i}}=this.props;this.setState({inProgress:!0}),e.requestPromise("/organizations/".concat(t,"/data-export/"),{includeAllArgs:!0,method:"POST",data:{query_type:s,query_info:i}}).then((([e,t,s])=>{(0,d.S9)(201===(null==s?void 0:s.status)?(0,u.t)("Sit tight. We'll shoot you an email when your data is ready for download."):(0,u.t)("It looks like we're already working on it. Sit tight, we'll email you."))})).catch((e=>{var t,s;const i=null!==(t=null==e||null===(s=e.responseJSON)||void 0===s?void 0:s.detail)&&void 0!==t?t:"We tried our hardest, but we couldn't export your data. Give it another go.";(0,d.Iw)((0,u.t)(i)),this.setState({inProgress:!1})}))}))}componentDidUpdate({payload:e}){const{payload:t}=this.props;l()(e,t)||this.resetState()}get initialState(){return{inProgress:!1}}render(){const{inProgress:e}=this.state,{children:t,disabled:s,icon:i}=this.props;return(0,g.tZ)(c.Z,{features:["organizations:discover-query"],children:e?(0,g.tZ)(p.ZP,{size:"small",priority:"default",title:"You can get on with your life. We'll email you when your data's ready.",...this.props,disabled:!0,icon:i,children:(0,u.t)("We're working on it...")}):(0,g.tZ)(p.ZP,{onClick:a()(this.startDataExport,500),disabled:s||!1,size:"small",priority:"default",title:"Put your data to work. Start your export and we'll email you when it's finished.",icon:i,...this.props,children:t||(0,u.t)("Export All to CSV")})})}}Z.displayName="DataExport";const x=(0,m.Z)((0,h.Z)(Z))},"./app/components/deviceName.tsx":(e,t,s)=>{s.d(t,{qW:()=>a,f:()=>r,ZP:()=>l});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e,t){const s=e.split(" ")[0],i=e.split(" ").splice(1).join(" "),o=t.generationByIdentifier(s);return void 0===o?e:o+" "+i}async function r(){return s.e("vendors-node_modules_ios-device-list_dist_ios-device-list_min_js").then(s.t.bind(s,"../node_modules/ios-device-list/dist/ios-device-list.min.js",23))}class l extends o.Component{constructor(e){super(e),(0,i.Z)(this,"_isMounted",void 0),this.state={iOSDeviceList:null}}componentDidMount(){this._isMounted=!0,r().then((e=>{this._isMounted&&this.setState({iOSDeviceList:e})}))}componentWillUnmount(){this._isMounted=!1}render(){const{value:e,children:t}=this.props,{iOSDeviceList:s}=this.state;if(!e)return null;if(!s)return e;const i=a(e,s);return(0,n.tZ)("span",{"data-test-id":"loaded-device-name",children:t?t(i):i})}}l.displayName="DeviceName"},"./app/views/organizationGroupDetails/groupTagValues.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>q});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),n=s("./app/components/acl/feature.tsx"),a=s("./app/components/asyncComponent.tsx"),r=s("./app/components/button.tsx"),l=s("./app/components/buttonBar.tsx"),d=s("./app/components/dataExport.tsx"),c=s("./app/components/deviceName.tsx"),p=s("./app/components/dropdownLink.tsx"),u=s("./app/components/globalSelectionLink.tsx"),m=s("./app/components/idBadge/userBadge.tsx"),h=s("./app/components/links/externalLink.tsx"),g=s("./app/components/links/link.tsx"),y=s("./app/components/pagination.tsx"),Z=s("./app/components/panels/index.tsx"),x=s("./app/components/timeSince.tsx"),v=s("./app/icons/index.tsx"),f=s("./app/locale.tsx"),b=s("./app/styles/overflowEllipsis.tsx"),w=s("./app/styles/space.tsx"),j=s("./app/utils.tsx"),S=s("./app/utils/discover/eventView.tsx"),_=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class P extends a.Z{getEndpoints(){const{environments:e}=this.props,{groupId:t,tagKey:s}=this.props.params;return[["tag","/issues/".concat(t,"/tags/").concat(s,"/")],["tagValueList","/issues/".concat(t,"/tags/").concat(s,"/values/"),{query:{environment:e,sort:this.getSort()}}]]}getSort(){return this.props.location.query.sort||"count"}renderLoading(){return this.renderBody()}renderResults(){const{baseUrl:e,project:t,environments:s,params:{orgId:i,groupId:a,tagKey:l}}=this.props,{tagValueList:d,tag:h}=this.state,y=["title","release","environment","user.display","timestamp"];return null==d?void 0:d.map(((d,Z)=>{var b,w;const P=null!=h&&h.totalValues?"".concat((0,j.aQ)(d.count,null==h?void 0:h.totalValues).toFixed(2),"%"):"--",q=null!==(b=d.key)&&void 0!==b?b:l,k=d.query||"".concat(q,':"').concat(d.value,'"'),z=S.ZP.fromSavedQuery({id:void 0,name:q,fields:[q,...y.filter((e=>e!==q))],orderby:"-timestamp",query:"issue.id:".concat(a," ").concat(k),projects:[Number(null==t?void 0:t.id)],environment:s,version:2,range:"90d"}),B="/organizations/".concat(i,"/issues/");return(0,_.BX)(o.Fragment,{children:[(0,_.BX)(I,{children:[(0,_.tZ)(E,{"data-test-id":"group-tag-value",children:(0,_.tZ)(u.Z,{to:{pathname:"".concat(e,"events/"),query:{query:k}},children:"user"===q?(0,_.tZ)(m.Z,{user:{...d,id:null!==(w=d.identifier)&&void 0!==w?w:""},avatarSize:20,hideEmail:!0}):(0,_.tZ)(c.ZP,{value:d.name})})}),d.email&&(0,_.tZ)(V,{href:"mailto:".concat(d.email),"data-test-id":"group-tag-mail",children:(0,_.tZ)(v.h,{size:"xs",color:"gray300"})}),(0,j.CB)(d.value)&&(0,_.tZ)(V,{href:d.value,"data-test-id":"group-tag-url",children:(0,_.tZ)(v.V$,{size:"xs",color:"gray300"})})]}),(0,_.tZ)(T,{children:P}),(0,_.tZ)(T,{children:d.count.toLocaleString()}),(0,_.tZ)(T,{children:(0,_.tZ)(x.Z,{date:d.lastSeen})}),(0,_.tZ)(T,{children:(0,_.BX)(p.Z,{anchorRight:!0,alwaysRenderMenu:!1,caret:!1,title:(0,_.tZ)(r.ZP,{tooltipProps:{containerDisplayMode:"flex"},size:"small",type:"button","aria-label":(0,f.t)("Show more"),icon:(0,_.tZ)(v.YR,{size:"xs"})}),children:[(0,_.tZ)(n.Z,{features:["organizations:discover-basic"],children:(0,_.tZ)("li",{children:(0,_.tZ)(g.Z,{to:z.getResultsViewUrlTarget(i),children:(0,f.t)("Open in Discover")})})}),(0,_.tZ)("li",{children:(0,_.tZ)(u.Z,{to:{pathname:B,query:{query:k}},children:(0,f.t)("Search All Issues with Tag Value")})})]})})]},Z)}))}renderBody(){const{group:e,params:{orgId:t,tagKey:s},location:{query:i},environments:n}=this.props,{tagValueList:a,tag:c,tagValueListPageLinks:p,loading:u}=this.state,{cursor:m,page:h,...g}=i,y="user"===s?(0,f.t)("Affected Users"):s,Z=this.getSort(),x=(0,_.tZ)(v.CC,{color:"gray300",size:"xs",direction:"down"}),b=(0,_.BX)(L,{to:{pathname:location.pathname,query:{...g,sort:"date"}},children:[(0,f.t)("Last Seen")," ","date"===Z&&x]}),w=(0,_.BX)(L,{to:{pathname:location.pathname,query:{...g,sort:"count"}},children:[(0,f.t)("Count")," ","count"===Z&&x]});return(0,_.BX)(o.Fragment,{children:[(0,_.BX)(k,{children:[(0,_.tZ)(z,{children:(0,f.t)("Tag Details")}),(0,_.BX)(l.ZP,{gap:1,children:[(0,_.tZ)(r.ZP,{size:"small",priority:"default",href:"/".concat(t,"/").concat(e.project.slug,"/issues/").concat(e.id,"/tags/").concat(s,"/export/"),children:(0,f.t)("Export Page to CSV")}),(0,_.tZ)(d.ZP,{payload:{queryType:d.tD.IssuesByTag,queryInfo:{project:e.project.id,group:e.id,key:s}}})]})]}),(0,_.tZ)(B,{isLoading:u,isEmpty:0===(null==a?void 0:a.length),headers:[y,(0,_.tZ)(D,{children:(0,f.t)("Percent")},"percent"),w,b,""],emptyMessage:(0,f.t)("Sorry, the tags for this issue could not be found."),emptyAction:null!=n&&n.length?(0,f.t)("No tags were found for the currently selected environments"):null,children:a&&c&&this.renderResults()}),(0,_.tZ)(M,{pageLinks:p})]})}}const q=P,k=(0,i.Z)("div",{target:"e8ib56610"})("display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;justify-content:space-between;margin-bottom:",(0,w.Z)(2),";"),z=(0,i.Z)("h3",{target:"e8ib5669"})({name:"ti75j2",styles:"margin:0"}),B=(0,i.Z)(Z.KB,{target:"e8ib5668"})("white-space:nowrap;font-size:",(e=>e.theme.fontSizeMedium),";overflow:auto;@media (min-width: ",(e=>e.theme.breakpoints[0]),"){overflow:initial;}&>*{padding:",(0,w.Z)(1)," ",(0,w.Z)(2),";}"),D=(0,i.Z)("div",{target:"e8ib5667"})({name:"2qga7i",styles:"text-align:right"}),L=(0,i.Z)(g.Z,{target:"e8ib5666"})({name:"7p2agl",styles:"text-align:right;color:inherit;:hover{color:inherit;}"}),V=(0,i.Z)(h.Z,{target:"e8ib5665"})("margin-left:",(0,w.Z)(.5),";"),C=(0,i.Z)("div",{target:"e8ib5664"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),I=(0,i.Z)(C,{target:"e8ib5663"})(b.Z,";display:flex;min-width:320px;"),E=(0,i.Z)("span",{target:"e8ib5662"})(b.Z,";width:auto;"),T=(0,i.Z)(C,{target:"e8ib5661"})({name:"1f60if8",styles:"justify-content:flex-end"}),M=(0,i.Z)(y.Z,{target:"e8ib5660"})({name:"ti75j2",styles:"margin:0"})}}]);
//# sourceMappingURL=../sourcemaps/app_views_organizationGroupDetails_groupTagValues_tsx.4acd4e6a3d9f494b9935083fb28a51c8.js.map