"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_actionCreators_navigation_tsx-app_actions_teamActions_tsx-app_stores_latestContextStore_t-3fc2cc"],{"./app/actionCreators/navigation.tsx":(e,t,s)=>{s.d(t,{T:()=>a}),s("../node_modules/core-js/modules/es.string.replace.js");var o=s("./app/actionCreators/modal.tsx"),r=s("./app/components/contextPickerModal.tsx"),i=s("./app/stores/projectsStore.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e,t,s){var a,c;const l=e.indexOf(":orgId")>-1,d=e.indexOf(":projectId")>-1,p=null==t||null===(a=t.location)||void 0===a||null===(c=a.query)||void 0===c?void 0:c.project,u=!p||Array.isArray(p),h=i.Z.getById(p);l||d&&(u||!h)||s?(0,o.openModal)((o=>(0,n.tZ)(r.Z,{...o,nextPath:e,needOrg:l,needProject:d,configUrl:s,comingFromProjectId:Array.isArray(p)?"":p||"",onFinish:e=>{o.closeModal(),setTimeout((()=>t.push(e)),0)}})),{}):h?t.push(e.replace(":projectId",h.slug)):t.push(e)}},"./app/actions/organizationsActions.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});var o=s("../node_modules/reflux/src/index.js");const r=s.n(o)().createActions(["update","setActive","changeSlug","remove","removeSuccess","removeError"])},"./app/actions/projectActions.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});var o=s("../node_modules/reflux/src/index.js");const r=s.n(o)().createActions(["addTeam","addTeamError","addTeamSuccess","changeSlug","createSuccess","loadProjects","loadStats","loadStatsError","loadStatsForProjectSuccess","loadStatsSuccess","removeProject","removeProjectError","removeProjectSuccess","removeTeam","removeTeamError","removeTeamSuccess","reset","setActive","update","updateError","updateSuccess"])},"./app/actions/teamActions.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});var o=s("../node_modules/reflux/src/index.js");const r=s.n(o)().createActions(["createTeam","createTeamError","createTeamSuccess","fetchAll","fetchAllError","fetchAllSuccess","fetchDetails","fetchDetailsError","fetchDetailsSuccess","loadTeams","loadUserTeams","removeTeam","removeTeamError","removeTeamSuccess","update","updateError","updateSuccess"])},"./app/components/contextPickerModal.tsx":(e,t,s)=>{s.d(t,{Z:()=>Z});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),n=s("../node_modules/react-dom/profiling.js"),a=s("../node_modules/react-select/dist/chunk-80640036.browser.esm.js"),c=s("./app/components/asyncComponent.tsx"),l=s("./app/components/forms/selectControl.tsx"),d=s("./app/components/idBadge/index.tsx"),p=s("./app/components/links/link.tsx"),u=s("./app/components/loadingIndicator.tsx"),h=s("./app/locale.tsx"),g=s("./app/stores/configStore.tsx"),m=s("./app/stores/organizationsStore.tsx"),_=s("./app/stores/organizationStore.tsx"),f=s("./app/styles/space.tsx"),j=s("./app/utils/projects.tsx"),v=s("./app/utils/replaceRouterParams.tsx"),S=s("./app/views/organizationIntegrations/integrationIcon.tsx"),w=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const b={menu:e=>({...e,position:"initial",boxShadow:"none",marginBottom:0}),option:(e,t)=>({...e,opacity:t.isDisabled?.6:1,cursor:t.isDisabled?"not-allowed":"pointer",pointerEvents:t.isDisabled?"none":"auto"})};class x extends i.Component{constructor(...e){super(...e),(0,o.Z)(this,"orgSelect",null),(0,o.Z)(this,"projectSelect",null),(0,o.Z)(this,"configSelect",null),(0,o.Z)(this,"navigateIfFinish",((e,t,s=this.props.organization)=>{var o;const{needProject:r,onFinish:i,nextPath:n,integrationConfigs:a}=this.props,{isSuperuser:c}=g.Z.get("user")||{};if(!r&&1!==e.length||r&&1!==t.length||a.length&&c)return;if(!r)return void i((0,v.Z)(n,{orgId:e[0].slug}));let l=s;l||1!==e.length||(l=e[0].slug),i((0,v.Z)(n,{orgId:l,projectId:t[0].slug,project:null===(o=this.props.projects.find((e=>e.slug===t[0].slug)))||void 0===o?void 0:o.id}))})),(0,o.Z)(this,"doFocus",(e=>{if(!e||this.props.loading)return;const t=n.findDOMNode(e);if(null!==t){const e=t.querySelector("input");e&&e.focus()}})),(0,o.Z)(this,"handleSelectOrganization",(({value:e})=>{this.props.needProject?this.props.onSelectOrganization(e):this.navigateIfFinish([{slug:e}],[])})),(0,o.Z)(this,"handleSelectProject",(({value:e})=>{const{organization:t}=this.props;e&&t&&this.navigateIfFinish([{slug:t}],[{slug:e}])})),(0,o.Z)(this,"handleSelectConfiguration",(({value:e})=>{const{onFinish:t,nextPath:s}=this.props;e&&t("".concat(s).concat(e,"/"))})),(0,o.Z)(this,"getMemberProjects",(()=>{const{projects:e}=this.props,t=[],s=[];return e.forEach((e=>e.isMember?s.push(e):t.push(e))),[s,t]})),(0,o.Z)(this,"onMenuOpen",((e,t,s,o="")=>{setTimeout((()=>{if(e){const r=e.select.state.menuOptions.focusable,i=t.find((({id:e})=>e===o)),n=i?r.findIndex((e=>e.value===i[s])):0;n>=0&&i&&(e.select.scrollToFocusedOptionOnUpdate=!0,e.select.inputIsHiddenAfterUpdate=!1,e.select.setState({focusedValue:null,focusedOption:r[n]}))}}))})),(0,o.Z)(this,"customOptionProject",(({label:e,...t})=>{const s=this.props.projects.find((({slug:e})=>t.value===e));return s?(0,w.tZ)(a.y.Option,{label:e,...t,children:(0,w.tZ)(d.Z,{project:s,avatarSize:20,displayName:e,avatarProps:{consistentWidth:!0}})}):null}))}componentDidMount(){const{organization:e,projects:t,organizations:s}=this.props;1===s.length&&e&&this.navigateIfFinish([{slug:e}],t)}componentDidUpdate(e){JSON.stringify(e.projects)!==JSON.stringify(this.props.projects)&&this.navigateIfFinish(this.props.organizations,this.props.projects)}get headerText(){const{needOrg:e,needProject:t,integrationConfigs:s}=this.props;return e&&t?(0,h.t)("Select an organization and a project to continue"):e?(0,h.t)("Select an organization to continue"):t?(0,h.t)("Select a project to continue"):s.length?(0,h.t)("Select a configuration to continue"):""}renderProjectSelectOrMessage(){const{organization:e,projects:t,comingFromProjectId:s}=this.props,[o,r]=this.getMemberProjects(),{isSuperuser:i}=g.Z.get("user")||{},n=[{label:(0,h.t)("My Projects"),options:o.map((e=>({value:e.slug,label:(0,h.t)("".concat(e.slug)),isDisabled:!1})))},{label:(0,h.t)("All Projects"),options:r.map((e=>({value:e.slug,label:(0,h.t)("".concat(e.slug)),isDisabled:!i})))}];return t.length?(0,w.tZ)(P,{ref:e=>{this.projectSelect=e,this.doFocus(this.projectSelect)},placeholder:(0,h.t)("Select a Project to continue"),name:"project",options:n,onChange:this.handleSelectProject,onMenuOpen:()=>this.onMenuOpen(this.projectSelect,t,"slug",s),components:{Option:this.customOptionProject,DropdownIndicator:null},styles:b,menuIsOpen:!0}):(0,w.tZ)("div",{children:(0,h._N)("You have no projects. Click [link] to make one.",{link:(0,w.tZ)(p.Z,{to:"/organizations/".concat(e,"/projects/new/"),children:(0,h.t)("here")})})})}renderIntegrationConfigs(){const{integrationConfigs:e}=this.props,{isSuperuser:t}=g.Z.get("user")||{},s=[{label:(0,h._N)("[providerName] Configurations",{providerName:e[0].provider.name}),options:e.map((e=>({value:e.id,label:(0,w.BX)(C,{children:[(0,w.tZ)(S.Z,{size:22,integration:e}),(0,w.tZ)("span",{children:e.domainName})]}),isDisabled:!t})))}];return(0,w.tZ)(P,{ref:e=>{this.configSelect=e,this.doFocus(this.configSelect)},placeholder:(0,h.t)("Select a configuration to continue"),name:"configurations",options:s,onChange:this.handleSelectConfiguration,onMenuOpen:()=>this.onMenuOpen(this.configSelect,e,"id"),components:{DropdownIndicator:null},styles:b,menuIsOpen:!0})}render(){const{needOrg:e,needProject:t,organization:s,organizations:o,loading:r,Header:n,Body:a,integrationConfigs:c}=this.props,{isSuperuser:l}=g.Z.get("user")||{},d=s&&t&&!r,p=c.length>0&&l,u=o.filter((({status:e})=>"pending_deletion"!==e.id)).map((({slug:e})=>({label:e,value:e})));return e||t||p?(0,w.BX)(i.Fragment,{children:[(0,w.tZ)(n,{closeButton:!0,children:this.headerText}),(0,w.BX)(a,{children:[r&&(0,w.tZ)(z,{overlay:!0}),e&&(0,w.tZ)(P,{ref:e=>{this.orgSelect=e,d||this.doFocus(this.orgSelect)},placeholder:(0,h.t)("Select an Organization"),name:"organization",options:u,value:s,onChange:this.handleSelectOrganization,components:{DropdownIndicator:null},styles:b,menuIsOpen:!0}),d&&this.renderProjectSelectOrMessage(),p&&this.renderIntegrationConfigs()]})]}):null}}x.displayName="ContextPickerModal";class y extends c.Z{constructor(...e){super(...e),(0,o.Z)(this,"unlistener",m.Z.listen((e=>this.setState({organizations:e})),void 0)),(0,o.Z)(this,"handleSelectOrganization",(e=>{this.setState({selectedOrganization:e})}))}getDefaultState(){var e;const t=_.Z.get();return{...super.getDefaultState(),organizations:m.Z.getAll(),selectedOrganization:null===(e=t.organization)||void 0===e?void 0:e.slug}}getEndpoints(){const{configUrl:e}=this.props;return e?[["integrationConfigs",e]]:[]}componentWillUnmount(){var e;null===(e=this.unlistener)||void 0===e||e.call(this)}renderModal({projects:e,initiallyLoaded:t,integrationConfigs:s}){return(0,w.tZ)(x,{...this.props,projects:e||[],loading:!t,organizations:this.state.organizations,organization:this.state.selectedOrganization,onSelectOrganization:this.handleSelectOrganization,integrationConfigs:s||[]})}render(){var e;const{projectSlugs:t,configUrl:s}=this.props;return s&&this.state.loading?(0,w.tZ)(u.Z,{}):null!==(e=this.state.integrationConfigs)&&void 0!==e&&e.length?this.renderModal({integrationConfigs:this.state.integrationConfigs,initiallyLoaded:!this.state.loading}):this.state.selectedOrganization?(0,w.tZ)(j.Z,{orgId:this.state.selectedOrganization,allProjects:!(null!=t&&t.length),slugs:t,children:({projects:e,initiallyLoaded:t})=>this.renderModal({projects:e,initiallyLoaded:t})}):this.renderModal({})}}y.displayName="ContextPickerModalContainer";const Z=y,P=(0,r.Z)(l.Z,{target:"exrcese2"})("margin-top:",(0,f.Z)(1),";"),z=(0,r.Z)(u.Z,{target:"exrcese1"})({name:"1739oy8",styles:"z-index:1"}),C=(0,r.Z)("div",{target:"exrcese0"})("display:grid;grid-template-columns:",(0,f.Z)(4)," auto;grid-template-rows:1fr;")},"./app/stores/latestContextStore.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var o=s("../node_modules/reflux/src/index.js"),r=s.n(o),i=s("./app/actions/organizationActions.tsx"),n=s("./app/actions/organizationsActions.tsx"),a=s("./app/actions/projectActions.tsx");const c={state:{project:null,lastProject:null,organization:null,environment:null},get(){return this.state},init(){this.reset(),this.listenTo(a.Z.setActive,this.onSetActiveProject),this.listenTo(a.Z.updateSuccess,this.onUpdateProject),this.listenTo(n.Z.setActive,this.onSetActiveOrganization),this.listenTo(n.Z.update,this.onUpdateOrganization),this.listenTo(i.Z.update,this.onUpdateOrganization)},reset(){return this.state={project:null,lastProject:null,organization:null,environment:null},this.state},onUpdateOrganization(e){this.state.organization&&e&&e.slug===this.state.organization.slug&&(this.state={...this.state,organization:e},this.trigger(this.state))},onSetActiveOrganization(e){e?this.state.organization&&this.state.organization.slug===e.slug||(this.state={...this.state,organization:e,project:null}):this.state={...this.state,organization:null,project:null},this.trigger(this.state)},onSetActiveProject(e){e?this.state.project&&this.state.project.slug===e.slug||(this.state={...this.state,lastProject:this.state.project,project:e}):this.state={...this.state,lastProject:this.state.project,project:null},this.trigger(this.state)},onUpdateProject(e){this.state={...this.state,project:e},this.trigger(this.state)}},l=r().createStore(c)},"./app/stores/organizationStore.tsx":(e,t,s)=>{s.d(t,{Z:()=>c}),s("../node_modules/core-js/modules/es.string.replace.js");var o=s("../node_modules/reflux/src/index.js"),r=s.n(o),i=s("./app/actions/organizationActions.tsx"),n=s("./app/constants/index.tsx");const a={init(){this.reset(),this.listenTo(i.Z.update,this.onUpdate),this.listenTo(i.Z.reset,this.reset),this.listenTo(i.Z.fetchOrgError,this.onFetchOrgError)},reset(){this.loading=!0,this.error=null,this.errorType=null,this.organization=null,this.dirty=!1,this.trigger(this.get())},onUpdate(e,{replace:t=!1}={}){this.loading=!1,this.error=null,this.errorType=null,this.organization=t?e:{...this.organization,...e},this.dirty=!1,this.trigger(this.get())},onFetchOrgError(e){switch(this.organization=null,this.errorType=null,null==e?void 0:e.status){case 401:this.errorType=n.Yc.ORG_NO_ACCESS;break;case 404:this.errorType=n.Yc.ORG_NOT_FOUND}this.loading=!1,this.error=e,this.dirty=!1,this.trigger(this.get())},get(){return{organization:this.organization,error:this.error,loading:this.loading,errorType:this.errorType,dirty:this.dirty}},getState(){return this.get()}},c=r().createStore(a)},"./app/stores/organizationsStore.tsx":(e,t,s)=>{s.d(t,{Z:()=>n}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=s("../node_modules/reflux/src/index.js"),r=s.n(o);const i={listenables:[s("./app/actions/organizationsActions.tsx").Z],state:[],loaded:!1,getInitialState(){return this.state},init(){this.state=[],this.loaded=!1},onUpdate(e){this.add(e)},onChangeSlug(e,t){e.slug!==t.slug&&(this.remove(e.slug),this.add(t))},onRemoveSuccess(e){this.remove(e)},get(e){return this.state.find((t=>t.slug===e))},getAll(){return this.state},remove(e){this.state=this.state.filter((t=>e!==t.slug)),this.trigger(this.state)},add(e){let t=!1;this.state.forEach(((s,o)=>{s.id===e.id&&(e={...s,...e},this.state[o]=e,t=!0)})),t||(this.state=[...this.state,e]),this.trigger(this.state)},load(e){this.state=e,this.loaded=!0,this.trigger(e)}},n=r().createStore(i)},"./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx":(e,t,s)=>{s.d(t,{Z:()=>o});const o=(0,s("./app/utils/analytics/makeAnalyticsFunction.tsx").Z)({"growth.show_mobile_prompt_banner":"Growth: Show Mobile Prompt Banner","growth.dismissed_mobile_prompt_banner":"Growth: Dismissed Mobile Prompt Banner","growth.opened_mobile_project_suggest_modal":"Growth: Open Mobile Project Suggest Modal","growth.clicked_mobile_prompt_setup_project":"Growth: Clicked Mobile Prompt Setup Project","growth.clicked_mobile_prompt_ask_teammate":"Growth: Clicked Mobile Prompt Ask Teammate","growth.submitted_mobile_prompt_ask_teammate":"Growth: Submitted Mobile Prompt Ask Teammate","growth.demo_click_get_started":"Growth: Demo Click Get Started","growth.demo_click_docs":"Growth: Demo Click Docs","growth.demo_click_request_demo":"Growth: Demo Click Request Demo","growth.onboarding_load_choose_platform":"Growth: Onboarding Load Choose Platform Page","growth.onboarding_set_up_your_project":"Growth: Onboarding Click Set Up Your Project","growth.select_platform":"Growth: Onboarding Choose Platform","growth.platformpicker_category":"Growth: Onboarding Platform Category","growth.platformpicker_search":"Growth: Onboarding Platform Search","growth.onboarding_start_onboarding":"Growth: Onboarding Start Onboarding","growth.onboarding_take_to_error":"Growth: Onboarding Take to Error","growth.onboarding_view_full_docs":"Growth: Onboarding View Full Docs","growth.onboarding_view_sample_event":"Growth: Onboarding View Sample Event","invite_request.approved":"Invite Request Approved","invite_request.denied":"Invite Request Denied","growth.demo_modal_clicked_signup":"Growth: Demo Modal Clicked Signup","growth.demo_modal_clicked_continue":"Growth: Demo Modal Clicked Continue","growth.clicked_enter_sandbox":"Growth: Clicked Enter Sandbox","growth.sample_transaction_docs_link_clicked":"Growth: Sample Transaction Docs Link Clicked","growth.sample_error_onboarding_link_clicked":"Growth: Sample Error Onboarding Link Clicked","growth.issue_open_in_discover_btn_clicked":"Growth: Open in Discover Button in Issue Details clicked","member_settings_page.loaded":"Member Settings Page Loaded","invite_modal.opened":"Invite Modal: Opened","invite_modal.closed":"Invite Modal: Closed","invite_modal.add_more":"Invite Modal: Add More","invite_modal.invites_sent":"Invite Modal: Invites Sent","invite_modal.requests_sent":"Invite Modal: Requests Sent","sdk_updates.seen":"SDK Updates: Seen","sdk_updates.snoozed":"SDK Updates: Snoozed","sdk_updates.clicked":"SDK Updates: Clicked","event_cause.viewed":null,"event_cause.docs_clicked":"Event Cause Docs Clicked","event_cause.snoozed":"Event Cause Snoozed","event_cause.dismissed":"Event Cause Dismissed","issue_error_banner.viewed":"Issue Error Banner Viewed","issues_tab.viewed":"Viewed Issues Tab","issue_search.failed":"Issue Search: Failed","issue.search_sidebar_clicked":"Issue Search Sidebar Clicked","inbox_tab.issue_clicked":"Clicked Issue from Inbox Tab","issues_stream.issue_clicked":"Clicked Issue from Issues Stream","issues_stream.issue_assigned":"Assigned Issue from Issues Stream","issue.shared_publicly":"Issue Shared Publicly",resolve_issue:"Resolve Issue","tag.clicked":"Tag: Clicked","performance_views.create_sample_transaction":"Growth: Performance Sample Transaction","performance_views.tour.start":"Performance Views: Tour Start","performance_views.tour.advance":"Performance Views: Tour Advance","performance_views.tour.close":"Performance Views: Tour Close","performance_views.landingv2.transactions.sort":"Performance Views: Landing Transactions Sorted","performance_views.overview.navigate.summary":"Performance Views: Overview view summary","performance_views.overview.cellaction":"Performance Views: Cell Action Clicked","performance_views.landingv3.widget.interaction":"Performance Views: Landing Widget Interaction","performance_views.landingv3.widget.switch":"Performance Views: Landing Widget Switched","performance_views.landingv3.batch_queries":"Performance Views: Landing Query Batching","performance_views.landingv3.display_change":"Performance Views: Switch Landing Tabs","performance_views.spans.change_op":"Performance Views: Change span operation name","performance_views.spans.change_sort":"Performance Views: Change span sort column","dashboards_views.add_widget_modal.opened":"Dashboards2: Add Widget Modal opened","dashboards_views.add_widget_modal.change":"Dashboards2: Field changed in Add Widget Modal","dashboards_views.edit_widget_modal.opened":"Dashboards2: Edit Widget Modal Opened","dashboards_views.query_selector.opened":"Dashboards2: Query Selector opened for Widget","dashboards_views.query_selector.selected":"Dashboards2: Query selected in Query Selector","dashboards_views.open_in_discover.opened":"Dashboards2: Widget Opened In Discover","dashboards_views.add_widget_modal.confirm":"Dashboards2: Add Widget to Dashboard modal form submitted","dashboards_views.edit_widget_modal.confirm":"Dashboards2: Edit Dashboard Widget modal form submitted","dashboards_views.widget_library.add":"Dashboards2: Number of prebuilt widgets added","dashboards_views.widget_library.add_widget":"Dashboards2: Title of prebuilt widget added","dashboards_views.widget_library.switch_tab":"Dashboards2: Widget Library tab switched","dashboards_views.widget_library.opened":"Dashboards2: Add Widget Library opened","dashboards_manage.search":"Dashboards Manager: Search","dashboards_manage.change_sort":"Dashboards Manager: Sort By Changed","dashboards_manage.create.start":"Dashboards Manager: Dashboard Create Started","dashboards_manage.templates.toggle":"Dashboards Manager: Template Toggle Changed","dashboards_manage.templates.add":"Dashboards Manager: Template Added","dashboards_manage.templates.preview":"Dashboards Manager: Template Previewed","discover_views.add_to_dashboard.modal_open":"Discover2: Add to Dashboard modal opened","discover_views.add_to_dashboard.confirm":"Discover2: Add to Dashboard modal form submitted","team_insights.viewed":"Team Insights: Viewed","search.searched":"Search: Performed search","search.operator_autocompleted":"Search: Operator Autocompleted","organization_saved_search.selected":"Organization Saved Search: Selected saved search","settings_search.open":"settings_search Open","command_palette.open":"command_palette Open","sidebar_help.open":"sidebar_help Open","settings_search.select":"settings_search Select","command_palette.select":"command_palette Select","sidebar_help.select":"sidebar_help Select","settings_search.query":"settings_search Query","command_palette.query":"command_palette Query","sidebar_help.query":"sidebar_help Query"})},"./app/utils/parseLinkHeader.tsx":(e,t,s)=>{function o(e){if(null===e||""===e)return{};const t=e.split(","),s={};return t.forEach((e=>{const t=/<([^>]+)>; rel="([^"]+)"(?:; results="([^"]+)")?(?:; cursor="([^"]+)")?/g.exec(e),o="true"===t[3]||"false"!==t[3]&&null;s[t[2]]={href:t[1],results:o,cursor:t[4]}})),s}s.d(t,{Z:()=>o})},"./app/utils/projects.tsx":(e,t,s)=>{s.d(t,{Z:()=>j});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),i=s("../node_modules/lodash/memoize.js"),n=s.n(i),a=s("../node_modules/lodash/partition.js"),c=s.n(a),l=s("../node_modules/lodash/uniqBy.js"),d=s.n(l),p=s("./app/actions/projectActions.tsx"),u=s("./app/stores/projectsStore.tsx"),h=s("./app/utils.tsx"),g=s("./app/utils/parseLinkHeader.tsx"),m=s("./app/utils/withApi.tsx"),_=s("./app/utils/withProjects.tsx");class f extends r.Component{constructor(...e){super(...e),(0,o.Z)(this,"state",{fetchedProjects:[],projectsFromStore:[],initiallyLoaded:!1,fetching:!1,isIncomplete:null,hasMore:null,prevSearch:null,nextCursor:null,fetchError:null}),(0,o.Z)(this,"fetchQueue",new Set),(0,o.Z)(this,"getProjectsMap",n()((e=>new Map(e.map((e=>[e.slug,e])))))),(0,o.Z)(this,"loadSpecificProjects",(()=>{const{slugs:e,projects:t}=this.props,s=this.getProjectsMap(t),[o,r]=c()(e,(e=>s.has(e))),i=o.map((e=>s.get(e))).filter(h.ri);r.forEach((e=>this.fetchQueue.add(e))),this.setState({fetchedProjects:r.map((e=>({slug:e}))),initiallyLoaded:!!o.length,projectsFromStore:i}),r.length&&this.fetchSpecificProjects()})),(0,o.Z)(this,"fetchSpecificProjects",(async()=>{const{api:e,orgId:t,passthroughPlaceholderProject:s}=this.props;if(!this.fetchQueue.size)return;this.setState({fetching:!0});let o=[],r=null;try{const{results:s}=await v(e,t,{slugs:Array.from(this.fetchQueue)});o=s}catch(e){console.error(e),r=e}const i=this.getProjectsMap(o),n=Array.from(this.fetchQueue).map((e=>i.has(e)?i.get(e):s?{slug:e}:null)).filter(h.ri);this.setState({fetchedProjects:n,isIncomplete:this.fetchQueue.size!==o.length,initiallyLoaded:!0,fetching:!1,fetchError:r}),this.fetchQueue.clear()})),(0,o.Z)(this,"loadAllProjects",(async()=>{const{api:e,orgId:t,limit:s,allProjects:o}=this.props;this.setState({fetching:!0});try{const{results:r,hasMore:i,nextCursor:n}=await v(e,t,{limit:s,allProjects:o});this.setState({fetching:!1,fetchedProjects:r,initiallyLoaded:!0,hasMore:i,nextCursor:n})}catch(e){console.error(e),this.setState({fetching:!1,fetchedProjects:[],initiallyLoaded:!0,fetchError:e})}})),(0,o.Z)(this,"handleSearch",(async(e,{append:t}={})=>{const{api:s,orgId:o,limit:r}=this.props,{prevSearch:i}=this.state,n=this.state.nextCursor;this.setState({fetching:!0});try{const{results:a,hasMore:c,nextCursor:l}=await v(s,o,{search:e,limit:r,prevSearch:i,cursor:n});this.setState((s=>{let o;return o=t?d()([...s.fetchedProjects,...a],(({slug:e})=>e)):a,{fetchedProjects:o,hasMore:c,fetching:!1,prevSearch:e,nextCursor:l}}))}catch(e){console.error(e),this.setState({fetching:!1,fetchError:e})}}))}componentDidMount(){const{slugs:e}=this.props;null!=e&&e.length?this.loadSpecificProjects():this.loadAllProjects()}componentDidUpdate(e){const{projects:t}=this.props;t!==e.projects&&this.updateProjectsFromStore()}updateProjectsFromStore(){const{allProjects:e,projects:t,slugs:s}=this.props;if(e)this.setState({fetchedProjects:t});else if(null!=s&&s.length){const e=this.getProjectsMap(t),o=s.map((t=>e.get(t))).filter(h.ri);this.setState({projectsFromStore:o})}}render(){const{slugs:e,children:t}=this.props;return t({projects:this.state.initiallyLoaded?[...this.state.fetchedProjects,...this.state.projectsFromStore]:e&&e.map((e=>({slug:e})))||[],isIncomplete:this.state.isIncomplete,fetching:this.state.fetching,hasMore:this.state.hasMore,onSearch:this.handleSearch,initiallyLoaded:this.state.initiallyLoaded,fetchError:this.state.fetchError})}}f.displayName="Projects",(0,o.Z)(f,"defaultProps",{passthroughPlaceholderProject:!0});const j=(0,_.Z)((0,m.Z)(f));async function v(e,t,{slugs:s,search:o,limit:r,prevSearch:i,cursor:n,allProjects:a}={}){const c={collapse:["latestDeploys"]};if(s&&s.length&&(c.query=s.map((e=>"slug:".concat(e))).join(" ")),o&&(c.query="".concat(c.query?"".concat(c.query," "):"").concat(o)),(i||o)&&i!==o||!n||(c.cursor=n),r&&(c.per_page=r),a){const e=u.Z.getAll();if(!u.Z.isLoading())return{results:e,hasMore:!1};c.all_projects=1}let l=!1,d=null;const[h,,m]=await e.requestPromise("/organizations/".concat(t,"/projects/"),{includeAllArgs:!0,query:c}),_=null==m?void 0:m.getResponseHeader("Link");if(_){const e=(0,g.Z)(_);l=e&&(e.next.results||e.previous.results),d=e.next.cursor}return a&&p.Z.loadProjects(h),{results:h,hasMore:l,nextCursor:d}}},"./app/utils/replaceRouterParams.tsx":(e,t,s)=>{function o(e,t){const s=e.match(/:\w+/g);return s&&s.length?(s.forEach((s=>{const o=s.slice(1);void 0!==t[o]&&(e=e.replace(s,t[o]))})),e):e}s.d(t,{Z:()=>o}),s("../node_modules/core-js/modules/es.string.replace.js")},"./app/utils/useApi.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var o=s("../node_modules/react/index.js"),r=s("./app/api.tsx");const i=function({persistInFlight:e,api:t}={}){const s=(0,o.useRef)();void 0===s.current&&void 0===t&&(s.current=new r.KU);const i=null!=t?t:s.current;function n(){!e&&i.clear()}return(0,o.useEffect)((()=>n),[]),i}},"./app/utils/useProjects.tsx":(e,t,s)=>{s.d(t,{Z:()=>h}),s("../node_modules/core-js/modules/es.string.trim.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=s("../node_modules/react/index.js"),r=s("../node_modules/lodash/uniqBy.js"),i=s.n(r),n=s("./app/actions/projectActions.tsx"),a=s("./app/stores/organizationStore.tsx"),c=s("./app/stores/projectsStore.tsx"),l=s("./app/stores/useLegacyStore.tsx"),d=s("./app/utils/parseLinkHeader.tsx"),p=s("./app/utils/useApi.tsx");async function u(e,t,{slugs:s,search:o,limit:r,lastSearch:i,cursor:n}={}){const a={collapse:["latestDeploys"]};var c;void 0!==s&&s.length>0&&(a.query=s.map((e=>"slug:".concat(e))).join(" ")),o&&(a.query="".concat(null!==(c=a.query)&&void 0!==c?c:"").concat(o).trim()),(!i&&!o||i===o)&&n&&(a.cursor=n),void 0!==r&&(a.per_page=r);let l=!1,p=null;const[u,,h]=await e.requestPromise("/organizations/".concat(t,"/projects/"),{includeAllArgs:!0,query:a}),g=null==h?void 0:h.getResponseHeader("Link");if(g){var m,_,f;const e=(0,d.Z)(g);l=(null==e||null===(m=e.next)||void 0===m?void 0:m.results)||(null==e||null===(_=e.previous)||void 0===_?void 0:_.results),p=null==e||null===(f=e.next)||void 0===f?void 0:f.cursor}return{results:u,hasMore:l,nextCursor:p}}const h=function({limit:e,slugs:t,orgId:s}={}){var r;const d=(0,p.Z)(),{organization:h}=(0,l.X)(a.Z),g=(0,l.X)(c.Z),m=null!=s?s:null==h?void 0:h.slug,_=new Set(g.projects.map((e=>e.slug))),f=null!==(r=null==t?void 0:t.filter((e=>!_.has(e))))&&void 0!==r?r:[],j=f.length>0,[v,S]=(0,o.useState)({initiallyLoaded:!g.loading&&!j,fetching:j,hasMore:null,lastSearch:null,nextCursor:null,fetchError:null}),w=(0,o.useRef)(null);void 0!==t&&(null===w.current&&(w.current=new Set(t)),(t.length!==w.current.size||t.some((e=>{var t;return!(null!==(t=w.current)&&void 0!==t&&t.has(e))})))&&(w.current=new Set(t))),(0,o.useEffect)((()=>{j&&async function(){if(void 0!==m){S({...v,fetching:!0});try{const{results:t,hasMore:s,nextCursor:o}=await u(d,m,{slugs:f,limit:e}),r=i()([...g.projects,...t],(({slug:e})=>e));n.Z.loadProjects(r),S({...v,hasMore:s,fetching:!1,initiallyLoaded:!g.loading,nextCursor:o})}catch(e){console.error(e),S({...v,fetching:!1,initiallyLoaded:!g.loading,fetchError:e})}}else console.error("Cannot use useProjects({slugs}) without an organization in context")}()}),[w.current]),(0,o.useEffect)((()=>{const e=!g.loading;v.initiallyLoaded!==e&&(j||S({...v,initiallyLoaded:e}))}),[g.loading]);const{initiallyLoaded:b,fetching:x,fetchError:y,hasMore:Z}=v;return{projects:t?g.projects.filter((e=>t.includes(e.slug))):g.projects,placeholders:f.map((e=>({slug:e}))),fetching:x||g.loading,initiallyLoaded:b,fetchError:y,hasMore:Z,onSearch:async function(t){const{lastSearch:s}=v,o=v.nextCursor;if(""!==t)if(void 0!==m){S({...v,fetching:!0});try{d.clear();const{results:r,hasMore:a,nextCursor:c}=await u(d,m,{search:t,limit:e,lastSearch:s,cursor:o}),l=i()([...g.projects,...r],(({slug:e})=>e));l.length>g.projects.length&&n.Z.loadProjects(l),S({...v,hasMore:a,fetching:!1,lastSearch:t,nextCursor:c})}catch(e){console.error(e),S({...v,fetching:!1,fetchError:e})}}else console.error("Cannot use useProjects.onSearch without an organization in context")}}}},"./app/utils/withApi.tsx":(e,t,s)=>{s.d(t,{Z:()=>n});var o=s("./app/utils/getDisplayName.tsx"),r=s("./app/utils/useApi.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const n=(e,t={})=>{const s=({api:s,...o})=>{const n=(0,r.Z)({api:s,...t});return(0,i.tZ)(e,{...o,api:n})};return s.displayName="withApi(".concat((0,o.Z)(e),")"),s}},"./app/utils/withConfig.tsx":(e,t,s)=>{s.d(t,{Z:()=>a}),s("../node_modules/react/index.js");var o=s("./app/stores/configStore.tsx"),r=s("./app/stores/useLegacyStore.tsx"),i=s("./app/utils/getDisplayName.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=function(e){const t=t=>{const s={config:(0,r.X)(o.Z),...t};return(0,n.tZ)(e,{...s})};return t.displayName="withConfig(".concat((0,i.Z)(e),")"),t}},"./app/utils/withOrganizations.tsx":(e,t,s)=>{s.d(t,{Z:()=>c});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),i=s("./app/stores/organizationsStore.tsx"),n=s("./app/utils/getDisplayName.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const c=function(e){class t extends r.Component{constructor(...e){super(...e),(0,o.Z)(this,"state",{organizations:i.Z.getAll()}),(0,o.Z)(this,"unsubscribe",i.Z.listen((e=>this.setState({organizations:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{organizationsLoading:t,organizations:s,...o}=this.props;return(0,a.tZ)(e,{organizationsLoading:null!=t?t:!i.Z.loaded,organizations:null!=s?s:this.state.organizations,...o})}}return t.displayName="WithOrganizations",(0,o.Z)(t,"displayName","withOrganizations(".concat((0,n.Z)(e),")")),t}},"./app/utils/withProjects.tsx":(e,t,s)=>{s.d(t,{Z:()=>n}),s("../node_modules/react/index.js");var o=s("./app/utils/getDisplayName.tsx"),r=s("./app/utils/useProjects.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const n=function(e){const t=t=>{const{projects:s,initiallyLoaded:o}=(0,r.Z)(),n=!o;return(0,i.tZ)(e,{...t,projects:s,loadingProjects:n})};return t.displayName="withProjects(".concat((0,o.Z)(e),")"),t}},"./app/views/organizationIntegrations/integrationIcon.tsx":(e,t,s)=>{s.d(t,{Z:()=>d});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),n=s("./app/plugins/components/pluginIcon.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const c=(0,r.Z)("img",{target:"e11cnql20"})("height:",(e=>e.size),"px;width:",(e=>e.size),"px;border-radius:2px;display:block;");class l extends i.Component{constructor(...e){super(...e),(0,o.Z)(this,"state",{imgSrc:this.props.integration.icon})}render(){const{integration:e,size:t}=this.props;return(0,a.tZ)(c,{size:t,src:this.state.imgSrc,onError:()=>{this.setState({imgSrc:n.kg[e.provider.key]||n.jp})}})}}l.displayName="Icon";const d=({integration:e,size:t=32})=>e.icon?(0,a.tZ)(l,{size:t,integration:e}):(0,a.tZ)(n.ZP,{size:t,pluginId:e.provider.key})}}]);
//# sourceMappingURL=../sourcemaps/app_actionCreators_navigation_tsx-app_actions_teamActions_tsx-app_stores_latestContextStore_t-3fc2cc.fc2c3e5062db0f55f4bb58326d943b55.js.map