"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_account_accountEmails_tsx"],{"./app/views/settings/account/accountEmails.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>S,EmailAddresses:()=>C});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("./app/actionCreators/indicator.tsx"),l=s("./app/components/alertLink.tsx"),r=s("./app/components/asyncComponent.tsx"),d=s("./app/components/button.tsx"),m=s("./app/components/buttonBar.tsx"),c=s("./app/components/loadingIndicator.tsx"),p=s("./app/components/panels/index.tsx"),h=s("./app/components/tag.tsx"),u=s("./app/data/forms/accountEmails.tsx"),Z=s("./app/icons/index.tsx"),y=s("./app/locale.tsx"),g=s("./app/styles/space.tsx"),v=s("./app/views/asyncView.tsx"),f=s("./app/views/settings/components/forms/form.tsx"),x=s("./app/views/settings/components/forms/jsonForm.tsx"),b=s("./app/views/settings/components/settingsPageHeader.tsx"),w=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const P="/users/me/emails/";class E extends("app"==s.j?v.Z:null){constructor(...e){super(...e),(0,n.Z)(this,"handleSubmitSuccess",((e,t,s)=>{void 0!==s&&(t.setValue(s,""),this.remountComponent())}))}getTitle(){return(0,y.t)("Emails")}getEndpoints(){return[]}renderBody(){return(0,w.BX)(o.Fragment,{children:[(0,w.tZ)(b.Z,{title:(0,y.t)("Email Addresses")}),(0,w.tZ)(C,{}),(0,w.tZ)(f.Z,{apiMethod:"POST",apiEndpoint:P,saveOnBlur:!0,allowUndo:!1,onSubmitSuccess:this.handleSubmitSuccess,children:(0,w.tZ)(x.Z,{forms:u.default})}),(0,w.tZ)(l.Z,{to:"/settings/account/notifications",icon:(0,w.tZ)(Z.bv,{}),children:(0,y.t)("Want to change how many emails you get? Use the notifications panel.")})]})}}const S="app"==s.j?E:null;class C extends r.Z{constructor(...e){super(...e),(0,n.Z)(this,"handleSetPrimary",(e=>this.doApiCall(P,{method:"PUT",data:{email:e}}))),(0,n.Z)(this,"handleRemove",(e=>this.doApiCall(P,{method:"DELETE",data:{email:e}}))),(0,n.Z)(this,"handleVerify",(e=>this.doApiCall("".concat(P,"confirm/"),{method:"POST",data:{email:e}})))}getEndpoints(){return[["emails",P]]}doApiCall(e,t){this.setState({loading:!0,emails:[]},(()=>this.api.requestPromise(e,t).then((()=>this.remountComponent())).catch((e=>{var t;this.remountComponent(),null!=e&&null!==(t=e.responseJSON)&&void 0!==t&&t.email&&(0,a.Iw)(e.responseJSON.email)}))))}render(){const{emails:e,loading:t}=this.state,s=null==e?void 0:e.find((({isPrimary:e})=>e)),n=null==e?void 0:e.filter((({isPrimary:e})=>!e));return t?(0,w.BX)(p.s_,{children:[(0,w.tZ)(p.V9,{children:(0,y.t)("Email Addresses")}),(0,w.tZ)(p.N,{children:(0,w.tZ)(c.Z,{})})]}):(0,w.BX)(p.s_,{children:[(0,w.tZ)(p.V9,{children:(0,y.t)("Email Addresses")}),(0,w.BX)(p.N,{children:[s&&(0,w.tZ)(j,{onRemove:this.handleRemove,onVerify:this.handleVerify,...s}),null==n?void 0:n.map((e=>(0,w.tZ)(j,{onSetPrimary:this.handleSetPrimary,onRemove:this.handleRemove,onVerify:this.handleVerify,...e},e.email)))]})]})}}C.displayName="EmailAddresses";const j=({email:e,onRemove:t,onVerify:s,onSetPrimary:n,isVerified:i,isPrimary:o,hideRemove:a})=>(0,w.BX)(V,{children:[(0,w.BX)(_,{children:[e,!i&&(0,w.tZ)(h.Z,{type:"warning",children:(0,y.t)("Unverified")}),o&&(0,w.tZ)(h.Z,{type:"success",children:(0,y.t)("Primary")})]}),(0,w.BX)(m.ZP,{gap:1,children:[!o&&i&&(0,w.tZ)(d.ZP,{size:"small",onClick:t=>null==n?void 0:n(e,t),children:(0,y.t)("Set as primary")}),!i&&(0,w.tZ)(d.ZP,{size:"small",onClick:t=>s(e,t),children:(0,y.t)("Resend verification")}),!a&&!o&&(0,w.tZ)(d.ZP,{label:(0,y.t)("Remove email"),"data-test-id":"remove",priority:"danger",size:"small",icon:(0,w.tZ)(Z.Fz,{}),onClick:s=>t(e,s)})]})]});j.displayName="EmailRow";const _=(0,i.Z)("div",{target:"etbgoaq1"})("display:grid;grid-auto-flow:column;gap:",(0,g.Z)(1),";align-items:center;"),V=(0,i.Z)(p.Lv,{target:"etbgoaq0"})({name:"2o6p8u",styles:"justify-content:space-between"})}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_account_accountEmails_tsx.ee22100e72002c5a9ce20eae8c1eac48.js.map