"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_components_avatar_actorAvatar_tsx-app_components_tag_tsx-app_components_textOverflow_tsx"],{"./app/actionCreators/teams.tsx":(e,t,s)=>{s.d(t,{PX:()=>c,z_:()=>d,fs:()=>u,um:()=>m,s:()=>p,Cm:()=>h,tT:()=>g}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=s("./app/actionCreators/indicator.tsx"),a=s("./app/actions/teamActions.tsx"),r=s("./app/locale.tsx"),n=s("./app/utils/callIfFunction.tsx");if("app"==s.j)var i=s("./app/utils/guid.tsx");const l=(e={},t,...s)=>{(0,n.g)(e[t],...s)};async function c(e,t){const s=await e.requestPromise("/organizations/".concat(t.orgId,"/user-teams/"));a.Z.loadUserTeams(s)}function d(e,t){a.Z.updateSuccess(e,t)}function u(e,t,s){const o="/teams/".concat(t.orgId,"/").concat(t.teamId,"/");return a.Z.update(t.teamId,t.data),e.request(o,{method:"PUT",data:t.data,success:e=>{d(t.teamId,e),l(s,"success",e)},error:e=>{a.Z.updateError(t.teamId,e),l(s,"error",e)}})}function m(e,t,s){var o;const r="/organizations/".concat(t.orgId,"/members/").concat(null!==(o=t.memberId)&&void 0!==o?o:"me","/teams/").concat(t.teamId,"/"),n=(0,i.E)();return a.Z.update(n,t.teamId),e.request(r,{method:"POST",success:e=>{a.Z.updateSuccess(t.teamId,e),l(s,"success",e)},error:e=>{a.Z.updateError(n,t.teamId,e),l(s,"error",e)}})}function p(e,t,s){const o="/organizations/".concat(t.orgId,"/members/").concat(t.memberId||"me","/teams/").concat(t.teamId,"/"),r=(0,i.E)();return a.Z.update(r,t.teamId),e.request(o,{method:"DELETE",success:e=>{a.Z.updateSuccess(t.teamId,e),l(s,"success",e)},error:e=>{a.Z.updateError(r,t.teamId,e),l(s,"error",e)}})}function h(e,t,s){return a.Z.createTeam(t),e.requestPromise("/organizations/".concat(s.orgId,"/teams/"),{method:"POST",data:t}).then((e=>(a.Z.createTeamSuccess(e),(0,o.S9)((0,r._N)("[team] has been added to the [organization] organization",{team:"#".concat(e.slug),organization:s.orgId})),e)),(e=>{throw a.Z.createTeamError(t.slug,e),(0,o.Iw)((0,r._N)("Unable to create [team] in the [organization] organization",{team:"#".concat(t.slug),organization:s.orgId})),e}))}function g(e,t){return a.Z.removeTeam(t.teamId),e.requestPromise("/teams/".concat(t.orgId,"/").concat(t.teamId,"/"),{method:"DELETE"}).then((e=>(a.Z.removeTeamSuccess(t.teamId,e),(0,o.S9)((0,r._N)("[team] has been removed from the [organization] organization",{team:"#".concat(t.teamId),organization:t.orgId})),e)),(e=>{throw a.Z.removeTeamError(t.teamId,e),(0,o.Iw)((0,r._N)("Unable to remove [team] from the [organization] organization",{team:"#".concat(t.teamId),organization:t.orgId})),e}))}},"./app/components/avatar/actorAvatar.tsx":(e,t,s)=>{s.d(t,{Z:()=>p});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=s("../node_modules/react/index.js"),r=s("../node_modules/@sentry/minimal/esm/index.js"),n=s("./app/components/avatar/teamAvatar.tsx"),i=s("./app/components/avatar/userAvatar.tsx"),l=s("./app/components/loadingIndicator.tsx"),c=s("./app/stores/memberListStore.tsx"),d=s("./app/utils/teams.tsx"),u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class m extends a.Component{render(){const{actor:e,...t}=this.props;if("user"===e.type){var s;const o=e.id&&null!==(s=c.Z.getById(e.id))&&void 0!==s?s:e;return(0,u.tZ)(i.Z,{user:o,...t})}return"team"===e.type?(0,u.tZ)(d.Z,{ids:[e.id],children:({initiallyLoaded:e,teams:s})=>e?(0,u.tZ)(n.Z,{team:s[0],...t}):(0,u.tZ)(l.Z,{mini:!0})}):(r.$e((t=>{t.setExtra("actor",e),r.Tb(new Error("Unknown avatar type"))})),null)}}m.displayName="ActorAvatar",(0,o.Z)(m,"defaultProps",{size:24,hasTooltip:!0});const p=m},"./app/components/tag.tsx":(e,t,s)=>{s.d(t,{A:()=>Z,Z:()=>j});var o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=s("../node_modules/react/index.js"),r=s("./app/components/button.tsx"),n=s("./app/components/links/externalLink.tsx"),i=s("./app/components/links/link.tsx"),l=s("./app/components/tooltip.tsx"),c=s("./app/icons/index.tsx"),d=s("./app/locale.tsx"),u=s("./app/styles/space.tsx"),m=s("./app/utils.tsx"),p=s("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),h=s("./app/utils/theme.tsx"),g=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const x="20px";function f({type:e="default",icon:t,tooltipText:s,to:o,onClick:r,href:u,onDismiss:x,children:f,textMaxWidth:j=150,...I}){const _={size:"11px",color:h.ZP.tag[e].iconColor},S=(0,g.tZ)(l.Z,{title:s,containerDisplayMode:"inline-flex",children:(0,g.BX)(Z,{type:e,children:[a.isValidElement(t)?(0,g.tZ)(y,{children:a.cloneElement(t,{..._})}):((0,m.ri)(u)||(0,m.ri)(o))&&void 0===t?(0,g.tZ)(y,{children:(0,g.tZ)(c.V$,{..._})}):null,(0,g.tZ)(w,{type:e,maxWidth:j,children:f}),(0,m.ri)(x)&&(0,g.tZ)(b,{onClick:function(e){e.preventDefault(),null==x||x()},size:"zero",priority:"link",label:(0,d.t)("Dismiss"),children:(0,g.tZ)(c.bM,{isCircled:!0,..._})})]})});return(0,g.tZ)(v,{...I,onClick:()=>{(0,p.Z)("tag.clicked",{is_clickable:(0,m.ri)(r)||(0,m.ri)(o)||(0,m.ri)(u),organization:null})},children:(0,m.ri)(u)?(0,g.tZ)(n.Z,{href:u,children:S}):(0,m.ri)(o)&&(0,m.ri)(r)?(0,g.tZ)(i.Z,{to:o,onClick:r,children:S}):(0,m.ri)(o)?(0,g.tZ)(i.Z,{to:o,children:S}):S})}f.displayName="Tag";const v=(0,o.Z)("span",{target:"e8jgvoh4"})("font-size:",(e=>e.theme.fontSizeSmall),";"),Z=(0,o.Z)("div",{target:"e8jgvoh3"})("display:inline-flex;align-items:center;height:",x,";border-radius:",x,";background-color:",(e=>e.theme.tag[e.type].background),";border:solid 1px ",(e=>e.theme.tag[e.type].border),";padding:0 ",(0,u.Z)(1),";"),y=(0,o.Z)("span",{target:"e8jgvoh2"})("margin-right:",(0,u.Z)(.5),";display:inline-flex;"),w=(0,o.Z)("span",{target:"e8jgvoh1"})("color:",(e=>["black","white"].includes(e.type)?e.theme.tag[e.type].iconColor:e.theme.textColor),";max-width:",(e=>e.maxWidth),"px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;line-height:",x,";"),b=(0,o.Z)(r.ZP,{target:"e8jgvoh0"})("margin-left:",(0,u.Z)(.5),";border:none;"),j=f},"./app/components/textOverflow.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(s("../node_modules/react/index.js"),s("./app/styles/overflowEllipsis.tsx")),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const n=(0,o.Z)((({isParagraph:e,className:t,children:s,"data-test-id":o})=>{const a=e?"p":"div";return(0,r.tZ)(a,{className:t,"data-test-id":o,children:s})}),{target:"eyxbn6j0"})((e=>"right"===e.ellipsisDirection?a.Z:"\n  display: block;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  width: 100%;\n  direction: rtl;\n  text-align: left;\n"),";width:auto;line-height:1.2;");n.defaultProps={ellipsisDirection:"right",isParagraph:!1};const i=n},"./app/stores/memberListStore.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});var o=s("../node_modules/reflux/src/index.js");const a={loaded:!1,state:[],init(){this.state=[],this.loaded=!1},loadInitialData(e){this.state=e,this.loaded=!0,this.trigger(this.state,"initial")},isLoaded(){return this.loaded},getById(e){if(this.state){e=""+e;for(let t=0;t<this.state.length;t++)if(this.state[t].id===e)return this.state[t]}},getByEmail(e){if(this.state){e=e.toLowerCase();for(let t=0;t<this.state.length;t++)if(this.state[t].email.toLowerCase()===e)return this.state[t]}},getAll(){return this.state}},r=s.n(o)().createStore(a)},"./app/utils/isActiveSuperuser.tsx":(e,t,s)=>{s.d(t,{M:()=>n});var o=s("../node_modules/js-cookie/src/js.cookie.js"),a=s.n(o),r=s("./app/stores/configStore.tsx");function n(){const{isSuperuser:e}=r.Z.get("user")||{};return!(!e||(a().set("su","test"),void 0!==a().get("su")))}},"./app/utils/teams.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var o=s("../node_modules/react/index.js"),a=s("./app/utils/useTeams.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function n({children:e,...t}){const s=(0,a.Z)(t);return(0,r.tZ)(o.Fragment,{children:e(s)})}n.displayName="Teams";const i=n},"./app/utils/useTeams.tsx":(e,t,s)=>{s.d(t,{Z:()=>g}),s("../node_modules/core-js/modules/es.string.trim.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=s("../node_modules/react/index.js"),a=s("../node_modules/lodash/uniqBy.js"),r=s.n(a),n=s("./app/actionCreators/teams.tsx"),i=s("./app/actions/teamActions.tsx"),l=s("./app/stores/organizationStore.tsx"),c=s("./app/stores/teamStore.tsx"),d=s("./app/stores/useLegacyStore.tsx"),u=s("./app/utils/isActiveSuperuser.tsx"),m=s("./app/utils/parseLinkHeader.tsx"),p=s("./app/utils/useApi.tsx");async function h(e,t,{slugs:s,ids:o,search:a,limit:r,lastSearch:n,cursor:i}={}){const l={};var c;void 0!==s&&s.length>0&&(l.query=s.map((e=>"slug:".concat(e))).join(" ")),void 0!==o&&o.length>0&&(l.query=o.map((e=>"id:".concat(e))).join(" ")),a&&(l.query="".concat(null!==(c=l.query)&&void 0!==c?c:""," ").concat(a).trim()),(n===a||!n&&!a)&&i&&(l.cursor=i),void 0!==r&&(l.per_page=r);let d=!1,u=null;const[p,,h]=await e.requestPromise("/organizations/".concat(t,"/teams/"),{includeAllArgs:!0,query:l}),g=null==h?void 0:h.getResponseHeader("Link");if(g){var x,f;const e=(0,m.Z)(g);d=null==e||null===(x=e.next)||void 0===x?void 0:x.results,u=null==e||null===(f=e.next)||void 0===f?void 0:f.cursor}return{results:p,hasMore:d,nextCursor:u}}const g=function({limit:e,slugs:t,ids:s,provideUserTeams:a}={}){var m,g,x;const f=(0,p.Z)(),{organization:v}=(0,d.X)(l.Z),Z=(0,d.X)(c.Z),y=null==v?void 0:v.slug,w=new Set(Z.teams.map((e=>e.slug))),b=null!==(m=null==t?void 0:t.filter((e=>!w.has(e))))&&void 0!==m?m:[],j=new Set(Z.teams.map((e=>e.id))),I=null!==(g=null==s?void 0:s.filter((e=>!j.has(e))))&&void 0!==g?g:[],_=b.length>0,S=I.length>0,z=a&&!Z.loadedUserTeams,C=!_&&!z&&!S,[E,k]=(0,o.useState)({initiallyLoaded:C,fetching:!1,hasMore:Z.hasMore,lastSearch:null,nextCursor:Z.cursor,fetchError:null}),T=(0,o.useRef)(null);if(void 0!==t||void 0!==s){var M;const e=null!==(M=t||s)&&void 0!==M?M:[];null===T.current&&(T.current=new Set(e)),(e.length!==T.current.size||e.some((e=>{var t;return!(null!==(t=T.current)&&void 0!==t&&t.has(e))})))&&(T.current=new Set(e))}async function L(t){const{lastSearch:s}=E,o=t?E.nextCursor:Z.cursor;if(void 0!==y){k({...E,fetching:!0});try{f.clear();const{results:a,hasMore:n,nextCursor:l}=await h(f,y,{search:t,limit:e,lastSearch:s,cursor:o}),c=r()([...Z.teams,...a],(({slug:e})=>e));t?c.length>Z.teams.length&&i.Z.loadTeams(c):i.Z.loadTeams(c,n,l),k({...E,hasMore:n&&Z.hasMore,fetching:!1,lastSearch:null!=t?t:null,nextCursor:l})}catch(e){console.error(e),k({...E,fetching:!1,fetchError:e})}}else console.error("Cannot fetch teams without an organization in context")}(0,o.useEffect)((()=>{_||S?async function(){if(void 0!==y){k({...E,fetching:!0});try{const{results:t,hasMore:s,nextCursor:o}=await h(f,y,{slugs:b,ids:I,limit:e}),a=r()([...Z.teams,...t],(({slug:e})=>e));i.Z.loadTeams(a),k({...E,hasMore:s,fetching:!1,initiallyLoaded:!0,nextCursor:o})}catch(e){console.error(e),k({...E,fetching:!1,initiallyLoaded:!0,fetchError:e})}}}():z&&async function(){if(void 0!==y){k({...E,fetching:!0});try{await(0,n.PX)(f,{orgId:y}),k({...E,fetching:!1,initiallyLoaded:!0})}catch(e){console.error(e),k({...E,fetching:!1,initiallyLoaded:!0,fetchError:e})}}}()}),[T.current,a]);const A=(0,u.M)();return{teams:t?Z.teams.filter((e=>t.includes(e.slug))):s?Z.teams.filter((e=>s.includes(e.id))):a&&!A?Z.teams.filter((e=>e.isMember)):Z.teams,fetching:E.fetching||Z.loading,initiallyLoaded:E.initiallyLoaded,fetchError:E.fetchError,hasMore:null!==(x=E.hasMore)&&void 0!==x?x:Z.hasMore,onSearch:async function(e){""!==e?L(e):E.hasMore===Z.hasMore&&E.nextCursor===Z.cursor||k({...E,lastSearch:e,hasMore:Z.hasMore,nextCursor:Z.cursor})},loadMore:L}}}}]);
//# sourceMappingURL=../sourcemaps/app_components_avatar_actorAvatar_tsx-app_components_tag_tsx-app_components_textOverflow_tsx.4e4d409cf02bdc4fa3d5827d79bc37a3.js.map