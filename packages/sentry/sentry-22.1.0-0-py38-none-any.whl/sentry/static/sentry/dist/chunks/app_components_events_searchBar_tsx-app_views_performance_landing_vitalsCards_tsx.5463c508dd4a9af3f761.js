"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_components_events_searchBar_tsx-app_views_performance_landing_vitalsCards_tsx"],{"./app/components/events/searchBar.tsx":(e,t,s)=>{s.d(t,{Z:()=>O});var n,i=s("../node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js"),o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.string.replace.js"),s("../node_modules/core-js/modules/es.object.from-entries.js"),s("../node_modules/react/index.js")),r=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),l=s("../node_modules/lodash/assign.js"),d=s.n(l),c=s("../node_modules/lodash/flatten.js"),u=s.n(c),p=s("../node_modules/lodash/isEqual.js"),m=s.n(p),h=s("../node_modules/lodash/memoize.js"),v=s.n(h),g=s("../node_modules/lodash/omit.js"),f=s.n(g),Z=s("./app/actionCreators/tags.tsx"),x=s("./app/components/smartSearchBar/index.tsx"),y=s("./app/constants/index.tsx"),j=s("./app/types/index.tsx"),b=s("./app/utils.tsx"),w=s("./app/utils/discover/fields.tsx"),_=s("./app/utils/measurements/measurements.tsx"),k=s("./app/utils/withApi.tsx"),S=s("./app/utils/withTags.tsx"),N=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const P=new RegExp("^".concat(y.c$,"|\\").concat(y.ir),"g");class C extends a.PureComponent{constructor(...e){super(...e),(0,o.Z)(this,"getEventFieldValues",v()(((e,t,s)=>{const{api:n,organization:i,projectIds:o}=this.props,a=null==o?void 0:o.map(String);return(0,w.h1)(e.key)||(0,w.Xr)(e.key)?Promise.resolve([]):(0,Z.Fo)(n,i.slug,e.key,t,a,s,!0).then((e=>u()(e.filter((({name:e})=>(0,b.ri)(e))).map((({name:e})=>e)))),(()=>{throw new Error("Unable to fetch event field values")}))}),(({key:e},t)=>"".concat(e,"-").concat(t)))),(0,o.Z)(this,"prepareQuery",(e=>e.replace(P,"")))}componentDidMount(){var e,t;null===(e=(t=this.getEventFieldValues.cache).clear)||void 0===e||e.call(t)}componentDidUpdate(e){var t,s;m()(this.props.projectIds,e.projectIds)||null===(t=(s=this.getEventFieldValues.cache).clear)||void 0===t||t.call(s)}getTagList(e){const{fields:t,organization:s,tags:n,omitTags:i}=this.props,o=t?Object.fromEntries(t.filter((e=>!Object.keys(w.wZ).includes(e.field)&&!(0,w.GO)(e.field))).map((e=>[e.field,{key:e.field,name:e.field}]))):{},a=s.features.includes("performance-view")?Object.assign({},e,w.wZ,o):f()(w.wZ,w.J8),r=s.features.includes("semver")?Object.assign({},w.jg,a):a,l=d()({},n,r);return l.has={key:"has",name:"Has property",values:Object.keys(l),predefined:!0},f()(l,null!=i?i:[])}render(){const{organization:e}=this.props;return(0,N.tZ)(_.Z,{organization:e,children:({measurements:e})=>{const t=this.getTagList(e);return(0,N.tZ)(r.ms,{children:({css:e})=>(0,N.tZ)(x.Z,{hasRecentSearches:!0,savedSearchType:j.L4.EVENT,onGetTagValues:this.getEventFieldValues,supportedTags:t,prepareQuery:this.prepareQuery,excludeEnvironment:!0,dropdownClassName:e(n||(n=(0,i.Z)(["\n                    max-height: 300px;\n                    overflow-y: auto;\n                  "]))),...this.props})})}})}}C.displayName="SearchBar";const O=(0,k.Z)((0,S.Z)(C))},"./app/utils/measurements/measurements.tsx":(e,t,s)=>{s.d(t,{Z:()=>c}),s("../node_modules/core-js/modules/es.object.from-entries.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var n=s("../node_modules/react/index.js"),i=s("./app/utils/performance/vitals/constants.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){return Object.fromEntries(Object.entries(e).map((([e,t])=>[e,{name:t.name,key:e}])))}const r=a(i.T),l=a(i.r);function d({organization:e,children:t}){const s=e.features.includes("performance-mobile-vitals")?{...l,...r}:l;return(0,o.tZ)(n.Fragment,{children:t({measurements:s})})}d.displayName="Measurements";const c=d},"./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx":(e,t,s)=>{s.d(t,{Z:()=>u}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js");var n=s("../node_modules/lodash/pick.js"),i=s.n(n),o=s("./app/utils/discover/genericDiscoverQuery.tsx"),a=s("./app/utils/performance/constants.tsx"),r=s("./app/utils/withApi.tsx"),l=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){const{eventView:t,vitals:s}=e,n=null==t?void 0:t.getEventsAPIPayload(e.location);return{vital:s,...i()(n,["query",...Object.values(a.s)])}}function c(e){return(0,l.tZ)(o.ZP,{getRequestPayload:d,route:"events-vitals",...e,children:({tableData:t,...s})=>e.children({vitalsData:t,...s})})}c.displayName="VitalsCardsDiscoverQuery";const u=(0,r.Z)(c)},"./app/utils/withTags.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),o=s("./app/stores/tagStore.tsx"),a=s("./app/utils/getDisplayName.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends i.Component{constructor(...e){super(...e),(0,n.Z)(this,"state",{tags:o.Z.getAllTags()}),(0,n.Z)(this,"unsubscribe",o.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...s}=this.props;return(0,r.tZ)(e,{tags:null!=t?t:this.state.tags,...s})}}return t.displayName="WithTags",(0,n.Z)(t,"displayName","withTags(".concat((0,a.Z)(e),")")),t}},"./app/views/performance/landing/vitalsCards.tsx":(e,t,s)=>{s.d(t,{M9:()=>W,q7:()=>G,aU:()=>J,JO:()=>ee});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/es.symbol.description.js"),s("../node_modules/react/index.js")),o=s("../node_modules/@sentry/minimal/esm/index.js"),a=s("./app/components/card.tsx"),r=s("./app/components/charts/eventsRequest.tsx"),l=s("./app/components/charts/styles.tsx"),d=s("./app/components/charts/utils.tsx"),c=s("./app/components/emptyStateWarning.tsx"),u=s("./app/components/links/link.tsx"),p=s("./app/components/placeholder.tsx"),m=s("./app/components/questionTooltip.tsx"),h=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),v=s("../node_modules/react-sparklines/build/index.js"),g=s("../node_modules/prop-types/index.js"),f=s.n(g);class Z extends v.Sparklines{}(0,h.Z)(Z,"propTypes",{children:f().node,data:f().array,limit:f().number,width:f().number,height:f().number,svgWidth:f().number,svgHeight:f().number,preserveAspectRatio:f().string,margin:f().number,style:f().object,min:f().number,max:f().number,onMouseMove:f().func});var x=s("./app/components/tooltip.tsx"),y=s("./app/locale.tsx"),j=s("./app/styles/overflowEllipsis.tsx"),b=s("./app/styles/space.tsx"),w=s("./app/utils.tsx"),_=s("./app/utils/dates.tsx"),k=s("./app/utils/discover/discoverQuery.tsx"),S=s("./app/utils/discover/fields.tsx"),N=s("./app/utils/performance/vitals/constants.tsx"),P=s("./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx"),C=s("./app/utils/queryString.tsx"),O=s("./app/utils/theme.tsx"),A=s("./app/utils/useApi.tsx"),E=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const T=e=>(0,E.tZ)(D,{barHeight:e.barHeight,fractions:e.colorStops.map((({percent:e})=>e)),children:e.colorStops.map((e=>(0,E.tZ)(z,{color:e.color},e.color)))});T.displayName="ColorBar";const D=(0,n.Z)("div",{target:"etd41501"})("height:",(e=>e.barHeight?"".concat(e.barHeight,"px"):"16px"),";width:100%;overflow:hidden;position:relative;background:",(e=>e.theme.gray100),";display:grid;grid-template-columns:",(e=>e.fractions.map((e=>"".concat(e,"fr"))).join(" ")),";margin-bottom:",(e=>e.barHeight?"":(0,b.Z)(1)),";border-radius:2px;"),z=(0,n.Z)("div",{target:"etd41500"})("background-color:",(e=>e.theme[e.color]),";"),V=T;var B=s("./app/views/performance/vitalDetail/utils.tsx"),H=s("./app/utils/formatters.tsx");function L(e,t){const s=Array.isArray(e)||e===S.Zl.CLS?"":"ms";switch(t){case B.SP.POOR:return Array.isArray(e)?(0,y.t)("Poor"):(0,y._N)("Poor: >[threshold][unit]",{threshold:B.eE[e],unit:s});case B.SP.MEH:return Array.isArray(e)?(0,y.t)("Meh"):(0,y._N)("Meh: >[threshold][unit]",{threshold:B.MN[e],unit:s});case B.SP.GOOD:return Array.isArray(e)?(0,y.t)("Good"):(0,y._N)("Good: <[threshold][unit]",{threshold:B.MN[e],unit:s});default:return null}}function F(e){return(0,E.tZ)(M,{children:e.percents.map((t=>(0,E.tZ)(x.Z,{title:L(e.vital,t.vitalState),disabled:e.hideTooltips,children:(0,E.BX)(q,{"data-test-id":"vital-status",children:[B.Np[t.vitalState],(0,E.BX)("span",{children:[e.showVitalPercentNames&&(0,y.t)("".concat(t.vitalState))," ",(0,H.rl)(t.percent,0)]})]})},t.vitalState)))})}F.displayName="VitalPercents";const M=(0,n.Z)("div",{target:"ex3thpn1"})("display:inline-grid;grid-auto-flow:column;gap:",(0,b.Z)(2),";"),q=(0,n.Z)("div",{target:"ex3thpn0"})("display:flex;align-items:center;gap:",(0,b.Z)(.5),";font-size:",(e=>e.theme.fontSizeMedium),";");var I=s("./app/views/performance/landing/utils.tsx");function G(e){const{eventView:t,location:s,organization:n,projects:i,frontendOnly:o=!1}=e;if(o&&(0,I.Oo)(i,t)!==I.BY.FRONTEND_PAGELOAD)return null;const a=[S.Zl.FCP,S.Zl.LCP,S.Zl.FID,S.Zl.CLS];return(0,E.tZ)(P.Z,{eventView:t,location:s,orgSlug:n.slug,vitals:a,children:({isLoading:e,vitalsData:i})=>(0,E.tZ)(K,{children:a.map((o=>{var a,r,l;const d=(0,B.i4)({orgSlug:n.slug,query:t.generateQueryStringObject(),vitalName:o,projectID:(0,C.qP)(s.query.project)}),c=e?"—":ae(null!==(a=null==i?void 0:i[o])&&void 0!==a?a:null,o),p=(0,E.tZ)(Q,{children:(0,E.tZ)(ee,{isLoading:e,vital:o,data:i})});return(0,E.tZ)(u.Z,{to:d,"data-test-id":"vitals-linked-card-".concat(B.a7[o]),children:(0,E.tZ)(se,{title:null!==(r=B.jo[o])&&void 0!==r?r:"",tooltip:null!==(l=N.r[o].description)&&void 0!==l?l:"",value:e?"—":c,chart:p,minHeight:150})},o)}))})})}G.displayName="FrontendCards";const Q=(0,n.Z)("div",{target:"e1he14ku9"})("margin-top:",(0,b.Z)(1.5),";");function X(e){const t=(0,A.Z)(),{eventView:s,location:n,organization:i,functions:a}=e,{query:l}=n,c=s.withColumns(a),u=c.getPageFilters(),p=u.datetime.start?(0,_.hC)(u.datetime.start):void 0,m=u.datetime.end?(0,_.hC)(u.datetime.end):void 0,h="string"==typeof l.sparkInterval?l.sparkInterval:(0,d.ZS)({start:p||null,end:m||null,period:u.datetime.period},"low"),v=c.getEventsAPIPayload(n);return(0,E.tZ)(k.Z,{location:n,eventView:c,orgSlug:i.slug,limit:1,referrer:"api.performance.vitals-cards",children:({isLoading:e,tableData:s})=>(0,E.tZ)(r.Z,{api:t,organization:i,period:u.datetime.period,project:u.projects,environment:u.environments,team:v.team,start:p,end:m,interval:h,query:v.query,includePrevious:!1,yAxis:c.getFields(),partial:!0,children:({results:t})=>{const n=null==t?void 0:t.reduce(((e,t)=>(e[t.seriesName]=t.data.map((e=>e.value)),e)),{}),r=(0,I.hv)(i);return(0,E.tZ)(K,{children:a.map((t=>{var i,a;let l=(0,S.sN)(t);l.includes("apdex")&&(l="apdex()");const d=r[l];if(!d)return o.uT("Missing field '".concat(l,"' in vital cards.")),null;const{title:c,tooltip:u,formatter:p}=d,m=(0,S.LY)(l),h=null==s||null===(i=s.data)||void 0===i||null===(a=i[0])||void 0===a?void 0:a[m],v=null==n?void 0:n[l],g=e||!(0,w.ri)(h)?"—":p(h),f=(0,E.tZ)(Y,{data:v});return(0,E.tZ)(se,{title:c,tooltip:u,value:g,chart:f,horizontal:!0,minHeight:96,isNotInteractive:!0},l)}))})}})})}function R(e){return(0,E.tZ)(X,{...e,functions:[{kind:"function",function:["p75","transaction.duration",void 0,void 0]},{kind:"function",function:["tpm","",void 0,void 0]},{kind:"function",function:["failure_rate","",void 0,void 0]},{kind:"function",function:["apdex","",void 0,void 0]}]})}X.displayName="GenericCards",R.displayName="_BackendCards";const W=R;function U(e){const t=[{kind:"function",function:["p75","measurements.app_start_cold",void 0,void 0]},{kind:"function",function:["p75","measurements.app_start_warm",void 0,void 0]}];return e.showStallPercentage?t.push({kind:"function",function:["p75","measurements.stall_percentage",void 0,void 0]}):(t.push({kind:"function",function:["p75","measurements.frames_slow_rate",void 0,void 0]}),t.push({kind:"function",function:["p75","measurements.frames_frozen_rate",void 0,void 0]})),(0,E.tZ)(X,{...e,functions:t})}U.displayName="_MobileCards";const J=U;function Y(e){const{data:t}=e,s=O.ZP.charts.getColorPalette(1)[0];return(0,E.tZ)($,{"data-test-id":"sparkline",width:150,height:24,children:(0,E.tZ)(Z,{data:t,width:150,height:24,children:(0,E.tZ)(v.SparklinesLine,{style:{stroke:s,fill:"none",strokeWidth:3}})})})}Y.displayName="SparklineChart";const $=(0,n.Z)("div",{target:"e1he14ku8"})("flex-grow:4;max-height:",(e=>e.height),"px;max-width:",(e=>e.width),"px;margin:",(0,b.Z)(1)," ",(0,b.Z)(0)," ",(0,b.Z)(.5)," ",(0,b.Z)(3),";"),K=(0,n.Z)("div",{target:"e1he14ku7"})("display:grid;grid-template-columns:1fr;grid-column-gap:",(0,b.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-template-columns:repeat(2, 1fr);}@media (min-width: ",(e=>e.theme.breakpoints[2]),"){grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));}");function ee(e){var t;const{isLoading:s,data:n,vital:o,value:a,showBar:r=!0,showStates:l=!1,showDurationDetail:d=!1,showVitalPercentNames:c=!1,showDetail:u=!0,showTooltip:m=!1,barHeight:h}=e;if(s)return l?(0,E.tZ)(p.Z,{height:"48px"}):null;const v=l?(0,E.tZ)(te,{small:!0,children:(0,y.t)("No vitals found")}):null;if(!n)return v;const g={poor:0,meh:0,good:0,total:0};if((Array.isArray(o)?o:[o]).forEach((e=>{var t;const s=null!==(t=null==n?void 0:n[e])&&void 0!==t?t:{};Object.keys(g).forEach((e=>g[e]+=s[e]))})),!g.total)return v;const f=Array.isArray(o)?null:null!=a?a:ae(null!==(t=null==n?void 0:n[o])&&void 0!==t?t:null,o),Z=function({poor:e,meh:t,good:s,total:n}){const i=e/n,o=t/n,a=s/n;return[{vitalState:B.SP.GOOD,percent:a},{vitalState:B.SP.MEH,percent:o},{vitalState:B.SP.POOR,percent:i}]}(g),x=function(e){return e.map((({percent:e,vitalState:t})=>({percent:e,color:B.fL[t]})))}(Z);return(0,E.BX)(i.Fragment,{children:[r&&(0,E.tZ)(oe,{title:(0,E.tZ)(F,{vital:o,percents:Z,showVitalPercentNames:!0,hideTooltips:m}),disabled:!m,position:"bottom",children:(0,E.tZ)(V,{barHeight:h,colorStops:x})}),u&&(0,E.BX)(re,{children:[d&&f&&(0,E.BX)("div",{children:[(0,y.t)("The p75 for all transactions is "),(0,E.tZ)("strong",{children:f})]}),(0,E.tZ)(F,{vital:o,percents:Z,showVitalPercentNames:c})]})]})}ee.displayName="VitalBar";const te=(0,n.Z)(c.Z,{target:"e1he14ku6"})("height:48px;padding:",(0,b.Z)(1.5)," 15%;");function se(e){const{chart:t,minHeight:s,horizontal:n,title:i,tooltip:o,value:a,isNotInteractive:r}=e;return(0,E.BX)(ie,{interactive:!r,minHeight:s,children:[(0,E.BX)(l.Gh,{children:[(0,E.tZ)(de,{children:(0,y.t)(i)}),(0,E.tZ)(m.Z,{size:"sm",position:"top",title:o})]}),(0,E.BX)(ne,{horizontal:n,children:[(0,E.tZ)(le,{children:a}),t]})]})}se.displayName="VitalCard";const ne=(0,n.Z)("div",{target:"e1he14ku5"})("width:100%;display:flex;flex-direction:",(e=>e.horizontal?"row":"column"),";justify-content:space-between;"),ie=(0,n.Z)(a.Z,{target:"e1he14ku4"})("color:",(e=>e.theme.textColor),";padding:",(0,b.Z)(2)," ",(0,b.Z)(3),";align-items:flex-start;margin-bottom:",(0,b.Z)(2),";",(e=>e.minHeight&&"min-height: ".concat(e.minHeight,"px")),";"),oe=(0,n.Z)(x.Z,{target:"e1he14ku3"})({name:"1d3w5wq",styles:"width:100%"});function ae(e,t){var s;const n=null!==(s=null==e?void 0:e.p75)&&void 0!==s?s:null;return null===n?"—":t===S.Zl.CLS?n.toFixed(2):"".concat(n.toFixed(0),"ms")}const re=(0,n.Z)("div",{target:"e1he14ku2"})("font-size:",(e=>e.theme.fontSizeMedium),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){display:flex;justify-content:space-between;}"),le=(0,n.Z)("div",{target:"e1he14ku1"})("font-size:32px;margin-top:",(0,b.Z)(1),";"),de=(0,n.Z)("div",{target:"e1he14ku0"})(j.Z,";")}}]);
//# sourceMappingURL=../sourcemaps/app_components_events_searchBar_tsx-app_views_performance_landing_vitalsCards_tsx.a6d201dc0906802d81ec0589e2de8e52.js.map