"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_monitors_details_tsx"],{"./app/views/monitors/details.tsx":(t,e,s)=>{s.r(e),s.d(e,{default:()=>$});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),r=s("./app/components/panels/index.tsx"),i=s("./app/locale.tsx"),a=s("./app/views/asyncView.tsx"),d=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),c=s("./app/components/asyncComponent.tsx"),l=s("./app/components/duration.tsx"),p=s("./app/components/timeSince.tsx"),m=s("./app/styles/space.tsx");const h=(0,d.Z)("div",{target:"ehlf75x0"})("display:inline-block;position:relative;border-radius:50%;height:",(t=>t.size),"px;width:",(t=>t.size),"px;",(t=>t.color?"background: ".concat(t.color,";"):"background: ".concat("error"===t.status?t.theme.error:"ok"===t.status?t.theme.success:t.theme.disabled,";")),";");var u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class Z extends c.Z{getEndpoints(){const{monitor:t}=this.props;return[["checkInList","/monitors/".concat(t.id,"/checkins/"),{query:{per_page:10}}]]}renderError(){return(0,u.tZ)(b,{children:super.renderError()})}renderBody(){return(0,u.tZ)(r.N,{children:this.state.checkInList.map((t=>(0,u.BX)(r.Lv,{children:[(0,u.tZ)(x,{children:(0,u.tZ)(h,{status:t.status,size:16})}),(0,u.tZ)(v,{children:(0,u.tZ)(p.Z,{date:t.dateCreated})}),(0,u.tZ)(y,{children:t.duration&&(0,u.tZ)(l.Z,{seconds:t.duration/100})})]},t.id)))})}}const g=(0,d.Z)("div",{target:"e19bvxt54"})("margin-right:",(0,m.Z)(2),";"),x=(0,d.Z)(g,{target:"e19bvxt53"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),v=(0,d.Z)(g,{target:"e19bvxt52"})({name:"kow0uz",styles:"font-variant-numeric:tabular-nums"}),y=(0,d.Z)("div",{target:"e19bvxt51"})({name:"kow0uz",styles:"font-variant-numeric:tabular-nums"}),b=(0,d.Z)("div",{target:"e19bvxt50"})("margin:",(0,m.Z)(3)," ",(0,m.Z)(3)," 0;");var k=s("../node_modules/react-router/es/index.js"),I=s("./app/actionCreators/indicator.tsx"),w=s("./app/components/button.tsx"),B=s("./app/components/buttonBar.tsx"),f=s("./app/components/confirm.tsx"),N=s("./app/icons/index.tsx"),E=s("../node_modules/@sentry/minimal/esm/index.js"),z=s("./app/utils/useApi.tsx");const C=({monitor:t,orgId:e,onUpdate:s})=>{const o=(0,z.Z)();return(0,u.tZ)(_,{children:(0,u.BX)(B.ZP,{gap:1,children:[(0,u.BX)(w.ZP,{size:"small",icon:(0,u.tZ)(N.yl,{size:"xs"}),to:"/organizations/".concat(e,"/monitors/").concat(t.id,"/edit/"),children:["Â ",(0,i.t)("Edit")]}),(0,u.tZ)(w.ZP,{size:"small",onClick:()=>{return e={status:"disabled"===t.status?"active":"disabled"},(0,I.E3)(),void o.requestPromise("/monitors/".concat(t.id,"/"),{method:"PUT",data:e}).then((t=>{(0,I.B8)(),null==s||s(t)})).catch((t=>{var e;e=t,E.$e((t=>{E.Tb(e)})),window.console&&console.error&&console.error(e),(0,I.Iw)((0,i.t)("Unable to update monitor."))}));var e},children:"disabled"!==t.status?(0,i.t)("Pause"):(0,i.t)("Enable")}),(0,u.tZ)(f.Z,{onConfirm:()=>{const s="/organizations/".concat(e,"/monitors/");(0,I.E3)((0,i.t)("Deleting Monitor...")),o.requestPromise("/monitors/".concat(t.id,"/"),{method:"DELETE"}).then((()=>{k.browserHistory.push(s)})).catch((()=>{(0,I.Iw)((0,i.t)("Unable to remove monitor."))}))},message:(0,i.t)("Deleting this monitor is permanent. Are you sure you wish to continue?"),children:(0,u.tZ)(w.ZP,{size:"small",icon:(0,u.tZ)(N.Fz,{size:"xs"}),children:(0,i.t)("Delete")})})]})})};C.displayName="MonitorHeaderActions";const _=(0,d.Z)("div",{target:"e11hcv560"})("margin-bottom:",(0,m.Z)(3),";display:flex;flex-shrink:1;"),j=C;var q=s("./app/views/monitors/monitorIcon.tsx");const L=({monitor:t,orgId:e,onUpdate:s})=>(0,u.BX)("div",{className:"release-details",children:[(0,u.BX)("div",{className:"row",children:[(0,u.BX)("div",{className:"col-sm-6 col-xs-10",children:[(0,u.tZ)("h3",{children:t.name}),(0,u.tZ)("div",{className:"release-meta",children:t.id})]}),(0,u.BX)("div",{className:"col-sm-2 hidden-xs",children:[(0,u.tZ)("h6",{className:"nav-header",children:(0,i.t)("Last Check-in")}),t.lastCheckIn&&(0,u.tZ)(p.Z,{date:t.lastCheckIn})]}),(0,u.BX)("div",{className:"col-sm-2 hidden-xs",children:[(0,u.tZ)("h6",{className:"nav-header",children:(0,i.t)("Next Check-in")}),t.nextCheckIn&&(0,u.tZ)(p.Z,{date:t.nextCheckIn})]}),(0,u.BX)("div",{className:"col-sm-2",children:[(0,u.tZ)("h6",{className:"nav-header",children:(0,i.t)("Status")}),(0,u.tZ)(q.Z,{status:t.status,size:16})]})]}),(0,u.tZ)(j,{orgId:e,monitor:t,onUpdate:s})]});L.displayName="MonitorHeader";const P=L;var X=s("./app/components/issues/compactIssue.tsx"),M=s("./app/components/loadingError.tsx"),S=s("./app/components/loadingIndicator.tsx"),D=s("./app/components/pagination.tsx"),R=s("./app/utils/withApi.tsx"),T=s("./app/views/settings/components/emptyMessage.tsx");class U extends n.Component{constructor(...t){super(...t),(0,o.Z)(this,"state",this.getInitialState()),(0,o.Z)(this,"fetchData",(()=>{const{location:t,api:e,endpoint:s,query:o}=this.props;e.clear(),e.request(s,{method:"GET",query:{cursor:t&&t.query&&t.query.cursor||"",...o},success:(t,e,s)=>{var o;this.setState({data:t,loading:!1,error:!1,issueIds:t.map((t=>t.id)),pageLinks:null!==(o=null==s?void 0:s.getResponseHeader("Link"))&&void 0!==o?o:null})},error:()=>{this.setState({loading:!1,error:!0})}})}))}getInitialState(){return{issueIds:[],loading:!0,error:!1,pageLinks:null,data:[]}}componentWillMount(){this.fetchData()}componentWillReceiveProps(t){const{location:e}=this.props,s=t.location;e&&(e.pathname===s.pathname&&e.search===s.search||this.remountComponent())}remountComponent(){this.setState(this.getInitialState(),this.fetchData)}renderError(){return(0,u.tZ)("div",{style:{margin:"".concat((0,m.Z)(2)," ").concat((0,m.Z)(2)," 0")},children:(0,u.tZ)(M.Z,{onRetry:this.fetchData})})}renderLoading(){return(0,u.tZ)("div",{style:{margin:"18px 18px 0"},children:(0,u.tZ)(S.Z,{})})}renderEmpty(){const{emptyText:t}=this.props,{noBorder:e,noMargin:s}=this.props,o=e?{border:0,borderRadius:0}:{};return s&&(o.marginBottom=0),(0,u.tZ)(r.s_,{style:o,children:(0,u.tZ)(T.Z,{icon:(0,u.tZ)(N.jV,{size:"xl"}),children:t||(0,i.t)("Nothing to show here, move along.")})})}renderResults(){const{noBorder:t,noMargin:e,renderEmpty:s}=this.props,{loading:o,error:n,issueIds:i,data:a}=this.state;if(o)return this.renderLoading();if(n)return this.renderError();if(i.length>0){const s=t?{border:0,borderRadius:0}:{};return e&&(s.marginBottom=0),(0,u.tZ)(r.s_,{style:s,children:(0,u.tZ)(r.N,{className:"issue-list",children:a.map((t=>(0,u.tZ)(X.Z,{id:t.id,data:t},t.id)))})})}return(null==s?void 0:s())||this.renderEmpty()}render(){const{pageLinks:t}=this.state,{pagination:e}=this.props;return(0,u.BX)(n.Fragment,{children:[this.renderResults(),e&&t&&(0,u.tZ)(D.Z,{pageLinks:t,...this.props})]})}}U.displayName="IssueList";const A=(0,k.withRouter)((0,R.Z)(U)),F=({orgId:t,monitor:e})=>(0,u.tZ)(A,{endpoint:"/organizations/".concat(t,"/issues/"),query:{query:'monitor.id:"'+e.id+'"',project:e.project.id,limit:5},pagination:!1,emptyText:(0,i.t)("No issues found"),noBorder:!0,noMargin:!0});F.displayName="MonitorIssues";const H=F;var V=s("./app/components/charts/miniBarChart.tsx"),G=s("./app/utils/theme.tsx");class W extends c.Z{getEndpoints(){const{monitor:t}=this.props,e=Math.floor((new Date).getTime()/1e3),s=e-2592e3;return[["stats","/monitors/".concat(t.id,"/stats/"),{query:{since:s,until:e,resolution:"1d"}}]]}renderBody(){var t;let e=!0;const s={seriesName:(0,i.t)("Successful"),data:[]},o={seriesName:(0,i.t)("Failed"),data:[]};null===(t=this.state.stats)||void 0===t||t.forEach((t=>{(t.ok||t.error)&&(e=!1);const n=1e3*t.ts;s.data.push({name:n.toString(),value:t.ok}),o.data.push({name:n.toString(),value:t.error})}));const n=[G.ZP.green300,G.ZP.red300];return(0,u.tZ)(r.s_,{children:(0,u.tZ)(r.N,{withPadding:!0,children:e?(0,u.tZ)(T.Z,{title:(0,i.t)("Nothing recorded in the last 30 days."),description:(0,i.t)("All check-ins for this monitor.")}):(0,u.tZ)(V.Z,{isGroupedByDate:!0,showTimeInTooltip:!0,labelYAxisExtents:!0,stacked:!0,colors:n,height:150,series:[s,o]})})})}}class Y extends a.Z{constructor(...t){super(...t),(0,o.Z)(this,"onUpdate",(t=>this.setState((e=>({monitor:{...e.monitor,...t}})))))}getEndpoints(){const{params:t,location:e}=this.props;return[["monitor","/monitors/".concat(t.monitorId,"/"),{query:e.query}]]}getTitle(){return this.state.monitor?"".concat(this.state.monitor.name," - Monitors - ").concat(this.props.params.orgId):"Monitors - ".concat(this.props.params.orgId)}renderBody(){const{monitor:t}=this.state;return null===t?null:(0,u.BX)(n.Fragment,{children:[(0,u.tZ)(P,{monitor:t,orgId:this.props.params.orgId,onUpdate:this.onUpdate}),(0,u.tZ)(W,{monitor:t}),(0,u.BX)(r.s_,{style:{paddingBottom:0},children:[(0,u.tZ)(r.V9,{children:(0,i.t)("Related Issues")}),(0,u.tZ)(H,{monitor:t,orgId:this.props.params.orgId})]}),(0,u.BX)(r.s_,{children:[(0,u.tZ)(r.V9,{children:(0,i.t)("Recent Check-ins")}),(0,u.tZ)(Z,{monitor:t})]})]})}}const $=Y},"./app/views/monitors/monitorIcon.tsx":(t,e,s)=>{s.d(e,{Z:()=>o});const o=(0,s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"ezalhst0"})("display:inline-block;position:relative;border-radius:50%;height:",(t=>t.size),"px;width:",(t=>t.size),"px;",(t=>t.color?"background: ".concat(t.color,";"):"background: ".concat("error"===t.status?t.theme.error:"ok"===t.status?t.theme.success:t.theme.disabled,";")),";")}}]);
//# sourceMappingURL=../sourcemaps/app_views_monitors_details_tsx.f0194181394bdff424c7aa7b5451d706.js.map