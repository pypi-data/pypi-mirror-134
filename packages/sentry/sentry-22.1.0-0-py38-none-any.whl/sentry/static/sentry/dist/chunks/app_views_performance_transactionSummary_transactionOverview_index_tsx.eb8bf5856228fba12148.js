"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_performance_transactionSummary_transactionOverview_index_tsx"],{"./app/utils/performance/suspectSpans/suspectSpansQuery.tsx":(e,t,n)=>{n.d(t,{Z:()=>u});var i=n("../node_modules/lodash/omit.js"),a=n.n(i),r=n("./app/utils.tsx"),s=n("./app/utils/discover/genericDiscoverQuery.tsx"),o=n("./app/utils/withApi.tsx"),l=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c(e){const{perSuspect:t,spanOps:n,spanGroups:i}=e,a={perSuspect:t,spanOp:n,spanGroup:i};(0,r.ri)(a.perSuspect)||delete a.perSuspect,(0,r.ri)(a.spanOp)||delete a.spanOp,(0,r.ri)(a.spanGroup)||delete a.spanGroup;const s=e.eventView.getEventsAPIPayload(e.location);return Object.assign(a,s)}function p(e){return(0,l.tZ)(s.ZP,{route:"events-spans-performance",getRequestPayload:c,...a()(e,"children"),children:({tableData:t,...n})=>e.children({suspectSpans:t,...n})})}p.displayName="SuspectSpansQuery";const u=(0,o.Z)(p)},"./app/views/eventsV2/tags.tsx":(e,t,n)=>{n.d(t,{Z:()=>b});var i=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),s=n("../node_modules/@sentry/minimal/esm/index.js"),o=n("./app/actionCreators/events.tsx"),l=n("./app/components/charts/errorPanel.tsx"),c=n("./app/components/charts/styles.tsx"),p=n("./app/components/emptyStateWarning.tsx"),u=n("./app/components/placeholder.tsx"),d=n("./app/components/tagDistributionMeter.tsx"),m=n("./app/icons/index.tsx"),h=n("./app/locale.tsx"),g=n("./app/styles/space.tsx"),v=n("./app/utils/analytics.tsx"),x=n("./app/utils/discover/eventView.tsx"),f=n("./app/utils/withApi.tsx"),y=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class Z extends r.Component{constructor(...e){super(...e),(0,i.Z)(this,"state",{loading:!0,tags:[],totalValues:null,error:""}),(0,i.Z)(this,"shouldRefetchData",(e=>{const t=this.props.eventView.getFacetsAPIPayload(this.props.location),n=e.eventView.getFacetsAPIPayload(e.location);return!(0,x.ze)(t,n)})),(0,i.Z)(this,"fetchData",(async(e=!1)=>{const{api:t,organization:n,eventView:i,location:a,confirmedQuery:r}=this.props;if(this.setState({loading:!0,error:"",tags:[]}),e||!1!==r)try{const e=await(0,o.eV)(t,n.slug,i.getFacetsAPIPayload(a));this.setState({loading:!1,tags:e})}catch(e){s.Tb(e),this.setState({loading:!1,error:e})}})),(0,i.Z)(this,"handleTagClick",(e=>{const{organization:t}=this.props;(0,v.ec)({eventKey:"discover_v2.facet_map.clicked",eventName:"Discoverv2: Clicked on a tag on the facet map",tag:e,organization_id:parseInt(t.id,10)})})),(0,i.Z)(this,"renderBody",(()=>{const{loading:e,error:t,tags:n}=this.state;return e?this.renderPlaceholders():t?(0,y.tZ)(l.Z,{height:"132px",children:(0,y.tZ)(m.FC,{color:"gray300",size:"lg"})}):n.length>0?n.map((e=>this.renderTag(e))):(0,y.tZ)(w,{small:!0,children:(0,h.t)("No tags found")})}))}componentDidMount(){this.fetchData(!0)}componentDidUpdate(e){(this.shouldRefetchData(e)||e.confirmedQuery!==this.props.confirmedQuery)&&this.fetchData()}renderTag(e){const{generateUrl:t,totalValues:n}=this.props,i=e.topValues.map((n=>(n.url=t(e.key,n.value),n))),a=i.length>0?Math.max(Number(n),i[0].count):n;return(0,y.tZ)(d.Z,{title:e.key,segments:i,totalValues:Number(a),renderLoading:()=>(0,y.tZ)(S,{height:"16px"}),onTagClick:this.handleTagClick,showReleasePackage:!0},e.key)}renderPlaceholders(){return(0,y.BX)(r.Fragment,{children:[(0,y.tZ)(T,{},"title-1"),(0,y.tZ)(S,{},"bar-1"),(0,y.tZ)(T,{},"title-2"),(0,y.tZ)(S,{},"bar-2"),(0,y.tZ)(T,{},"title-3"),(0,y.tZ)(S,{},"bar-3")]})}render(){return(0,y.BX)(r.Fragment,{children:[(0,y.tZ)(c.OT,{children:(0,h.t)("Tag Summary")}),this.renderBody()]})}}Z.displayName="Tags";const w=(0,a.Z)(p.Z,{target:"e1pu9veq2"})({name:"rtpdsm",styles:"height:132px;padding:54px 15%"}),S=(0,a.Z)(u.Z,{target:"e1pu9veq1"})("border-radius:",(e=>e.theme.borderRadius),";height:16px;margin-bottom:",(0,g.Z)(1.5),";"),T=(0,a.Z)(u.Z,{target:"e1pu9veq0"})("width:100px;height:12px;margin-bottom:",(0,g.Z)(.5),";"),b=(0,f.Z)(Z)},"./app/views/performance/transactionSummary/transactionOverview/index.tsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>mt}),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var i=n("../node_modules/react/index.js"),a=n("../node_modules/react-router/es/index.js"),r=n("./app/actionCreators/tags.tsx"),s=n("./app/locale.tsx"),o=n("./app/utils/analytics.tsx"),l=n("./app/utils/discover/discoverQuery.tsx"),c=n("./app/utils/discover/eventView.tsx"),p=n("./app/utils/discover/fields.tsx"),u=n("./app/utils/performance/histogram/index.tsx"),d=n("./app/utils/queryString.tsx"),m=n("./app/utils/tokenizeSearch.tsx"),h=n("./app/utils/useApi.tsx"),g=n("./app/utils/withOrganization.tsx"),v=n("./app/utils/withPageFilters.tsx"),x=n("./app/utils/withProjects.tsx"),f=n("./app/views/performance/utils.tsx"),y=n("./app/views/performance/transactionSummary/filter.tsx"),Z=n("./app/views/performance/transactionSummary/pageLayout.tsx"),w=n("./app/views/performance/transactionSummary/tabs.tsx"),S=n("./app/views/performance/transactionSummary/transactionVitals/constants.tsx"),T=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),b=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),E=n("../node_modules/lodash/omit.js"),k=n.n(E),C=n("./app/components/acl/feature.tsx"),_=n("./app/components/discover/transactionsList.tsx"),q=n("./app/components/events/searchBar.tsx"),z=n("./app/components/globalSdkUpdateAlert.tsx"),j=n("./app/components/layouts/thirds.tsx"),V=n("./app/components/organizations/pageFilters/parse.tsx"),P=n("./app/constants/index.tsx"),I=n("./app/styles/space.tsx"),L=n("./app/utils.tsx"),N=n("./app/views/eventsV2/table/cellAction.tsx"),O=n("./app/views/eventsV2/tags.tsx"),D=n("./app/views/performance/metricsSearchBar.tsx"),F=n("./app/views/performance/transactionSummary/utils.tsx"),A=n("./app/views/performance/transactionSummary/transactionOverview/charts.tsx"),B=n("../node_modules/lodash/pick.js"),M=n.n(B),X=n("./app/components/button.tsx"),R=n("./app/components/charts/styles.tsx"),U=n("./app/components/emptyStateWarning.tsx"),W=n("./app/components/issues/groupList.tsx"),K=n("./app/components/panels/index.tsx"),$=n("./app/constants/pageFilters.tsx"),Q=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class G extends i.Component{constructor(...e){super(...e),(0,T.Z)(this,"handleOpenClick",(()=>{const{organization:e}=this.props;(0,o.ec)({eventKey:"performance_views.summary.open_issues",eventName:"Performance Views: Open issues from transaction summary",organization_id:parseInt(e.id,10)})})),(0,T.Z)(this,"renderEmptyMessage",(()=>{const{statsPeriod:e}=this.props,t=e&&P.wh[e],n=t?t.toLowerCase():(0,s.t)("given timeframe");return(0,Q.tZ)(K.s_,{children:(0,Q.tZ)(K.N,{children:(0,Q.tZ)(U.Z,{children:(0,Q.tZ)("p",{children:(0,s._N)("No new issues for this transaction for the [timePeriod].",{timePeriod:n})})})})})}))}getIssuesEndpoint(){const{transaction:e,organization:t,start:n,end:i,statsPeriod:a,location:r}=this.props,s={start:n,end:i,statsPeriod:a,limit:5,sort:"new",...M()(r.query,[...Object.values($.nF),"cursor"])},o=new m.MY((0,d.ro)(r.query.query,""));return(0,f.m_)(o),o.addFreeText("is:unresolved").setFilterValues("transaction",[e]),{path:"/organizations/".concat(t.slug,"/issues/"),queryParams:{...s,query:o.formatString()}}}render(){const{organization:e}=this.props,{path:t,queryParams:n}=this.getIssuesEndpoint(),a={pathname:"/organizations/".concat(e.slug,"/issues/"),query:n};return(0,Q.BX)(i.Fragment,{children:[(0,Q.BX)(Y,{children:[(0,Q.tZ)(R.OT,{children:(0,s.t)("Related Issues")}),(0,Q.tZ)(X.ZP,{"data-test-id":"issues-open",size:"small",to:a,onClick:this.handleOpenClick,children:(0,s.t)("Open in Issues")})]}),(0,Q.tZ)(H,{children:(0,Q.tZ)(W.Z,{orgId:e.slug,endpointPath:t,queryParams:n,query:"",canSelectGroups:!1,renderEmptyMessage:this.renderEmptyMessage,withChart:!1,withPagination:!1})})]})}}G.displayName="RelatedIssues";const Y=(0,b.Z)("div",{target:"el0d6on1"})("display:flex;align-items:center;justify-content:space-between;margin-bottom:",(0,I.Z)(1),";"),H=(0,b.Z)("div",{target:"el0d6on0"})("margin-bottom:",(0,I.Z)(4),";",K.s_,"{margin-bottom:-",(0,I.Z)(1),";}"),J=G;var ee=n("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),te=n("./app/components/charts/chartZoom.tsx"),ne=n("./app/components/charts/errorPanel.tsx"),ie=n("./app/components/charts/eventsRequest.tsx"),ae=n("./app/components/charts/lineChart.tsx"),re=n("./app/components/charts/transitionChart.tsx"),se=n("./app/components/charts/transparentLoadingMask.tsx"),oe=n("./app/components/charts/utils.tsx"),le=n("./app/components/placeholder.tsx"),ce=n("./app/components/questionTooltip.tsx"),pe=n("./app/icons/index.tsx"),ue=n("./app/utils/dates.tsx"),de=n("./app/utils/discover/charts.tsx"),me=n("./app/utils/formatters.tsx"),he=n("./app/utils/getDynamicText.tsx"),ge=n("./app/utils/metrics/fields.tsx"),ve=n("./app/utils/metrics/metricsRequest.tsx"),xe=n("./app/views/performance/data.tsx"),fe=n("./app/views/performance/landing/widgets/transforms/transformMetricsToArea.tsx"),ye=n("./app/views/performance/landing/widgets/widgetDefinitions.tsx");function Ze({organization:e,isLoading:t,error:n,totals:i,start:a,end:r,utc:o,router:l,statsPeriod:c,chartData:p,isMetricsData:u}){return(0,Q.BX)(Te,{children:[(0,Q.BX)(Ee,{top:"0px",children:[(0,Q.BX)(be,{children:[(0,s.t)("Apdex"),(0,Q.tZ)(ce.Z,{position:"top",title:(0,xe.$r)(e,xe.V$.APDEX_NEW),size:"sm"})]}),u?"TODO Metrics":(0,Q.tZ)(Se,{"data-test-id":"apdex-summary-value",isLoading:t,error:n,value:u?null:i?(0,me.$1)(i.apdex,4):null})]}),(0,Q.BX)(Ee,{top:"160px",children:[(0,Q.BX)(be,{children:[(0,s.t)("Failure Rate"),(0,Q.tZ)(ce.Z,{position:"top",title:(0,xe.$r)(e,xe.V$.FAILURE_RATE),size:"sm"})]}),(0,Q.tZ)(Se,{"data-test-id":"failure-rate-summary-value",isLoading:t,error:n,value:i?(0,me.rl)(i.failure_rate):null})]}),(0,Q.BX)(Ee,{top:"320px",children:[(0,Q.BX)(be,{children:[(0,s.t)("TPM"),(0,Q.tZ)(ce.Z,{position:"top",title:(0,xe.$r)(e,xe.V$.TPM),size:"sm"})]}),(0,Q.tZ)(Se,{"data-test-id":"tpm-summary-value",isLoading:t,error:n,value:i?(0,s._N)("[tpm] tpm",{tpm:(0,me.$1)(i.tpm,4)}):null})]}),(0,Q.tZ)(te.Z,{router:l,period:c,start:a,end:r,utc:o,xAxisIndex:[0,1,2],children:e=>{const{errored:t,loading:n,reloading:i,chartOptions:a,series:r}=p;return t?(0,Q.tZ)(ne.Z,{height:"580px",children:(0,Q.tZ)(pe.FC,{color:"gray300",size:"lg"})}):(0,Q.BX)(re.Z,{loading:n,reloading:i,height:"580px",children:[(0,Q.tZ)(se.Z,{visible:i}),(0,he.Z)({value:(0,Q.tZ)(ae.Z,{...e,...a,series:r}),fixed:(0,Q.tZ)(le.Z,{height:"480px",testId:"skeleton-ui"})})]})}})]})}function we({location:e,eventView:t,organization:n,router:i,isLoading:a,error:r,totals:o,isMetricsData:l}){const c=(0,h.Z)(),p=(0,ee.u)(),u=p.charts.getColorPalette(3),d=t.statsPeriod,g=t.start?(0,ue.hC)(t.start):void 0,v=t.end?(0,ue.hC)(t.end):void 0,x=t.project,f=t.environment,y=t.query,Z="true"===(0,V.fK)(e.query).utc,w={scale:!0,axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}},S={height:480,grid:[{top:"60px",left:"10px",right:"10px",height:"100px"},{top:"220px",left:"10px",right:"10px",height:"100px"},{top:"380px",left:"10px",right:"10px",height:"120px"}],axisPointer:{link:[{xAxisIndex:[0,1,2]}]},xAxes:Array.from(new Array(3)).map(((e,t)=>({gridIndex:t,type:"time",show:!1}))),yAxes:[{gridIndex:0,interval:.2,axisLabel:{formatter:e=>(0,me.$1)(e,1),color:p.chartLabel},...w},{gridIndex:1,splitNumber:4,interval:.5,max:1,axisLabel:{formatter:e=>(0,me.rl)(e,0),color:p.chartLabel},...w},{gridIndex:2,splitNumber:4,axisLabel:{formatter:me.Du,color:p.chartLabel},...w}],utc:Z,isGroupedByDate:!0,showTimeInTooltip:!0,colors:[u[0],u[1],u[2]],tooltip:{trigger:"axis",truncate:80,valueFormatter:de.CX,nameFormatter:e=>"epm()"===e?"tpm()":e}},T={api:c,start:g,end:v,statsPeriod:d,project:x,environment:f,query:y},b={organization:n,router:i,error:r,isLoading:a,start:g,end:v,utc:Z,totals:o};if(l){const t=["count(".concat(ge.kY.SENTRY_TRANSACTIONS_TRANSACTION_DURATION,")")];return S.tooltip.nameFormatter=e=>"failure_rate()"===e?t[0]:e,(0,Q.tZ)(ve.Z,{...T,query:new m.MY(T.query).formatString(),orgSlug:n.slug,field:t,groupBy:["transaction.status"],children:i=>{const a=(0,fe.g)({location:e,fields:t,chartSetting:ye.s.FAILURE_RATE_AREA},i),r=a.data.map((e=>({...e,seriesName:"failure_rate()",yAxisIndex:1,xAxisIndex:1})));return(0,Q.tZ)(ve.Z,{api:c,orgSlug:n.slug,start:g,end:v,statsPeriod:d,project:x,environment:f,query:new m.MY(y).formatString(),field:t,children:n=>{var o,l,c,p;const u=(0,fe.g)({location:e,fields:t,chartSetting:ye.s.TPM_AREA},n),d=u.data.map((e=>({...e,yAxisIndex:2,xAxisIndex:2})));return(0,Q.tZ)(Ze,{...b,totals:{failure_rate:null!==(o=null===(l=a.dataMean)||void 0===l?void 0:l[0].mean)&&void 0!==o?o:0,tpm:null!==(c=null===(p=u.dataMean)||void 0===p?void 0:p[0].mean)&&void 0!==c?c:0},isLoading:i.loading||n.loading,error:i.errored||n.errored?(0,s.t)("Error fetching metrics data"):null,chartData:{loading:i.loading||n.loading,reloading:i.reloading||n.reloading,errored:i.errored||n.errored,chartOptions:S,series:[...r,...d]},isMetricsData:!0})}})}})}const E={start:g||null,end:v||null,period:d};return(0,Q.tZ)(ie.Z,{...T,organization:n,interval:(0,oe.ZS)(E),showLoading:!1,includePrevious:!1,yAxis:["apdex()","failure_rate()","epm()"],partial:!0,referrer:"api.performance.transaction-summary.sidebar-chart",children:({results:e,errored:t,loading:n,reloading:i})=>{const a=e?e.map(((e,t)=>({...e,yAxisIndex:t,xAxisIndex:t}))):[];return(0,Q.tZ)(Ze,{...b,chartData:{series:a,errored:t,loading:n,reloading:i,chartOptions:S}})}})}function Se({error:e,isLoading:t,value:n,...i}){return e?(0,Q.tZ)("div",{...i,children:"—"}):t?(0,Q.tZ)(le.Z,{height:"24px",...i}):(0,Q.tZ)(ke,{...i,children:n})}Ze.displayName="SidebarCharts",we.displayName="SidebarChartsContainer",Se.displayName="ChartSummaryValue";const Te=(0,b.Z)("div",{target:"ecri4wp3"})({name:"bjn8wh",styles:"position:relative"}),be=(0,b.Z)(R.OT,{target:"ecri4wp2"})({name:"ti75j2",styles:"margin:0"}),Ee=(0,b.Z)("div",{target:"ecri4wp1"})("position:absolute;top:",(e=>e.top),";z-index:1;"),ke=(0,b.Z)("div",{target:"ecri4wp0"})("font-size:",(e=>e.theme.fontSizeExtraLarge),";"),Ce=(0,a.withRouter)(we);function _e({data:e}){const t=e.reduce(((e,t)=>t.value+e),0);return(0,Q.tZ)(ze,{children:e.map(((e,n)=>(0,Q.BX)(i.Fragment,{children:[(0,Q.tZ)(je,{children:(0,me.rl)(e.value/t,0)}),(0,Q.BX)(Ve,{"data-test-id":"status-".concat(e.label),cursor:e.onClick?"pointer":"default",onClick:e.onClick,children:[(0,Q.tZ)(Ie,{style:{width:"".concat((e.value/t*100).toFixed(2),"%")}}),(0,Q.tZ)(Pe,{children:e.label})]})]},"".concat(n,":").concat(e.label))))})}_e.displayName="BreakdownBars";const qe=_e,ze=(0,b.Z)("div",{target:"e1yzi37b4"})("display:grid;grid-template-columns:min-content auto;column-gap:",(0,I.Z)(1),";row-gap:",(0,I.Z)(1),";"),je=(0,b.Z)("div",{target:"e1yzi37b3"})("font-size:",(e=>e.theme.fontSizeExtraLarge),";text-align:right;"),Ve=(0,b.Z)("div",{target:"e1yzi37b2"})("padding-left:",(0,I.Z)(1),";padding-right:",(0,I.Z)(1),";position:relative;cursor:",(e=>e.cursor),";"),Pe=(0,b.Z)("span",{target:"e1yzi37b1"})("position:relative;color:",(e=>e.theme.textColor),";z-index:2;font-size:",(e=>e.theme.fontSizeSmall),";"),Ie=(0,b.Z)("div",{target:"e1yzi37b0"})("border-radius:2px;background-color:",(e=>e.theme.border),";position:absolute;top:0;left:0;z-index:1;height:100%;width:0%;");function Le({eventView:e,location:t,organization:n}){const r=e.withColumns([{kind:"function",function:["count","","",void 0]},{kind:"field",field:"transaction.status"}]).withSorts([{kind:"desc",field:"count"}]);return(0,Q.BX)(i.Fragment,{children:[(0,Q.BX)(R.OT,{children:[(0,s.t)("Status Breakdown"),(0,Q.tZ)(ce.Z,{position:"top",title:(0,xe.$r)(n,xe.V$.STATUS_BREAKDOWN),size:"sm"})]}),(0,Q.tZ)(l.Z,{eventView:r,location:t,orgSlug:n.slug,referrer:"api.performance.status-breakdown",children:({isLoading:n,error:i,tableData:r})=>{if(n)return(0,Q.tZ)(le.Z,{height:"124px"});if(i)return(0,Q.tZ)(ne.Z,{height:"124px",children:(0,Q.tZ)(pe.FC,{color:"gray300",size:"lg"})});if(!r||0===r.data.length)return(0,Q.tZ)(Ne,{small:!0,children:(0,s.t)("No statuses found")});const o=r.data.map((n=>({label:String(n["transaction.status"]),value:parseInt(String(n.count),10),onClick:()=>{const i=new m.MY(e.query);i.removeFilter("!transaction.status").setFilterValues("transaction.status",[n["transaction.status"]]),a.browserHistory.push({pathname:t.pathname,query:{...t.query,cursor:void 0,query:i.formatString()}})}})));return(0,Q.tZ)(qe,{data:o})}})]})}Le.displayName="StatusBreakdown";const Ne=(0,b.Z)(U.Z,{target:"e1ilkz930"})({name:"wwhhbg",styles:"height:124px;padding:50px 15%"}),Oe=Le;var De=n("./app/components/featureBadge.tsx"),Fe=n("./app/components/pagination.tsx"),Ae=n("./app/utils/performance/suspectSpans/suspectSpansQuery.tsx"),Be=n("./app/utils/useProjects.tsx"),Me=n("./app/views/performance/transactionSummary/transactionSpans/suspectSpansTable.tsx"),Xe=n("./app/views/performance/transactionSummary/transactionSpans/types.tsx"),Re=n("./app/views/performance/transactionSummary/transactionSpans/utils.tsx");function Ue(e){var t;const{location:n,organization:a,eventView:r,totals:s,projectId:o,transactionName:l}=e,c=(0,Re.TK)(n,"spanSort"),p=(0,d.ro)(null===(t=n.query)||void 0===t?void 0:t.spansCursor),u=r.withColumns([...Object.values(Xe.g),...Object.values(Xe.p)].map((e=>({kind:"field",field:e})))).withSorts([{kind:"desc",field:c.field}]),m=Re.uQ[c.field];u.fields=m?m.map((e=>({field:e}))):[];const{projects:h}=(0,Be.Z)();return(0,Q.tZ)(Ae.Z,{location:n,orgSlug:a.slug,eventView:u,limit:4,perSuspect:0,cursor:p,children:({suspectSpans:e,isLoading:t,pageLinks:r})=>(0,Q.BX)(i.Fragment,{children:[(0,Q.tZ)(We,{location:n,organization:a,projectId:o,transactionName:l,pageLinks:r}),(0,Q.tZ)(Me.Z,{location:n,organization:a,transactionName:l,project:h.find((e=>e.id===o)),isLoading:t,suspectSpans:null!=e?e:[],totals:s,sort:Xe.g.SUM_EXCLUSIVE_TIME})]})})}function We(e){const{location:t,organization:n,projectId:i,transactionName:r,pageLinks:o}=e,l=(0,Re.hN)({orgSlug:n.slug,transaction:r,projectID:i,query:t.query});return(0,Q.BX)(Ke,{children:[(0,Q.BX)("div",{children:[(0,Q.tZ)(R.OT,{children:(0,s.t)("Suspect Spans")}),(0,Q.tZ)(De.Z,{type:"alpha"})]}),(0,Q.tZ)(X.ZP,{to:l,size:"small","data-test-id":"suspect-spans-open-tab",children:(0,s.t)("View All Spans")}),(0,Q.tZ)($e,{pageLinks:o,onCursor:(e,t,n)=>{a.browserHistory.push({pathname:t,query:{...n,spansCursor:e}})},size:"small"})]})}Ue.displayName="SuspectSpans",We.displayName="SuspectSpansHeader";const Ke=(0,b.Z)("div",{target:"e96e1ws1"})("display:grid;grid-template-columns:1fr auto auto;margin-bottom:",(0,I.Z)(1),";"),$e=(0,b.Z)(Fe.Z,{target:"e96e1ws0"})("margin:0 0 0 ",(0,I.Z)(1),";");var Qe=n("./app/views/performance/transactionSummary/transactionOverview/tagExplorer.tsx"),Ge=n("./app/components/links/link.tsx"),Ye=n("./app/components/userMisery.tsx"),He=n("./app/views/performance/transactionSummary/transactionVitals/utils.tsx"),Je=n("./app/views/performance/vitalDetail/vitalInfo.tsx");function et({isLoading:e,hasWebVitals:t,error:n,totals:a,location:r,organization:o,transactionName:l,eventView:c,isMetricsData:u}){let m=null!==n?(0,Q.tZ)("div",{children:"—"}):(0,Q.tZ)(le.Z,{height:"34px"});if(!e&&null===n&&a){const e=a.project_threshold_config[1],t=a.count_miserable_user,n=a.user_misery,i=a.count_unique_user;m=(0,Q.tZ)(Ye.Z,{bars:40,barHeight:30,userMisery:n,miseryLimit:e,totalUsers:i,miserableUsers:t})}const h=o.slug,g=(0,He.Pl)({orgSlug:h,transaction:l,projectID:(0,d.ro)(r.query.project),query:r.query});return(0,Q.BX)(i.Fragment,{children:[t&&(0,Q.BX)(i.Fragment,{children:[(0,Q.BX)(tt,{children:[(0,Q.BX)(R.OT,{children:[(0,s.t)("Web Vitals"),(0,Q.tZ)(ce.Z,{position:"top",title:(0,s.t)('Web Vitals with p75 better than the "poor" threshold, as defined by Google Web Vitals.'),size:"sm"})]}),(0,Q.tZ)(Ge.Z,{to:g,children:(0,Q.tZ)(pe.V$,{})})]}),(0,Q.tZ)(Je.Z,{location:r,vital:[p.Zl.FCP,p.Zl.LCP,p.Zl.FID,p.Zl.CLS],orgSlug:h,environment:c.environment,start:c.start,end:c.end,statsPeriod:c.statsPeriod,project:c.project,isMetricsData:u,hideVitalPercentNames:!0,hideDurationDetail:!0}),(0,Q.tZ)(F.uI,{})]}),(0,Q.BX)(R.OT,{children:[(0,s.t)("User Misery"),(0,Q.tZ)(ce.Z,{position:"top",title:(0,xe.$r)(o,xe.V$.USER_MISERY_NEW),size:"sm"})]}),m,(0,Q.tZ)(F.uI,{})]})}et.displayName="UserStats";const tt=(0,b.Z)("div",{target:"e11vlg4d0"})({name:"1066lcq",styles:"display:flex;justify-content:space-between;align-items:center"}),nt=et;class it extends i.Component{constructor(...e){super(...e),(0,T.Z)(this,"handleSearch",(e=>{const{location:t}=this.props,n=(0,V.fK)({...t.query||{},query:e}),i=k()(n,"cursor");a.browserHistory.push({pathname:t.pathname,query:i})})),(0,T.Z)(this,"generateTagUrl",((e,t)=>{const{location:n}=this.props,i=(0,L.ZT)(n.query,{key:(0,p.ZC)(e),value:t});return{...n,query:i}})),(0,T.Z)(this,"handleCellAction",(e=>(t,n)=>{const{eventView:i,location:r}=this.props,s=new m.MY(i.query);s.removeFilter("event.type"),s.removeFilter("transaction"),(0,N.rh)(s,t,e,n),a.browserHistory.push({pathname:r.pathname,query:{...r.query,cursor:void 0,query:s.formatString()}})})),(0,T.Z)(this,"handleTransactionsListSortChange",(e=>{const{location:t}=this.props,n={pathname:t.pathname,query:{...t.query,showTransactions:e,transactionCursor:void 0}};a.browserHistory.push(n)})),(0,T.Z)(this,"handleAllEventsViewClick",(()=>{const{organization:e}=this.props;(0,o.ec)({eventKey:"performance_views.summary.view_in_transaction_events",eventName:"Performance Views: View in All Events from Transaction Summary",organization_id:parseInt(e.id,10)})})),(0,T.Z)(this,"handleDiscoverViewClick",(()=>{const{organization:e}=this.props;(0,o.ec)({eventKey:"performance_views.summary.view_in_discover",eventName:"Performance Views: View in Discover from Transaction Summary",organization_id:parseInt(e.id,10)})}))}generateEventView(e,t){var n;const{location:i,totalValues:a,spanOperationBreakdownFilter:r}=this.props,{selected:s}=at(i,{p95:null!==(n=null==a?void 0:a.p95)&&void 0!==n?n:0,spanOperationBreakdownFilter:r}),o=e.withSorts([s.sort]);if(r===y.f1.None){const e=[...o.fields.slice(0,t.length)];o.fields=e.filter((({field:e})=>!(0,p.sU)(e)))}return o}render(){var e;let{eventView:t}=this.props;const{projectId:n,transactionName:a,location:r,organization:o,projects:l,isLoading:c,error:u,totalValues:m,onChangeFilter:h,spanOperationBreakdownFilter:g,isMetricsData:v}=this.props,x=o.features.includes("performance-events-page"),Z=o.features.includes("performance-chart-interpolation"),w=(0,d.ro)(r.query.query,""),T=null===m?null:m.count,b=(0,f.Ik)(t,l)||null!==m&&S.PE.some((e=>e.vitals.some((e=>{const t=(0,p.LY)("percentile(".concat(e,", ").concat(S.GW,")"));return Number.isFinite(m[t])})))),E=(0,f.iL)(t,l),k=[(0,s.t)("event id"),(0,s.t)("user"),(0,s.t)("total duration"),(0,s.t)("trace id"),(0,s.t)("timestamp")];let z=t.clone();if(o.features.includes("performance-ops-breakdown")){const e=(0,y.Is)(g,r);e&&(t=t.clone(),t.query="".concat(t.query," ").concat(e).trim(),z=t.clone());const n=g===y.f1.None?(0,s.t)("operation duration"):"".concat(g," duration");k.splice(2,0,n);let i=p.zD;g!==y.f1.None&&(i=(0,y.T$)(g));const a=[...z.fields];a.splice(2,0,{field:i}),g===y.f1.None&&a.push(...p.$4.map((e=>({field:e})))),z.fields=a}const V={generatePerformanceTransactionEventsView:()=>{const e=this.generateEventView(z,k);return e.query=w,e},handleOpenAllEventsClick:this.handleAllEventsViewClick},I={generateDiscoverEventView:()=>this.generateEventView(z,k),handleOpenInDiscoverClick:this.handleDiscoverViewClick};return(0,Q.BX)(i.Fragment,{children:[(0,Q.BX)(j.or,{children:[(0,Q.BX)(rt,{children:[(0,Q.tZ)(y.ZP,{organization:o,currentFilter:g,onChangeFilter:h}),(0,Q.tZ)(st,{children:v?(0,Q.tZ)(D.Z,{searchSource:"transaction_summary_metrics",orgSlug:o.slug,projectIds:t.project,query:w,onSearch:this.handleSearch,maxQueryLength:P.dI}):(0,Q.tZ)(q.Z,{searchSource:"transaction_summary",organization:o,projectIds:t.project,query:w,fields:t.fields,onSearch:this.handleSearch,maxQueryLength:P.dI})})]}),(0,Q.tZ)(A.Z,{organization:o,location:r,eventView:t,totalValues:T,currentFilter:g,withoutZerofill:Z}),(0,Q.tZ)(_.Z,{location:r,organization:o,eventView:z,...x?V:I,showTransactions:(0,d.ro)(r.query.showTransactions,F.K0.SLOW),breakdown:(0,y.q0)(r),titles:k,handleDropdownChange:this.handleTransactionsListSortChange,generateLink:{id:(0,F.vd)(a),trace:(0,F.Z6)(t.normalizeDateSelection(r))},handleCellAction:this.handleCellAction,...at(r,{p95:null!==(e=null==m?void 0:m.p95)&&void 0!==e?e:0,spanOperationBreakdownFilter:g}),forceLoading:c}),(0,Q.tZ)(C.Z,{requireAll:!1,features:["organizations:performance-suspect-spans-view"],children:(0,Q.tZ)(Ue,{location:r,organization:o,eventView:t,totals:(0,L.ri)(null==m?void 0:m.count)?{count:m.count}:null,projectId:n,transactionName:a})}),(0,Q.tZ)(Qe.D_,{eventView:t,organization:o,location:r,projects:l,transactionName:a,currentFilter:g}),(0,Q.tZ)(J,{organization:o,location:r,transaction:a,start:t.start,end:t.end,statsPeriod:t.statsPeriod})]}),(0,Q.BX)(j.MF,{children:[(0,Q.tZ)(nt,{organization:o,location:r,isLoading:c,hasWebVitals:b,error:u,totals:m,transactionName:a,eventView:t,isMetricsData:v}),!E&&(0,Q.tZ)(Oe,{eventView:t,organization:o,location:r}),(0,Q.tZ)(F.uI,{}),(0,Q.tZ)(Ce,{organization:o,isLoading:c,error:u,totals:m,eventView:t,isMetricsData:v}),(0,Q.tZ)(F.uI,{}),(0,Q.tZ)(O.Z,{generateUrl:this.generateTagUrl,totalValues:T,eventView:t,organization:o,location:r})]})]})}}function at(e,t){const n=function({p95:e,spanOperationBreakdownFilter:t}){if(t===y.f1.None)return[{sort:{kind:"asc",field:"transaction.duration"},value:F.K0.FASTEST,label:(0,s.t)("Fastest Transactions")},{query:[["transaction.duration","<=".concat(e.toFixed(0))]],sort:{kind:"desc",field:"transaction.duration"},value:F.K0.SLOW,label:(0,s.t)("Slow Transactions (p95)")},{sort:{kind:"desc",field:"transaction.duration"},value:F.K0.OUTLIER,label:(0,s.t)("Outlier Transactions (p100)")},{sort:{kind:"desc",field:"timestamp"},value:F.K0.RECENT,label:(0,s.t)("Recent Transactions")}];const n=(0,y.T$)(t),i=t;return[{sort:{kind:"asc",field:n},value:F.K0.FASTEST,label:(0,s.t)("Fastest %s Operations",i)},{query:[["transaction.duration","<=".concat(e.toFixed(0))]],sort:{kind:"desc",field:n},value:F.K0.SLOW,label:(0,s.t)("Slow %s Operations (p95)",i)},{sort:{kind:"desc",field:n},value:F.K0.OUTLIER,label:(0,s.t)("Outlier %s Operations (p100)",i)},{sort:{kind:"desc",field:"timestamp"},value:F.K0.RECENT,label:(0,s.t)("Recent Transactions")}]}(t),i=(0,d.ro)(e.query.showTransactions,F.K0.SLOW);return{selected:n.find((e=>e.value===i))||n[0],options:n}}it.displayName="SummaryContent";const rt=(0,b.Z)("div",{target:"ent1li2"})("display:flex;width:100%;margin-bottom:",(0,I.Z)(3),";"),st=(0,b.Z)("div",{target:"ent1li1"})({name:"1ff36h2",styles:"flex-grow:1"});(0,b.Z)(z.Z,{target:"ent1li0"})("@media (min-width: ",(e=>e.theme.breakpoints[1]),"){margin-bottom:0;}").defaultProps={Wrapper:e=>(0,Q.tZ)(j.or,{fullWidth:!0,...e})};const ot=(0,x.Z)(it);var lt=n("./app/views/performance/transactionSummary/transactionOverview/latencyChart.tsx");function ct(e){const t=(0,h.Z)(),{location:n,selection:a,organization:s,projects:o}=e;return(0,i.useEffect)((()=>{(0,r.QK)(t,s.slug,a),(0,f.n4)(a)}),[a]),(0,Q.tZ)(Z.Z,{location:n,organization:s,projects:o,tab:w.Z.TransactionSummary,getDocumentTitle:ut,generateEventView:dt,childComponent:pt})}function pt(e){const{location:t,organization:n,eventView:i,projectId:r,transactionName:s,transactionThreshold:c,transactionThresholdMetric:p,isMetricsData:d}=e,m=(0,y.q0)(t),h=function(e,t){const n=S.PE.map((({vitals:e})=>e)).reduce(((e,t)=>(t.forEach((t=>e.push(t))),e)),[]);return t.withColumns([{kind:"function",function:["p95","",void 0,void 0]},{kind:"function",function:["count","",void 0,void 0]},{kind:"function",function:["count_unique","user",void 0,void 0]},{kind:"function",function:["failure_rate","",void 0,void 0]},{kind:"function",function:["tpm","",void 0,void 0]},{kind:"function",function:["count_miserable","user",void 0,void 0]},{kind:"function",function:["user_misery","",void 0,void 0]},{kind:"function",function:["apdex","",void 0,void 0]},...n.map((e=>({kind:"function",function:["percentile",e,S.GW.toString(),void 0]})))])}(0,i),g=e=>{(0,o.ec)({eventName:"Performance Views: Filter Dropdown",eventKey:"performance_views.filter_dropdown.selection",organization_id:parseInt(n.id,10),action:e});const i={...(0,u.V)(t,[lt.Oo,lt.mo]),...(0,y.bz)(e)};e===y.f1.None&&delete i.breakdown,a.browserHistory.push({pathname:t.pathname,query:i})};return(0,Q.tZ)(l.Z,{eventView:h,orgSlug:n.slug,location:t,transactionThreshold:c,transactionThresholdMetric:p,referrer:"api.performance.transaction-summary",children:({isLoading:e,error:a,tableData:o})=>{var l,c;const p=null!==(l=null==o||null===(c=o.data)||void 0===c?void 0:c[0])&&void 0!==l?l:null;return(0,Q.tZ)(ot,{location:t,organization:n,eventView:i,projectId:r,transactionName:s,isLoading:e,error:a,totalValues:p,onChangeFilter:g,spanOperationBreakdownFilter:m,isMetricsData:d})}})}function ut(e){return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,s.t)("Performance")].join(" - "):[(0,s.t)("Summary"),(0,s.t)("Performance")].join(" - ")}function dt({location:e,transactionName:t,isMetricsData:n}){const i=(0,d.ro)(e.query.query,""),a=new m.MY(i);return n||a.setFilterValues("event.type",["transaction"]),a.setFilterValues("transaction",[t]),Object.keys(a.filters).forEach((e=>{(0,p.h1)(e)&&a.removeFilter(e)})),c.ZP.fromNewQueryWithLocation({id:void 0,version:2,name:t,fields:["id","user.display","transaction.duration","trace","timestamp"],query:a.formatString(),projects:[]},e)}ct.displayName="TransactionOverview",pt.displayName="OverviewContentWrapper";const mt=(0,v.Z)((0,x.Z)((0,g.Z)(ct)))},"./app/views/performance/transactionSummary/transactionSpans/suspectSpansTable.tsx":(e,t,n)=>{n.d(t,{Z:()=>m}),n("../node_modules/core-js/modules/es.symbol.description.js");var i=n("./app/components/gridEditable/index.tsx"),a=n("./app/components/gridEditable/sortLink.tsx"),r=n("./app/components/links/link.tsx"),s=n("./app/locale.tsx"),o=n("./app/utils.tsx"),l=n("./app/utils/discover/fieldRenderers.tsx"),c=n("./app/utils/discover/fields.tsx"),p=n("./app/utils/discover/styles.tsx"),u=n("./app/views/performance/transactionSummary/transactionSpans/types.tsx"),d=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(e){const{location:t,organization:n,transactionName:a,isLoading:r,suspectSpans:s,totals:l,sort:c,project:p}=e,u=s.map((e=>({operation:e.op,group:e.group,description:e.description,totalCount:e.count,frequency:(0,o.ri)(e.frequency)&&(0,o.ri)(null==l?void 0:l.count)?e.frequency/l.count:null,avgOccurrences:e.avgOccurrences,p50ExclusiveTime:e.p50ExclusiveTime,p75ExclusiveTime:e.p75ExclusiveTime,p95ExclusiveTime:e.p95ExclusiveTime,p99ExclusiveTime:e.p99ExclusiveTime,sumExclusiveTime:e.sumExclusiveTime})));return(0,d.tZ)(i.ZP,{isLoading:r,data:u,columnOrder:v[c].map((e=>x[e])),columnSortBy:[],grid:{renderHeadCell:h,renderBodyCell:g(t,n,a,p)},location:t})}function h(e,t){const n=(0,c.qG)(e.key,f[e.key]);return(0,d.tZ)(a.Z,{title:e.name,align:n,direction:void 0,canSort:!1,generateSortLink:()=>{}})}function g(e,t,n,i){return(a,o)=>{const c=(0,l.Js)(a.key,f);if("description"===a.key){var u;const l=function({orgSlug:e,transaction:t,query:n,spanSlug:i,projectID:a}){return{pathname:function({orgSlug:e,spanSlug:t}){return"/organizations/".concat(e,"/performance/summary/spans/").concat(t.op,":").concat(t.group,"/")}({orgSlug:e,spanSlug:i}),query:{transaction:t,project:a,environment:n.environment,statsPeriod:n.statsPeriod,start:n.start,end:n.end,query:n.query}}}({orgSlug:t.slug,transaction:n,query:e.query,spanSlug:{op:o.operation,group:o.group},projectID:null==i?void 0:i.id});return(0,d.tZ)(p.W2,{children:(0,d.tZ)(r.Z,{to:l,children:null!==(u=o[a.key])&&void 0!==u?u:(0,s.t)("(unnamed span)")})})}return c(o,{location:e,organization:t})}}m.displayName="SuspectSpansTable",h.displayName="renderHeadCell";const v={[u.g.COUNT]:["operation","description","totalCount","frequency","p75ExclusiveTime","sumExclusiveTime"],[u.g.AVG_OCCURRENCE]:["operation","description","avgOccurrences","frequency","p75ExclusiveTime","sumExclusiveTime"],[u.g.SUM_EXCLUSIVE_TIME]:["operation","description","totalCount","frequency","p75ExclusiveTime","sumExclusiveTime"],[u.p.P50_EXCLUSIVE_TIME]:["operation","description","totalCount","frequency","p50ExclusiveTime","sumExclusiveTime"],[u.p.P75_EXCLUSIVE_TIME]:["operation","description","totalCount","frequency","p75ExclusiveTime","sumExclusiveTime"],[u.p.P95_EXCLUSIVE_TIME]:["operation","description","totalCount","frequency","p95ExclusiveTime","sumExclusiveTime"],[u.p.P99_EXCLUSIVE_TIME]:["operation","description","totalCount","frequency","p99ExclusiveTime","sumExclusiveTime"]},x={operation:{key:"operation",name:(0,s.t)("Span Operation"),width:i.z7},description:{key:"description",name:(0,s.t)("Span Name"),width:i.z7},totalCount:{key:"totalCount",name:(0,s.t)("Total Count"),width:i.z7},frequency:{key:"frequency",name:(0,s.t)("Frequency"),width:i.z7},avgOccurrences:{key:"avgOccurrences",name:(0,s.t)("Average Occurrences"),width:i.z7},p50ExclusiveTime:{key:"p50ExclusiveTime",name:(0,s.t)("P50 Exclusive Time"),width:i.z7},p75ExclusiveTime:{key:"p75ExclusiveTime",name:(0,s.t)("P75 Exclusive Time"),width:i.z7},p95ExclusiveTime:{key:"p95ExclusiveTime",name:(0,s.t)("P95 Exclusive Time"),width:i.z7},p99ExclusiveTime:{key:"p99ExclusiveTime",name:(0,s.t)("P99 Exclusive Time"),width:i.z7},sumExclusiveTime:{key:"sumExclusiveTime",name:(0,s.t)("Total Exclusive Time"),width:i.z7}},f={operation:"string",description:"string",totalCount:"integer",frequency:"percentage",avgOccurrences:"number",p50ExclusiveTime:"duration",p75ExclusiveTime:"duration",p95ExclusiveTime:"duration",p99ExclusiveTime:"duration",sumExclusiveTime:"duration"}},"./app/views/performance/transactionSummary/transactionVitals/constants.tsx":(e,t,n)=>{n.d(t,{sE:()=>s,GW:()=>o,PE:()=>p,QB:()=>u}),n("../node_modules/core-js/modules/es.array.reverse.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var i=n("./app/utils/discover/fields.tsx"),a=n("./app/utils/performance/vitals/constants.tsx"),r=n("./app/utils/theme.tsx");const s=100,o=.75,l=[{vitals:[i.Zl.FP,i.Zl.FCP,i.Zl.LCP],min:0},{vitals:[i.Zl.FID],min:0,precision:2},{vitals:[i.Zl.CLS],min:0,precision:2}],c=[...r.ZP.charts.getColorPalette(l.reduce(((e,{vitals:t})=>e+t.length),0)-1)].reverse(),p=l.map((e=>({...e,colors:c.splice(0,e.vitals.length)}))),u=l.reduce(((e,{vitals:t})=>(t.forEach((t=>{const n=a.r[t].slug;e.push("".concat(n,"Start")),e.push("".concat(n,"End"))})),e)),[])},"./app/views/performance/vitalDetail/vitalInfo.tsx":(e,t,n)=>{n.d(t,{Z:()=>m}),n("../node_modules/react/index.js");var i=n("./app/utils/metrics/metricsRequest.tsx"),a=n("./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx"),r=n("./app/utils/queryString.tsx"),s=n("./app/utils/tokenizeSearch.tsx"),o=n("./app/utils/useApi.tsx"),l=n("./app/views/performance/landing/vitalsCards.tsx"),c=n("./app/views/performance/landing/widgets/widgets/vitalWidgetMetrics.tsx"),p=n("./app/views/performance/vitalDetail/utils.tsx"),u=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d({orgSlug:e,start:t,end:n,statsPeriod:d,project:m,environment:h,vital:g,location:v,isLoading:x,hideBar:f,hideStates:y,hideVitalPercentNames:Z,hideDurationDetail:w,p75AllTransactions:S,isMetricsData:T}){const b=(0,o.Z)(),E=Array.isArray(g)?g:[g],k={vital:g,showBar:!f,showStates:!y,showVitalPercentNames:!Z,showDurationDetail:!w};if(T){const a=(0,r.ro)(v.query.query,""),o=E.map((e=>"count(".concat(p.T4[e],")")));return(0,u.tZ)(i.Z,{api:b,orgSlug:e,start:t,end:n,statsPeriod:d,project:m,environment:h,field:o,query:new s.MY(a).formatString(),groupBy:["measurement_rating"],children:({loading:e,response:t})=>{const n=E.reduce(((e,n,i)=>(e[n]=(0,c.b)({field:o[i],response:t}),e)),{});return Array.isArray(g)||(n[g].p75=null!=S?S:0),(0,u.tZ)(l.JO,{...k,isLoading:x||e,data:n})}})}return(0,u.tZ)(a.Z,{location:v,vitals:E,children:({isLoading:e,vitalsData:t})=>(0,u.tZ)(l.JO,{...k,isLoading:x||e,data:t})})}d.displayName="VitalInfo";const m=d}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_transactionSummary_transactionOverview_index_tsx.fbe0a2b9819aa470304555c306139967.js.map