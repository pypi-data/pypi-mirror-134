(self.webpackChunk=self.webpackChunk||[]).push([["app_views_issueList_testSessionPercent_tsx"],{"./app/views/issueList/testSessionPercent.tsx":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>P});var o=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),r=s("../node_modules/lodash/range.js"),a=s.n(r),i=s("../node_modules/moment/moment.js"),d=s.n(i),l=s("../node_modules/query-string/index.js"),u=s("./app/components/acl/feature.tsx"),c=s("./app/components/acl/featureDisabled.tsx"),p=s("./app/components/layouts/thirds.tsx"),m=s("./app/components/links/link.tsx"),h=s("./app/locale.tsx"),g=s("./app/utils/dates.tsx"),f=s("./app/utils/discover/eventView.tsx"),v=s("./app/utils/useApi.tsx"),x=s("./app/utils/withOrganization.tsx"),b=s("./app/utils/withPageFilters.tsx"),_=s("./app/views/settings/components/forms/controls/input.tsx"),j=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const y=a()(-1,-168,-1);function Z({params:e,selection:t,organization:s}){const o=(0,v.Z)(),[r,a]=(0,n.useState)("0.1"),[i,u]=(0,n.useState)([]),c={expand:"sessions",display:"sessions",project:t.projects,query:"is:unresolved",sort:"freq"};function x({title:e,id:o,type:n},r){const a=(0,g.v5)(d()().subtract(Math.abs(r-2),"hours").toDate()),i=(0,g.v5)(d()().subtract(Math.abs(r)-3,"hours").toDate()),l={id:void 0,name:e||n,fields:["title","release","environment","user.display","timestamp"],orderby:"-timestamp",query:"issue.id:".concat(o),projects:t.projects,version:2,start:a,end:i};return f.ZP.fromSavedQuery(l).getResultsViewUrlTarget(s.slug)}return(0,n.useEffect)((()=>{(async()=>{for(let t=0;t<y.length;t++){const s=y[t],n=(0,g.v5)(d()().subtract(Math.abs(s),"hours").toDate()),r=(0,g.v5)(d()().subtract(Math.abs(s)-1,"hours").toDate()),a={...c,limit:5,start:n,end:r};let i;try{i=await o.requestPromise("/organizations/".concat(e.orgId,"/issues/"),{method:"GET",data:l.stringify(a)})}catch{i=[]}const p=i.map((e=>e.id));if(0===p.length){u((e=>[...e,[]]));continue}const m={...c,start:n,end:r,groups:p};try{const t=(await o.requestPromise("/organizations/".concat(e.orgId,"/issues-stats/"),{method:"GET",data:l.stringify(m)})).map((e=>({group:i.find((t=>t.id===e.id)),percent:e.sessionCount?Number(e.count)/Number(e.sessionCount)*100:100})));u((e=>[...e,t]))}catch{u((e=>[...e,[]]))}}})()}),[]),(0,j.BX)(n.Fragment,{children:[(0,j.tZ)(p.h4,{children:(0,j.BX)(p.oB,{children:[(0,j.tZ)(p.Dx,{children:(0,h.t)("Session Threshold Percent")}),(0,j.tZ)(S,{type:"text",value:r,onChange:e=>{a(e.target.value)}})]})}),(0,j.tZ)(p.uT,{children:(0,j.tZ)(p.or,{fullWidth:!0,children:y.map(((e,t)=>{const s=i[t],o=void 0===s;return(0,j.BX)(n.Fragment,{children:[(0,j.tZ)("h4",{children:(0,h.tn)("%s hour","%s hours",e)}),(0,j.BX)("ul",{children:[o&&(0,h.t)("Loadingâ€¦"),!o&&s.filter((({percent:e})=>e>parseFloat(r))).map((({group:t,percent:s})=>(0,j.BX)("li",{children:[s.toLocaleString(),"% -"," ",(0,j.tZ)(m.Z,{to:x(t,e),children:t.title})]},t.id)))]})]},t)}))})})]})}function w(e){return(0,j.tZ)(u.Z,{features:["issue-percent-filters"],renderDisabled:e=>(0,j.tZ)(c.Z,{features:e.features,hideHelpToggle:!0}),children:(0,j.tZ)(Z,{...e})})}Z.displayName="SessionPercent",w.displayName="SessionPercentWrapper";const P=(0,b.Z)((0,x.Z)(w)),S=(0,o.Z)(_.Z,{target:"e1vqwjeo0"})({name:"1pzk433",styles:"width:100px"})},"../node_modules/lodash/_baseRange.js":e=>{var t=Math.ceil,s=Math.max;e.exports=function(e,o,n,r){for(var a=-1,i=s(t((o-e)/(n||1)),0),d=Array(i);i--;)d[r?i:++a]=e,e+=n;return d}},"../node_modules/lodash/_createRange.js":(e,t,s)=>{var o=s("../node_modules/lodash/_baseRange.js"),n=s("../node_modules/lodash/_isIterateeCall.js"),r=s("../node_modules/lodash/toFinite.js");e.exports=function(e){return function(t,s,a){return a&&"number"!=typeof a&&n(t,s,a)&&(s=a=void 0),t=r(t),void 0===s?(s=t,t=0):s=r(s),a=void 0===a?t<s?1:-1:r(a),o(t,s,a,e)}}},"../node_modules/lodash/range.js":(e,t,s)=>{var o=s("../node_modules/lodash/_createRange.js")();e.exports=o}}]);
//# sourceMappingURL=../sourcemaps/app_views_issueList_testSessionPercent_tsx.58658c7180907e1f05655bd93ae4051a.js.map