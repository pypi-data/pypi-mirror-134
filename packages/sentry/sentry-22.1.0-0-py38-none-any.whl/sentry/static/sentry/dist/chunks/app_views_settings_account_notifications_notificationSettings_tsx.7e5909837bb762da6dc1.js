"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_account_notifications_notificationSettings_tsx"],{"./app/components/alertLink.tsx":(e,t,s)=>{s.d(t,{Z:()=>d});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/react/index.js"),s("../node_modules/lodash/omit.js")),i=s.n(o),a=s("./app/components/links/externalLink.tsx"),r=s("./app/components/links/link.tsx"),l=s("./app/icons/index.tsx"),c=s("./app/styles/space.tsx"),p=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function u({size:e="normal",priority:t="warning",icon:s,children:n,onClick:o,withoutMarginBottom:i=!1,openInNewTab:a=!1,to:r,href:c,"data-test-id":u}){return(0,p.BX)(m,{"data-test-id":u,to:r,href:c,onClick:o,size:e,priority:t,withoutMarginBottom:i,openInNewTab:a,children:[s&&(0,p.tZ)(f,{children:s}),(0,p.tZ)(g,{children:n}),(0,p.tZ)(h,{children:(0,p.tZ)(l.g6,{direction:"right"})})]})}u.displayName="AlertLink";const d=u,m=(0,n.Z)((({openInNewTab:e,to:t,href:s,...n})=>{const o=i()(n,["withoutMarginBottom","priority","size"]);return s?(0,p.tZ)(a.Z,{...o,href:s,openInNewTab:e}):(0,p.tZ)(r.Z,{...o,to:t||""})}),{target:"ear9tuy3"})("display:flex;background-color:",(e=>e.theme.alert[e.priority].backgroundLight),";color:",(e=>e.theme.textColor),";border:1px dashed ",(e=>e.theme.alert[e.priority].border),";padding:",(e=>"small"===e.size?"".concat((0,c.Z)(1)," ").concat((0,c.Z)(1.5)):(0,c.Z)(2)),";margin-bottom:",(e=>e.withoutMarginBottom?0:(0,c.Z)(3)),";border-radius:0.25em;transition:0.2s border-color;&.focus-visible{outline:none;box-shadow:",(e=>e.theme.alert[e.priority].border),"7f 0 0 0 2px;}"),f=(0,n.Z)("span",{target:"ear9tuy2"})("display:flex;margin:",(0,c.Z)(.5)," ",(0,c.Z)(1.5)," ",(0,c.Z)(.5)," 0;"),h=(0,n.Z)(f,{target:"ear9tuy1"})("margin:",(0,c.Z)(.5)," 0;"),g=(0,n.Z)("div",{target:"ear9tuy0"})({name:"19lh9qo",styles:"line-height:1.5;flex-grow:1"})},"./app/views/settings/account/notifications/constants.tsx":(e,t,s)=>{s.d(t,{Ox:()=>i,Al:()=>a,A4:()=>r,Zb:()=>l,sg:()=>c,cH:()=>p,uJ:()=>u,Y5:()=>d});var n=s("./app/locale.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const i={email:"default",slack:"never"},a={default:0,never:10,always:20,subscribe_only:30,committed_only:40},r=3,l=3,c=100,p=["alerts","workflow","deploy","approval","reports","email"],u=["personalActivityNotifications","selfAssignOnResolve"],d=(0,o.BX)("div",{children:[(0,o.tZ)("p",{style:{marginBottom:"20px"},children:(0,o.tZ)("strong",{children:"Are you sure you want to disable these notifications?"})}),(0,o.tZ)("p",{children:(0,n.t)('Turning this off will irreversibly overwrite all of your fine-tuning settings to "off".')})]})},"./app/views/settings/account/notifications/fields2.tsx":(e,t,s)=>{s.d(t,{u:()=>o});var n=s("./app/locale.tsx");const o={alerts:{name:"alerts",type:"select",label:(0,n.t)("Issue Alerts"),choices:[["always",(0,n.t)("On")],["never",(0,n.t)("Off")]],help:(0,n.t)("Notifications sent from Alert rules that your team has set up.")},workflow:{name:"workflow",type:"select",label:(0,n.t)("Issue Workflow"),choices:[["always",(0,n.t)("On")],["subscribe_only",(0,n.t)("Only Subscribed Issues")],["never",(0,n.t)("Off")]],help:(0,n.t)("Changes in issue assignment, resolution status, and comments.")},deploy:{name:"deploy",type:"select",label:(0,n.t)("Deploys"),choices:[["always",(0,n.t)("On")],["committed_only",(0,n.t)("Only Committed Issues")],["never",(0,n.t)("Off")]],help:(0,n.t)("Release, environment, and commit overviews.")},provider:{name:"provider",type:"select",label:(0,n.t)("Delivery Method"),choices:[["email",(0,n.t)("Send to Email")],["slack",(0,n.t)("Send to Slack")],["email+slack",(0,n.t)("Send to Email and Slack")]]},approval:{name:"approval",type:"select",label:(0,n.t)("Approvals"),choices:[["always",(0,n.t)("On")],["never",(0,n.t)("Off")]],help:(0,n.t)("Notifications from teammates that require review or approval.")},reports:{name:"weekly reports",type:"blank",label:(0,n.t)("Weekly Reports"),help:(0,n.t)("A summary of the past week for an organization.")},email:{name:"email routing",type:"blank",label:(0,n.t)("Email Routing"),help:(0,n.t)("Change the email address that receives notifications.")},personalActivityNotifications:{name:"personalActivityNotifications",type:"boolean",label:(0,n.t)("My Own Activity"),help:(0,n.t)("Notifications about your own actions on Sentry.")},selfAssignOnResolve:{name:"selfAssignOnResolve",type:"boolean",label:(0,n.t)("Claim Unassigned Issues I’ve Resolved"),help:(0,n.t)("You’ll receive notifications about any changes that happen afterwards.")}}},"./app/views/settings/account/notifications/notificationSettings.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.object.from-entries.js"),s("../node_modules/react/index.js")),i=s("./app/components/alertLink.tsx"),a=s("./app/components/asyncComponent.tsx"),r=s("./app/components/links/link.tsx"),l=s("./app/icons/index.tsx"),c=s("./app/locale.tsx"),p=s("./app/utils/withOrganizations.tsx"),u=s("./app/views/settings/account/notifications/constants.tsx"),d=s("./app/views/settings/account/notifications/feedbackAlert.tsx"),m=s("./app/views/settings/account/notifications/fields2.tsx"),f=s("./app/views/settings/account/notifications/utils.tsx"),h=s("./app/views/settings/components/forms/form.tsx"),g=s("./app/views/settings/components/forms/jsonForm.tsx"),v=s("./app/views/settings/components/settingsPageHeader.tsx"),b=s("./app/views/settings/components/text/textBlock.tsx"),y=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class j extends a.Z{constructor(...e){super(...e),(0,n.Z)(this,"getStateToPutForDefault",((e,t)=>{const{notificationSettings:s}=this.state,n=(0,f.zD)(t,s,e,(0,f.Vy)(t,s));return this.setState({notificationSettings:(0,f.r_)(s,n)}),n}))}getDefaultState(){return{...super.getDefaultState(),notificationSettings:{},legacyData:{}}}getEndpoints(){return[["notificationSettings","/users/me/notification-settings/"],["legacyData","/users/me/notifications/"]]}getInitialData(){const{notificationSettings:e}=this.state;return Object.fromEntries(u.cH.map((t=>[t,(0,f._M)(t,e)])))}getFields(){const{notificationSettings:e}=this.state,t=[];for(const s of u.cH){const n=Object.assign({},m.u[s],{getData:e=>this.getStateToPutForDefault(e,s),help:(0,y.tZ)(o.Fragment,{children:(0,y.BX)("p",{children:[m.u[s].help," ",(0,y.tZ)(r.Z,{"data-test-id":"fine-tuning",to:"/settings/account/notifications/".concat(s),children:"Fine tune"})]})})});(0,f.Vi)(s,e)&&"function"!=typeof n&&(n.confirm={never:u.Y5}),t.push(n)}return t}renderBody(){const{legacyData:e}=this.state;return(0,y.BX)(o.Fragment,{children:[(0,y.tZ)(v.Z,{title:"Notifications"}),(0,y.tZ)(b.Z,{children:"Personal notifications sent via email or an integration."}),(0,y.tZ)(d.Z,{}),(0,y.tZ)(h.Z,{saveOnBlur:!0,apiMethod:"PUT",apiEndpoint:"/users/me/notification-settings/",initialData:this.getInitialData(),children:(0,y.tZ)(g.Z,{title:(0,c.t)("Notifications"),fields:this.getFields()})}),(0,y.tZ)(h.Z,{initialData:e,saveOnBlur:!0,apiMethod:"PUT",apiEndpoint:"/users/me/notifications/",children:(0,y.tZ)(g.Z,{title:(0,c.t)("My Activity"),fields:u.uJ.map((e=>m.u[e]))})}),(0,y.tZ)(i.Z,{to:"/settings/account/emails",icon:(0,y.tZ)(l.h,{}),children:(0,c.t)("Looking to add or remove an email address? Use the emails panel.")})]})}}const w=(0,p.Z)(j)},"./app/views/settings/account/notifications/utils.tsx":(e,t,s)=>{s.d(t,{_M:()=>S,hx:()=>A,xy:()=>_,tl:()=>N,gw:()=>T,Vy:()=>D,pV:()=>g,zD:()=>M,O0:()=>C,E2:()=>z,uI:()=>v,iy:()=>E,yB:()=>h,Vi:()=>I,r_:()=>Z,Oi:()=>y}),s("../node_modules/core-js/modules/es.object.from-entries.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.unscopables.flat-map.js");var n=s("../node_modules/lodash/set.js"),o=s.n(n),i=s("./app/locale.tsx"),a=s("./app/views/settings/account/notifications/constants.tsx"),r=s("./app/views/settings/account/notifications/fields2.tsx"),l=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),c=s("./app/components/avatar/index.tsx"),p=s("./app/styles/space.tsx"),u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const d=({notificationType:e,parent:t})=>(0,u.BX)(m,{children:[(0,u.tZ)(c.Z,{[g(e)]:t}),(0,u.tZ)("span",{children:t.slug})]});d.displayName="ParentLabel";const m=(0,l.Z)("div",{target:"e1lcoc5u0"})("display:flex;gap:",(0,p.Z)(.5),";line-height:16px;"),f=d,h=e=>["alerts","email","workflow"].includes(e),g=e=>h(e)?"project":"organization",v=e=>e.reduce(((e,t)=>{const s=t.organization.slug;return e.hasOwnProperty(s)?e[s].projects.push(t):e[s]={organization:t.organization,projects:[t]},e}),{}),b=e=>{switch(e){case"alerts":return"always";case"deploy":return"committed_only";case"workflow":return"subscribe_only";default:return""}},y=e=>e.sort().join("+"),j=(e,t)=>{if(!e)return"default";const s=e.find((e=>e[0]===t));if(!s)throw new Error("Could not find ".concat(t));return s[1]},w=e=>!!Object.keys(e).length&&Object.values(e).every((e=>"never"===e)),x=e=>Object.values(e).reduce(((e,t)=>"never"===t?e:t),null),O=(e,t,s,n)=>{let o;return o="user"===n?w(e)?s:x(e)||s:w(e)?"never":x(e)||"default",Object.fromEntries(Object.keys(a.Ox).map((e=>[e,t.includes(e)?o:"never"])))},Z=(...e)=>{const t={};return e.map((e=>Object.entries(e).map((([e,s])=>Object.entries(s).map((([s,n])=>Object.entries(n).map((([n,i])=>{o()(t,[e,s,n].join("."),i)})))))))),t},k=(e,t)=>{var s;return Object.values((null===(s=t[e])||void 0===s?void 0:s.user)||{}).pop()||Object.fromEntries(Object.entries(a.Ox).map((([t,s])=>[t,"default"===s?b(e):s])))},_=(e,t)=>{const s=k(e,t);return Object.entries(s).filter((([e,t])=>!["never"].includes(t))).map((([e,t])=>e))},A=(e,t)=>{const s=_(e,t);return s.length?k(e,t)[s[0]]:"never"},S=(e,t)=>{var s;const n=(e,t)=>a.Al[e]-a.Al[t],o=Object.values(k(e,t)).sort(n).pop()||"never";if("never"!==o)return o;const i=Object.values((null===(s=t[e])||void 0===s?void 0:s[g(e)])||{}).flatMap((e=>Object.values(e))).sort(n).pop()||"default";return"default"===i?"never":i},E=(e,t)=>["never","default"].includes(S(e,t)),D=(e,t)=>{var s;return Object.keys((null===(s=t[e])||void 0===s?void 0:s[g(e)])||{})},B=(e,t,s)=>{var n,o;return(null===(n=t[e])||void 0===n||null===(o=n[g(e)])||void 0===o?void 0:o[s])||{email:"default"}},N=(e,t,s)=>{const n=_(e,t)[0];return Object.fromEntries(s.map((s=>[s.id,B(e,t,s.id)[n]])))},I=(e,t)=>D(e,t).length>a.A4,z=(e,t,s)=>{const n=s.provider.split("+"),o=b(e);return Object.keys(t).length?{[e]:Object.fromEntries(Object.entries(t[e]).map((([e,t])=>[e,Object.fromEntries(Object.entries(t).map((([t,s])=>[t,O(s,n,o,e)])))])))}:{[e]:{user:{me:Object.fromEntries(n.map((e=>[e,o])))}}}},M=(e,t,s,n)=>{const o=Object.values(s)[0];let i=_(e,t);i.length||(i=["email"]);const a={[e]:{user:{me:Object.fromEntries(i.map((e=>[e,o])))}}};return"never"===o&&(a[e][g(e)]=Object.fromEntries(n.map((e=>[e,Object.fromEntries(i.map((e=>[e,"default"])))])))),a},C=(e,t,s,n)=>{const o=_(e,t),i=Object.values(s)[0];return{[e]:{[g(e)]:{[n]:Object.fromEntries(o.map((e=>[e,i])))}}}},T=(e,t,s,n)=>{var o;const a=r.u[e];return Object.assign({},a,{label:(0,u.tZ)(f,{parent:s,notificationType:e}),getData:e=>n(e,s.id),name:s.id,choices:null===(o=a.choices)||void 0===o?void 0:o.concat([["default","".concat((0,i.t)("Default")," (").concat(j(a.choices,A(e,t)),")")]]),defaultValue:"default",help:void 0})}}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_account_notifications_notificationSettings_tsx.9f8bb52a25e3e4d15468dec0f47544e4.js.map