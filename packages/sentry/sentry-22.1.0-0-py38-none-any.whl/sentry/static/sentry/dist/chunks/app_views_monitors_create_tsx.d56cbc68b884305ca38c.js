"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_monitors_create_tsx"],{"./app/views/asyncView.tsx":(e,t,s)=>{s.d(t,{Z:()=>r}),s("../node_modules/react/index.js");var n=s("./app/components/asyncComponent.tsx"),i=s("./app/components/sentryDocumentTitle.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class r extends n.Z{getTitle(){return""}render(){return(0,o.tZ)(i.Z,{title:this.getTitle(),children:this.renderComponent()})}}r.displayName="AsyncView"},"./app/views/monitors/create.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>c});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),o=s("../node_modules/react-router/es/index.js"),r=s("./app/views/asyncView.tsx"),a=s("./app/views/monitors/monitorForm.tsx"),l=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class c extends r.Z{constructor(...e){super(...e),(0,n.Z)(this,"onSubmitSuccess",(e=>{o.browserHistory.push("/organizations/".concat(this.props.params.orgId,"/monitors/").concat(e.id,"/"))}))}getTitle(){return"Monitors - ".concat(this.props.params.orgId)}renderBody(){return(0,l.BX)(i.Fragment,{children:[(0,l.tZ)("h1",{children:"New Monitor"}),(0,l.tZ)(a.Z,{apiMethod:"POST",apiEndpoint:"/organizations/".concat(this.props.params.orgId,"/monitors/"),onSubmitSuccess:this.onSubmitSuccess})]})}}},"./app/views/monitors/monitorForm.tsx":(e,t,s)=>{s.d(t,{Z:()=>_});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),o=s("../node_modules/mobx-react-lite/es/index.js"),r=s("./app/components/acl/access.tsx"),a=s("./app/components/panels/index.tsx"),l=s("./app/locale.tsx"),c=s("./app/utils/withPageFilters.tsx"),d=s("./app/utils/withProjects.tsx"),u=s("./app/views/settings/components/forms/field/index.tsx"),m=s("./app/views/settings/components/forms/form.tsx"),p=s("./app/views/settings/components/forms/numberField.tsx"),h=s("./app/views/settings/components/forms/selectField.tsx"),g=s("./app/views/settings/components/forms/textCopyInput.tsx"),f=s("./app/views/settings/components/forms/textField.tsx"),b=(s("../node_modules/core-js/modules/web.url.to-json.js"),s("./app/views/settings/components/forms/model.tsx"));class x extends b.Z{getTransformedData(){return this.fields.toJSON().reduce(((e,[t,s])=>0!==t.indexOf("config.")?(e[t]=s,e):(e.config||(e.config={}),"config.schedule.frequency"!==t&&"config.schedule.interval"!==t||Array.isArray(e.config.schedule)||(e.config.schedule=[null,null]),"config.schedule.frequency"===t?e.config.schedule[0]=parseInt(s,10):"config.schedule.interval"===t?e.config.schedule[1]=s:e.config[t.substr(7)]=s,e)),{})}getTransformedValue(e){return 0===e.indexOf("config")?this.getValue(e):super.getTransformedValue(e)}}var w=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const Z=[{value:"crontab",label:"Crontab"},{value:"interval",label:"Interval"}],j=[{value:"cron_job",label:"Cron Job"}],y=[{value:"minute",label:"minute(s)"},{value:"hour",label:"hour(s)"},{value:"day",label:"day(s)"},{value:"week",label:"week(s)"},{value:"month",label:"month(s)"},{value:"year",label:"year(s)"}];class v extends i.Component{constructor(...e){super(...e),(0,n.Z)(this,"form",new x)}formDataFromConfig(e,t){const s={};switch(e){case"cron_job":switch(s["config.schedule_type"]=t.schedule_type,s["config.checkin_margin"]=t.checkin_margin,s["config.max_runtime"]=t.max_runtime,t.schedule_type){case"interval":s["config.schedule.frequency"]=t.schedule[0],s["config.schedule.interval"]=t.schedule[1];break;case"crontab":default:s["config.schedule"]=t.schedule}}return s}render(){const{monitor:e}=this.props,t=this.props.selection.projects[0],s=t?this.props.projects.find((e=>e.id===t+"")):null;return(0,w.tZ)(r.Z,{access:["project:write"],children:({hasAccess:t})=>(0,w.BX)(m.Z,{allowUndo:!0,requireChanges:!0,apiEndpoint:this.props.apiEndpoint,apiMethod:this.props.apiMethod,model:this.form,initialData:e?{name:e.name,type:e.type,project:e.project.slug,...this.formDataFromConfig(e.type,e.config)}:{project:s?s.slug:null},onSubmitSuccess:this.props.onSubmitSuccess,children:[(0,w.BX)(a.s_,{children:[(0,w.tZ)(a.V9,{children:(0,l.t)("Details")}),(0,w.BX)(a.N,{children:[e&&(0,w.tZ)(u.Z,{label:(0,l.t)("ID"),children:(0,w.tZ)("div",{className:"controls",children:(0,w.tZ)(g.Z,{children:e.id})})}),(0,w.tZ)(h.Z,{name:"project",label:(0,l.t)("Project"),disabled:!t,options:this.props.projects.filter((e=>e.isMember)).map((e=>({value:e.slug,label:e.slug}))),required:!0}),(0,w.tZ)(f.Z,{name:"name",placeholder:(0,l.t)("My Cron Job"),label:(0,l.t)("Name"),disabled:!t,required:!0})]})]}),(0,w.BX)(a.s_,{children:[(0,w.tZ)(a.V9,{children:(0,l.t)("Config")}),(0,w.BX)(a.N,{children:[(0,w.tZ)(h.Z,{name:"type",label:(0,l.t)("Type"),disabled:!t,options:j,required:!0}),(0,w.tZ)(o.Qj,{children:()=>{switch(this.form.getValue("type")){case"cron_job":return(0,w.BX)(i.Fragment,{children:[(0,w.tZ)(p.Z,{name:"config.max_runtime",label:(0,l.t)("Max Runtime"),disabled:!t,help:(0,l.t)("The maximum runtime (in minutes) a check-in is allowed before it's marked as a failure."),placeholder:"e.g. 30"}),(0,w.tZ)(h.Z,{name:"config.schedule_type",label:(0,l.t)("Schedule Type"),disabled:!t,options:Z,required:!0})]});default:return null}}}),(0,w.tZ)(o.Qj,{children:()=>{switch(this.form.getValue("config.schedule_type")){case"crontab":return(0,w.BX)(i.Fragment,{children:[(0,w.tZ)(f.Z,{name:"config.schedule",label:(0,l.t)("Schedule"),disabled:!t,placeholder:"*/5 * * * *",required:!0,help:(0,l._N)("Changes to the schedule will apply on the next check-in. See [link:Wikipedia] for crontab syntax.",{link:(0,w.tZ)("a",{href:"https://en.wikipedia.org/wiki/Cron"})})}),(0,w.tZ)(p.Z,{name:"config.checkin_margin",label:(0,l.t)("Check-in Margin"),disabled:!t,help:(0,l.t)("The margin (in minutes) a check-in is allowed to exceed it's scheduled window before being treated as missed."),placeholder:"e.g. 30"})]});case"interval":return(0,w.BX)(i.Fragment,{children:[(0,w.tZ)(p.Z,{name:"config.schedule.frequency",label:(0,l.t)("Frequency"),disabled:!t,placeholder:"e.g. 1",required:!0}),(0,w.tZ)(h.Z,{name:"config.schedule.interval",label:(0,l.t)("Interval"),disabled:!t,options:y,required:!0}),(0,w.tZ)(p.Z,{name:"config.checkin_margin",label:(0,l.t)("Check-in Margin"),disabled:!t,help:(0,l.t)("The margin (in minutes) a check-in is allowed to exceed it's scheduled window before being treated as missed."),placeholder:"e.g. 30"})]});default:return null}}})]})]})]})})}}v.displayName="MonitorForm";const _=(0,c.Z)((0,d.Z)(v))}}]);
//# sourceMappingURL=../sourcemaps/app_views_monitors_create_tsx.d6d4f6cb054e3b23f7e1af3a23d3b11b.js.map