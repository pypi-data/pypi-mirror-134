"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_performance_landing_widgets_transforms_transformMetricsToArea_tsx-app_views_perform-b9f920"],{"./app/utils/metrics/getMetricsDataSource.tsx":(t,e,a)=>{a.d(e,{P:()=>r});var i=a("./app/utils/localStorage.tsx");function r(){const t=i.Z.getItem("metrics.datasource");if(t&&["snuba","mock"].includes(t))return t}},"./app/utils/metrics/metricsRequest.tsx":(t,e,a)=>{a.d(e,{Z:()=>v});var i=a("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(a("../node_modules/core-js/modules/web.dom-collections.iterator.js"),a("../node_modules/react/index.js")),s=a("../node_modules/lodash/isEqual.js"),o=a.n(s),n=a("../node_modules/lodash/omitBy.js"),l=a.n(n),d=a("./app/actionCreators/indicator.tsx"),c=a("./app/components/charts/utils.tsx"),p=a("./app/constants/index.tsx"),u=a("./app/locale.tsx"),m=a("./app/utils/getPeriod.tsx"),g=a("./app/utils/metrics/getMetricsDataSource.tsx");const h=["api","children"],_=t=>l()(t,((t,e)=>h.includes(e)));class S extends r.Component{constructor(...t){super(...t),(0,i.Z)(this,"state",{reloading:!1,errored:!1,response:null,responsePrevious:null}),(0,i.Z)(this,"unmounting",!1),(0,i.Z)(this,"fetchData",(async()=>{const{api:t,isDisabled:e,start:a,end:i,statsPeriod:r,includePrevious:s}=this.props;if(e)return;this.setState((t=>({reloading:null!==t.response,errored:!1})));const o=[t.requestPromise(this.path,{query:this.baseQueryParams()})];(0,c.DC)({start:a,end:i,period:r,includePrevious:s})&&o.push(t.requestPromise(this.path,{query:this.baseQueryParams({previousPeriod:!0})}));try{const[t,e]=await Promise.all(o);if(this.unmounting)return;this.setState({reloading:!1,response:t,responsePrevious:null!=e?e:null})}catch(t){var n,l;(0,d.Iw)(null!==(n=null===(l=t.responseJSON)||void 0===l?void 0:l.detail)&&void 0!==n?n:(0,u.t)("Error loading metrics data")),this.setState({reloading:!1,errored:!0})}}))}componentDidMount(){this.fetchData()}componentDidUpdate(t){o()(_(t),_(this.props))||this.fetchData()}componentWillUnmount(){this.unmounting=!0}get path(){const{orgSlug:t}=this.props;return"/organizations/".concat(t,"/metrics/data/")}baseQueryParams({previousPeriod:t=!1}={}){const{project:e,environment:a,field:i,query:r,groupBy:s,orderBy:o,limit:n,interval:l}=this.props,{start:d,end:u,statsPeriod:h}=(0,m.X)({period:this.props.statsPeriod,start:this.props.start,end:this.props.end}),_={project:e,environment:a,field:i,query:r||void 0,groupBy:s,orderBy:o,limit:n,interval:l||(0,c.ZS)({start:d,end:u,period:h}),datasource:(0,g.P)()};if(!t)return{..._,statsPeriod:h,start:d,end:u};const S=(0,m.X)({period:h,start:void 0,end:void 0},{shouldDoublePeriod:!0}).statsPeriod;return{..._,statsPeriodStart:S,statsPeriodEnd:null!=h?h:p.GY}}render(){const{reloading:t,errored:e,response:a,responsePrevious:i}=this.state,{children:r,isDisabled:s}=this.props;return null==r?void 0:r({loading:null===a&&!s,reloading:t,errored:e,response:a,responsePrevious:i})}}S.displayName="MetricsRequest",(0,i.Z)(S,"defaultProps",{includePrevious:!1});const v=S},"./app/views/performance/landing/widgets/components/performanceWidget.tsx":(t,e,a)=>{a.d(e,{I:()=>P});var i=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(a("../node_modules/core-js/modules/web.dom-collections.iterator.js"),a("../node_modules/react/index.js")),s=a("../node_modules/react-router/es/index.js"),o=a("./app/components/charts/errorPanel.tsx"),n=a("./app/components/placeholder.tsx"),l=a("./app/icons/iconWarning.tsx"),d=a("./app/styles/space.tsx"),c=a("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),p=a("./app/utils/useApi.tsx"),u=a("./app/components/panels/index.tsx");const m=(0,i.Z)(u.s_,{target:"e1evmidq1"})("padding-top:",(0,d.Z)(2),";margin-bottom:0;"),g=(0,i.Z)("div",{target:"e1evmidq0"})("");var h=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function _(t){return t.isErrored?t.errorComponent:t.isLoading&&t.loadingComponent?t.loadingComponent:t.hasData?(0,h.tZ)(r.Fragment,{children:t.dataComponents}):t.emptyComponent}_.displayName="DataStateSwitch";var S=a("./app/utils/dates.tsx");function v(t){var e;const a=null!==(e=t.children)&&void 0!==e?e:(0,h.tZ)(r.Fragment,{});return t.queries.length?(0,h.tZ)(r.Fragment,{children:t.queries.filter((e=>!e.enabled||e.enabled(t.widgetData))).map((e=>(0,h.tZ)(f,{...t,query:e},e.queryKey)))}):(0,h.tZ)(r.Fragment,{children:a})}function f(t){const e=t.query,a=t.queryProps.eventView.getPageFilters(),i=a.datetime.start?(0,S.hC)(a.datetime.start):null,s=a.datetime.end?(0,S.hC)(a.datetime.end):null;return(0,r.useEffect)((()=>()=>{t.removeWidgetDataForKey(e.queryKey)}),[]),(0,h.tZ)(e.component,{fields:e.fields,yAxis:e.fields,start:i,end:s,period:a.datetime.period,project:a.projects,environment:a.environments,organization:t.queryProps.organization,orgSlug:t.queryProps.organization.slug,eventView:t.queryProps.eventView,query:t.queryProps.eventView.getQueryWithAdditionalConditions(),widgetData:t.widgetData,children:a=>(0,h.tZ)(r.Fragment,{children:(0,h.tZ)(T,{results:a,...t,query:e})})},e.queryKey)}function T(t){const{results:e,query:a}=t,i=a.transform(t.queryProps,e,t.query);return(0,r.useEffect)((()=>{t.setWidgetDataForKey(a.queryKey,i)}),[null==i?void 0:i.hasData,null==i?void 0:i.isLoading,null==i?void 0:i.isErrored]),(0,h.tZ)(r.Fragment,{})}v.displayName="QueryHandler",f.displayName="SingleQueryHandler",T.displayName="QueryResultSaver";var A=a("./app/components/charts/styles.tsx"),y=a("./app/components/questionTooltip.tsx");function R(t){const{title:e,titleTooltip:a,Subtitle:i,HeaderActions:r}=t;return(0,h.BX)(E,{children:[(0,h.BX)(w,{children:[(0,h.tZ)("div",{children:(0,h.BX)(x,{"data-test-id":"performance-widget-title",children:[(0,h.tZ)("div",{className:"truncate",children:e}),(0,h.tZ)(y.Z,{position:"top",size:"sm",title:a})]})}),(0,h.tZ)("div",{children:i?(0,h.tZ)(i,{...t}):null})]}),r&&(0,h.tZ)(Z,{children:r&&(0,h.tZ)(r,{...t})})]})}R.displayName="WidgetHeader";const x=(0,i.Z)(A.ws,{target:"evi51ay3"})({name:"ld8wu3",styles:"position:relative;z-index:initial"}),w=(0,i.Z)("div",{target:"evi51ay2"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"}),E=(0,i.Z)("div",{target:"evi51ay1"})({name:"1eoy87d",styles:"display:flex;justify-content:space-between"}),Z=(0,i.Z)("div",{target:"evi51ay0"})("display:flex;gap:",(0,d.Z)(1),";");function P(t){var e;const[a,i]=(0,r.useState)({}),s=null!==(e=a[t.chartSetting])&&void 0!==e?e:{},o=(0,r.useRef)(s),n=(0,r.useCallback)(((e,a)=>{const r={...o.current,[e]:a};o.current=r,i({[t.chartSetting]:r})}),[a,i]),l=(0,r.useCallback)((e=>{const a={...o.current};delete a[e],o.current=a,i({[t.chartSetting]:a})}),[a,i]),d={widgetData:s,setWidgetDataForKey:n,removeWidgetDataForKey:l},c=Object.entries(t.Queries).map((([t,e])=>({...e,queryKey:t}))),u=(0,p.Z)(),m=t.Visualizations.reduce(((t,e)=>t+e.height),0);return(0,h.BX)(r.Fragment,{children:[(0,h.tZ)(v,{eventView:t.eventView,widgetData:s,setWidgetDataForKey:n,removeWidgetDataForKey:l,queryProps:t,queries:c,api:u}),(0,h.tZ)(O,{...t,...d,totalHeight:m})]})}function O(t){const{Visualizations:e,chartHeight:a,totalHeight:i,containerType:r,EmptyComponent:s}=t,o=(({containerType:t})=>"panel"===t?m:g)({containerType:r}),l=Object.keys(t.Queries).length,d=Object.values(t.widgetData).length!==l,p=!d&&Object.values(t.widgetData).every((t=>!t||t.hasData)),u=Object.values(t.widgetData).some((t=>!t||t.isLoading)),S=!d&&Object.values(t.widgetData).some((t=>t&&t.isErrored));return(0,h.BX)(o,{"data-test-id":"performance-widget-container",children:[(0,h.tZ)(N,{children:(0,h.tZ)(R,{...t})}),(0,h.tZ)(_,{isLoading:u,isErrored:S,hasData:p,errorComponent:(0,h.tZ)(D,{height:i}),dataComponents:e.map(((e,i)=>(0,h.tZ)(N,{noPadding:e.noPadding,bottomPadding:e.bottomPadding,"data-test-id":"widget-state-has-data",onClick:()=>{return e=t.chartSetting,a=t.organization,void(0,c.Z)("performance_views.landingv3.widget.interaction",{organization:a,widget_type:e});var e,a},children:(0,h.tZ)(e.component,{grid:C,queryFields:e.fields,widgetData:t.widgetData,height:a})},i))),loadingComponent:(0,h.tZ)(n.Z,{height:"".concat(i,"px")}),emptyComponent:s?(0,h.tZ)(s,{}):(0,h.tZ)(n.Z,{height:"".concat(i,"px")})})]})}P.displayName="GenericPerformanceWidget",O.displayName="_DataDisplay",(0,s.withRouter)(O);const D=t=>(0,h.tZ)(o.Z,{"data-test-id":"widget-state-is-errored",height:"".concat(t.height,"px"),children:(0,h.tZ)(l.F,{color:"gray300",size:"lg"})});D.displayName="DefaultErrorComponent";const C={left:(0,d.Z)(0),right:(0,d.Z)(0),top:(0,d.Z)(2),bottom:(0,d.Z)(0)},N=(0,i.Z)("div",{target:"eqcpc8s0"})("padding-left:",(t=>t.noPadding?(0,d.Z)(0):(0,d.Z)(2)),";padding-right:",(t=>t.noPadding?(0,d.Z)(0):(0,d.Z)(2)),";padding-bottom:",(t=>t.bottomPadding?(0,d.Z)(1):(0,d.Z)(0)),";");P.defaultProps={containerType:"panel",chartHeight:200}},"./app/views/performance/landing/widgets/components/selectableList.tsx":(t,e,a)=>{a.d(e,{ZP:()=>g,S$:()=>_,QE:()=>S,qL:()=>v,xq:()=>f,Nm:()=>T});var i=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=a("./app/components/emptyStateWarning.tsx"),s=a("./app/components/links/link.tsx"),o=a("./app/components/radio.tsx"),n=a("./app/components/tooltip.tsx"),l=a("./app/icons/index.tsx"),d=a("./app/locale.tsx"),c=a("./app/styles/space.tsx"),p=a("./app/views/settings/components/forms/controls/radioGroup.tsx"),u=a("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),m=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function g(t){return(0,m.tZ)("div",{children:t.items.map(((e,a)=>(0,u.az)(h,{...t,isSelected:a===t.selectedIndex,currentIndex:a,key:a},e())))})}function h({isSelected:t,currentIndex:e,children:a,setSelectedIndex:i,radioColor:r}){return(0,m.BX)(w,{children:[(0,m.tZ)(E,{color:null!=r?r:"",children:(0,m.tZ)(p.V,{index:e,role:"radio",children:(0,m.tZ)(o.Z,{checked:t,onChange:()=>i(e)})})}),a]})}g.displayName="SelectableList",h.displayName="SelectableItem";const _=(0,i.Z)("div",{target:"e1fgyx4u8"})({name:"a329t8",styles:"text-align:right;display:flex;align-items:center;justify-content:center"}),S=(0,i.Z)("span",{target:"e1fgyx4u7"})("color:",(t=>t.theme.gray300),";font-size:",(t=>t.theme.fontSizeMedium),";min-height:24px;display:inline-block;"),v=(0,i.Z)(s.Z,{target:"e1fgyx4u6"})({name:"1ff36h2",styles:"flex-grow:1"}),f=()=>(0,m.tZ)(x,{small:!0,children:(0,d.t)("No results")});function T(t){return(0,m.tZ)(y,{children:(0,m.tZ)(A,{title:(0,d.t)("Exclude this transaction from the search filter."),children:(0,m.tZ)(R,{onClick:()=>{t.onClick(),t.setSelectListIndex(0)}})})})}f.displayName="WidgetEmptyStateWarning",T.displayName="ListClose";const A=(0,i.Z)(n.Z,{target:"e1fgyx4u5"})({name:"1wnowod",styles:"display:flex;align-items:center;justify-content:center"}),y=(0,i.Z)("div",{target:"e1fgyx4u4"})("display:flex;align-items:center;justify-content:center;padding-left:",(0,c.Z)(1),";"),R=(0,i.Z)(l.bM,{target:"e1fgyx4u3"})("cursor:pointer;color:",(t=>t.theme.gray200),";&:hover{color:",(t=>t.theme.gray300),";}"),x=(0,i.Z)(r.Z,{target:"e1fgyx4u2"})({name:"1t1oqhu",styles:"min-height:300px;justify-content:center"}),w=(0,i.Z)("div",{target:"e1fgyx4u1"})("display:flex;border-top:1px solid ",(t=>t.theme.border),";padding:",(0,c.Z)(1)," ",(0,c.Z)(2),";font-size:",(t=>t.theme.fontSizeMedium),";"),E=(0,i.Z)("div",{target:"e1fgyx4u0"})("grid-row:1/3;input{cursor:pointer;}input:checked::after{background-color:",(t=>t.color),";}")},"./app/views/performance/landing/widgets/transforms/transformDiscoverToList.tsx":(t,e,a)=>{a.d(e,{_:()=>o});var i=a("./app/components/organizations/pageFilters/parse.tsx"),r=a("./app/utils.tsx"),s=a("./app/views/performance/data.tsx");function o(t,e,a){var o,n;const{start:l,end:d,utc:c,interval:p,statsPeriod:u}=(0,i.fK)(t.location.query,{defaultStatsPeriod:s.GY}),m=null!==(o=null===(n=e.tableData)||void 0===n?void 0:n.data)&&void 0!==o?o:[];return{...e,isErrored:!!e.error,hasData:(0,r.ri)(m)&&!!m.length,data:m,utc:"true"===c,interval:p,statsPeriod:null!=u?u:void 0,start:null!=l?l:"",end:null!=d?d:""}}},"./app/views/performance/landing/widgets/transforms/transformMetricsToArea.tsx":(t,e,a)=>{a.d(e,{g:()=>m});var i=a("../node_modules/lodash/mean.js"),r=a.n(i),s=a("../node_modules/moment/moment.js"),o=a.n(s),n=a("./app/components/organizations/pageFilters/parse.tsx"),l=a("./app/utils.tsx"),d=a("./app/utils/discover/charts.tsx"),c=a("./app/utils/discover/fields.tsx"),p=a("./app/views/performance/landing/widgets/widgetDefinitions.tsx");const u=["ok","unknown","cancelled"];function m(t,e){const{location:a,fields:i,chartSetting:s}=t,{start:m,end:g,utc:h,interval:_,statsPeriod:S}=(0,n.fK)(a.query),{errored:v,loading:f,reloading:T,response:A,responsePrevious:y}=e,R={loading:f,reloading:T,isLoading:f||T,isErrored:v,utc:"true"===h,interval:_,statsPeriod:null!=S?S:void 0,start:null!=m?m:"",end:null!=g?g:""};if(!A)return{...R,hasData:!1,data:[],dataMean:void 0,previousData:void 0};const x=i[0],w=s===p.s.FAILURE_RATE_AREA,E=w?A.groups.filter((t=>!u.includes(t.by["transaction.status"]))):A.groups,Z=w?A.intervals.map(((t,e)=>A.groups.reduce(((t,a)=>{var i;return t+(null!==(i=a.series[x][e])&&void 0!==i?i:0)}),0))):void 0,P=E.map((t=>{const e=A.intervals.map(((e,a)=>{const i=t.series[x][a],r=null==Z?void 0:Z[a];return{name:o()(e).valueOf(),value:(0,l.ri)(r)&&(0,l.ri)(i)&&i>0&&r>0?i/r:i}}));return{seriesName:x,totals:t.totals[x],data:e.some((t=>(0,l.ri)(t.value)))?e:[]}})),O=w?A.groups.reduce(((t,e)=>{var a;return t+(null!==(a=e.totals[x])&&void 0!==a?a:0)}),0):void 0,D=P.map((t=>{let e;if((0,l.ri)(O)&&(0,l.ri)(t.totals)&&t.totals>0&&O>0)e=t.totals/O;else{const a=t.data.filter((({value:t})=>(0,l.ri)(t))).map((({value:t})=>t));a.length>0&&(e=r()(a))}const a=(0,l.ri)(O)?"failure_rate()":t.seriesName;return{mean:e,outputType:(0,c.Px)(a),label:(0,l.ri)(e)?(0,d.gu)(e,a):void 0}})),C=w?null==y?void 0:y.groups.filter((t=>!u.includes(t.by["transaction.status"]))):null==y?void 0:y.groups,N=w?null==y?void 0:y.intervals.map(((t,e)=>null==y?void 0:y.groups.reduce(((t,a)=>{var i;return t+(null!==(i=a.series[x][e])&&void 0!==i?i:0)}),0))):void 0,I=null==C?void 0:C.map((t=>{const e=null==A?void 0:A.intervals.map(((e,a)=>{const i=t.series[x][a],r=null==N?void 0:N[a];return{name:o()(e).valueOf(),value:(0,l.ri)(r)&&(0,l.ri)(i)&&i>0&&r>0?i/r:i}}));return{seriesName:"previous ".concat(x),stack:"previous",data:e.some((t=>(0,l.ri)(t.value)))?e:[]}}));return{...R,hasData:(0,l.ri)(P)&&!!P.length&&!!P[0].data.length,data:P,dataMean:D,previousData:null!=I?I:void 0}}},"./app/views/performance/landing/widgets/transforms/transformMetricsToList.tsx":(t,e,a)=>{a.d(e,{P:()=>o});var i=a("./app/components/organizations/pageFilters/parse.tsx"),r=a("./app/utils.tsx"),s=a("./app/views/performance/data.tsx");function o(t,e,a){var o,n;const{start:l,end:d,utc:c,interval:p,statsPeriod:u}=(0,i.fK)(t.location.query,{defaultStatsPeriod:s.GY}),{errored:m,loading:g,reloading:h,response:_}=e,S=null!==(o=null===(n=e.response)||void 0===n?void 0:n.groups.map((t=>({...t.by,...t.totals}))))&&void 0!==o?o:[];return{loading:g,reloading:h,isLoading:g||h,isErrored:m,hasData:(0,r.ri)(_)&&!!_.groups.length,data:S,utc:"true"===c,interval:p,statsPeriod:null!=u?u:void 0,start:null!=l?l:"",end:null!=d?d:""}}},"./app/views/performance/landing/widgets/types.tsx":(t,e,a)=>{let i,r;a.d(e,{A:()=>r}),function(t){t.ERROR="error",t.LOADING="loading",t.EMPTY="empty",t.DATA="data"}(i||(i={})),function(t){t.histogram="histogram",t.area="area",t.vitals="vitals",t.line_list="line_list",t.trends="trends"}(r||(r={}))},"./app/views/performance/landing/widgets/utils.tsx":(t,e,a)=>{a.d(e,{CJ:()=>r,rp:()=>l,zM:()=>d});var i=a("./app/views/performance/landing/widgets/widgetDefinitions.tsx");const r=["children","organization","yAxis","period","start","end","environment","project"],s="landing-chart-container",o=(t,e,a)=>"landing-chart-container#".concat(e,"#").concat(a,"#").concat(t);function n(){return JSON.parse(localStorage.getItem(s)||"{}")}const l=(t,e,a,r,s)=>{if(s)return r;const l=o(t,a,e),d=n(),c=null==d?void 0:d[l];return c&&Object.values(i.s).includes(c)?c:r},d=(t,e,a,i)=>{const r=o(t,a,e),l=n();l[r]=i,function(t){localStorage.setItem(s,JSON.stringify(t))}(l)}},"./app/views/performance/landing/widgets/widgetDefinitions.tsx":(t,e,a)=>{a.d(e,{s:()=>l,W:()=>c});var i=a("./app/constants/chartPalette.tsx"),r=a("./app/locale.tsx"),s=a("./app/utils/metrics/fields.tsx"),o=a("./app/views/performance/data.tsx"),n=a("./app/views/performance/landing/widgets/types.tsx");let l;!function(t){t.DURATION_HISTOGRAM="duration_histogram",t.LCP_HISTOGRAM="lcp_histogram",t.FCP_HISTOGRAM="fcp_histogram",t.FID_HISTOGRAM="fid_histogram",t.APDEX_AREA="apdex_area",t.P50_DURATION_AREA="p50_duration_area",t.P75_DURATION_AREA="p75_duration_area",t.P95_DURATION_AREA="p95_duration_area",t.P99_DURATION_AREA="p99_duration_area",t.P75_LCP_AREA="p75_lcp_area",t.TPM_AREA="tpm_area",t.FAILURE_RATE_AREA="failure_rate_area",t.USER_MISERY_AREA="user_misery_area",t.WORST_LCP_VITALS="worst_lcp_vitals",t.WORST_FCP_VITALS="worst_fcp_vitals",t.WORST_CLS_VITALS="worst_cls_vitals",t.WORST_FID_VITALS="worst_fid_vitals",t.MOST_IMPROVED="most_improved",t.MOST_REGRESSED="most_regressed",t.MOST_RELATED_ERRORS="most_related_errors",t.MOST_RELATED_ISSUES="most_related_issues",t.SLOW_HTTP_OPS="slow_http_ops",t.SLOW_DB_OPS="slow_db_ops",t.SLOW_RESOURCE_OPS="slow_resource_ops",t.SLOW_BROWSER_OPS="slow_browser_ops",t.COLD_STARTUP_AREA="cold_startup_area",t.WARM_STARTUP_AREA="warm_startup_area",t.SLOW_FRAMES_AREA="slow_frames_area",t.FROZEN_FRAMES_AREA="frozen_frames_area",t.MOST_SLOW_FRAMES="most_slow_frames",t.MOST_FROZEN_FRAMES="most_frozen_frames"}(l||(l={}));const d=i.Z[5],c=({organization:t,isMetricsData:e})=>({[l.DURATION_HISTOGRAM]:{title:(0,r.t)("Duration Distribution"),titleTooltip:(0,o.$r)(t,o.V$.DURATION_DISTRIBUTION),fields:["transaction.duration"],dataType:n.A.histogram,chartColor:d[5]},[l.LCP_HISTOGRAM]:{title:(0,r.t)("LCP Distribution"),titleTooltip:(0,o.$r)(t,o.V$.DURATION_DISTRIBUTION),fields:["measurements.lcp"],dataType:n.A.histogram,chartColor:d[5]},[l.FCP_HISTOGRAM]:{title:(0,r.t)("FCP Distribution"),titleTooltip:(0,o.$r)(t,o.V$.DURATION_DISTRIBUTION),fields:["measurements.fcp"],dataType:n.A.histogram,chartColor:d[5]},[l.FID_HISTOGRAM]:{title:(0,r.t)("FID Distribution"),titleTooltip:(0,o.$r)(t,o.V$.DURATION_DISTRIBUTION),fields:["measurements.fid"],dataType:n.A.histogram,chartColor:d[5]},[l.WORST_LCP_VITALS]:{title:(0,r.t)("Worst LCP Web Vitals"),titleTooltip:(0,o.$r)(t,o.V$.LCP),fields:e?["count(".concat(s.kY.SENTRY_TRANSACTIONS_MEASUREMENTS_LCP,")")]:["measurements.lcp"],vitalStops:{poor:4e3,meh:2500},dataType:n.A.vitals},[l.WORST_FCP_VITALS]:{title:(0,r.t)("Worst FCP Web Vitals"),titleTooltip:(0,o.$r)(t,o.V$.FCP),fields:e?["count(".concat(s.kY.SENTRY_TRANSACTIONS_MEASUREMENTS_FCP,")")]:["measurements.fcp"],vitalStops:{poor:3e3,meh:1e3},dataType:n.A.vitals},[l.WORST_FID_VITALS]:{title:(0,r.t)("Worst FID Web Vitals"),titleTooltip:(0,o.$r)(t,o.V$.FID),fields:e?["count(".concat(s.kY.SENTRY_TRANSACTIONS_MEASUREMENTS_FID,")")]:["measurements.fid"],vitalStops:{poor:300,meh:100},dataType:n.A.vitals},[l.WORST_CLS_VITALS]:{title:(0,r.t)("Worst CLS Web Vitals"),titleTooltip:(0,o.$r)(t,o.V$.CLS),fields:e?["count(".concat(s.kY.SENTRY_TRANSACTIONS_MEASUREMENTS_CLS,")")]:["measurements.cls"],vitalStops:{poor:.25,meh:.1},dataType:n.A.vitals},[l.TPM_AREA]:{title:(0,r.t)("Transactions Per Minute"),titleTooltip:(0,o.$r)(t,o.V$.TPM),fields:e?["count(".concat(s.kY.SENTRY_TRANSACTIONS_TRANSACTION_DURATION,")")]:["tpm()"],dataType:n.A.area,chartColor:d[1]},[l.APDEX_AREA]:{title:(0,r.t)("Apdex"),titleTooltip:(0,o.$r)(t,o.V$.APDEX_NEW),fields:["apdex()"],dataType:n.A.area,chartColor:d[4]},[l.P50_DURATION_AREA]:{title:(0,r.t)("p50 Duration"),titleTooltip:(0,o.$r)(t,o.V$.P50),fields:e?["p50(".concat(s.kY.SENTRY_TRANSACTIONS_TRANSACTION_DURATION,")")]:["p50(transaction.duration)"],dataType:n.A.area,chartColor:d[3]},[l.P75_DURATION_AREA]:{title:(0,r.t)("p75 Duration"),titleTooltip:(0,o.$r)(t,o.V$.P75),fields:e?["p75(".concat(s.kY.SENTRY_TRANSACTIONS_TRANSACTION_DURATION,")")]:["p75(transaction.duration)"],dataType:n.A.area,chartColor:d[3]},[l.P95_DURATION_AREA]:{title:(0,r.t)("p95 Duration"),titleTooltip:(0,o.$r)(t,o.V$.P95),fields:e?["p95(".concat(s.kY.SENTRY_TRANSACTIONS_TRANSACTION_DURATION,")")]:["p95(transaction.duration)"],dataType:n.A.area,chartColor:d[3]},[l.P99_DURATION_AREA]:{title:(0,r.t)("p99 Duration"),titleTooltip:(0,o.$r)(t,o.V$.P99),fields:e?["p99(".concat(s.kY.SENTRY_TRANSACTIONS_TRANSACTION_DURATION,")")]:["p99(transaction.duration)"],dataType:n.A.area,chartColor:d[3]},[l.P75_LCP_AREA]:{title:(0,r.t)("p75 LCP"),titleTooltip:(0,o.$r)(t,o.V$.P75),fields:e?["p75(".concat(s.kY.SENTRY_TRANSACTIONS_MEASUREMENTS_LCP,")")]:["p75(measurements.lcp)"],dataType:n.A.area,chartColor:d[1]},[l.FAILURE_RATE_AREA]:{title:(0,r.t)("Failure Rate"),titleTooltip:(0,o.$r)(t,o.V$.FAILURE_RATE),fields:e?["count(".concat(s.kY.SENTRY_TRANSACTIONS_TRANSACTION_DURATION,")")]:["failure_rate()"],dataType:n.A.area,chartColor:d[2]},[l.USER_MISERY_AREA]:{title:(0,r.t)("User Misery"),titleTooltip:(0,o.$r)(t,o.V$.USER_MISERY),fields:["user_misery()"],dataType:n.A.area,chartColor:d[0]},[l.COLD_STARTUP_AREA]:{title:(0,r.t)("Cold Startup Time"),titleTooltip:(0,o.$r)(t,o.V$.APP_START_COLD),fields:e?["p75(".concat(s.kY.SENTRY_TRANSACTIONS_MEASUREMENTS_APP_START_COLD,")")]:["p75(measurements.app_start_cold)"],dataType:n.A.area,chartColor:d[4]},[l.WARM_STARTUP_AREA]:{title:(0,r.t)("Warm Startup Time"),titleTooltip:(0,o.$r)(t,o.V$.APP_START_WARM),fields:e?["p75(".concat(s.kY.SENTRY_TRANSACTIONS_MEASUREMENTS_APP_START_WARM,")")]:["p75(measurements.app_start_warm)"],dataType:n.A.area,chartColor:d[3]},[l.SLOW_FRAMES_AREA]:{title:(0,r.t)("Slow Frames"),titleTooltip:(0,o.$r)(t,o.V$.SLOW_FRAMES),fields:e?["p75(".concat(s.kY.SENTRY_TRANSACTIONS_MEASUREMENTS_FRAMES_SLOW_RATE,")")]:["p75(measurements.frames_slow_rate)"],dataType:n.A.area,chartColor:d[0]},[l.FROZEN_FRAMES_AREA]:{title:(0,r.t)("Frozen Frames"),titleTooltip:(0,o.$r)(t,o.V$.FROZEN_FRAMES),fields:e?["p75(".concat(s.kY.SENTRY_TRANSACTIONS_MEASUREMENTS_FRAMES_FROZEN_RATE,")")]:["p75(measurements.frames_frozen_rate)"],dataType:n.A.area,chartColor:d[5]},[l.MOST_RELATED_ERRORS]:{title:(0,r.t)("Most Related Errors"),titleTooltip:(0,o.$r)(t,o.V$.MOST_ERRORS),fields:["failure_count()"],dataType:n.A.line_list,chartColor:d[0]},[l.MOST_RELATED_ISSUES]:{title:(0,r.t)("Most Related Issues"),titleTooltip:(0,o.$r)(t,o.V$.MOST_ISSUES),fields:["count()"],dataType:n.A.line_list,chartColor:d[0]},[l.SLOW_HTTP_OPS]:{title:(0,r.t)("Slow HTTP Ops"),titleTooltip:(0,o.$r)(t,o.V$.SLOW_HTTP_SPANS),fields:["p75(spans.http)"],dataType:n.A.line_list,chartColor:d[0]},[l.SLOW_BROWSER_OPS]:{title:(0,r.t)("Slow Browser Ops"),titleTooltip:(0,o.$r)(t,o.V$.SLOW_HTTP_SPANS),fields:["p75(spans.browser)"],dataType:n.A.line_list,chartColor:d[0]},[l.SLOW_RESOURCE_OPS]:{title:(0,r.t)("Slow Resource Ops"),titleTooltip:(0,o.$r)(t,o.V$.SLOW_HTTP_SPANS),fields:["p75(spans.resource)"],dataType:n.A.line_list,chartColor:d[0]},[l.SLOW_DB_OPS]:{title:(0,r.t)("Slow DB Ops"),titleTooltip:(0,o.$r)(t,o.V$.SLOW_HTTP_SPANS),fields:["p75(spans.db)"],dataType:n.A.line_list,chartColor:d[0]},[l.MOST_SLOW_FRAMES]:{title:(0,r.t)("Most Slow Frames"),titleTooltip:(0,o.$r)(t,o.V$.SLOW_FRAMES),fields:e?["avg(".concat(s.kY.SENTRY_TRANSACTIONS_MEASUREMENTS_FRAMES_SLOW,")")]:["avg(measurements.frames_slow)"],dataType:n.A.line_list,chartColor:d[0]},[l.MOST_FROZEN_FRAMES]:{title:(0,r.t)("Most Frozen Frames"),titleTooltip:(0,o.$r)(t,o.V$.FROZEN_FRAMES),fields:e?["avg(".concat(s.kY.SENTRY_TRANSACTIONS_MEASUREMENTS_FRAMES_FROZEN,")")]:["avg(measurements.frames_frozen)"],dataType:n.A.line_list,chartColor:d[0]},[l.MOST_IMPROVED]:{title:(0,r.t)("Most Improved"),titleTooltip:(0,r.t)("This compares the baseline (%s) of the past with the present.","improved"),fields:[],dataType:n.A.trends},[l.MOST_REGRESSED]:{title:(0,r.t)("Most Regressed"),titleTooltip:(0,r.t)("This compares the baseline (%s) of the past with the present.","regressed"),fields:[],dataType:n.A.trends}})},"./app/views/performance/landing/widgets/widgets/vitalWidget.tsx":(t,e,a)=>{a.d(e,{gt:()=>I,Ac:()=>C});var i=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(a("../node_modules/core-js/modules/web.dom-collections.iterator.js"),a("../node_modules/react/index.js")),s=a("../node_modules/lodash/pick.js"),o=a.n(s),n=a("./app/components/button.tsx"),l=a("./app/components/charts/eventsRequest.tsx"),d=a("./app/components/charts/utils.tsx"),c=a("./app/components/truncate.tsx"),p=a("./app/locale.tsx"),u=a("./app/styles/space.tsx"),m=a("./app/utils.tsx"),g=a("./app/utils/discover/discoverQuery.tsx"),h=a("./app/utils/discover/fields.tsx"),_=a("./app/utils/queryString.tsx"),S=a("./app/utils/tokenizeSearch.tsx"),v=a("./app/utils/withApi.tsx"),f=a("./app/views/performance/vitalDetail/utils.tsx"),T=a("./app/views/performance/vitalDetail/vitalChart.tsx"),A=a("./app/views/performance/landing/utils.tsx"),y=a("./app/views/performance/landing/vitalsCards.tsx"),R=a("./app/views/performance/landing/widgets/components/performanceWidget.tsx"),x=a("./app/views/performance/landing/widgets/components/selectableList.tsx"),w=a("./app/views/performance/landing/widgets/transforms/transformDiscoverToList.tsx"),E=a("./app/components/organizations/pageFilters/parse.tsx");function Z(t,e,a){var i;const{start:r,end:s,utc:o,interval:n,statsPeriod:l}=(0,E.fK)(t.location.query),d=null!==(i=e.results)&&void 0!==i?i:[];return{...e,isLoading:e.loading||e.reloading,isErrored:e.errored,hasData:(0,m.ri)(d)&&!!d.length&&!!d[0].data.length,data:d,utc:"true"===o,interval:n,statsPeriod:null!=l?l:void 0,start:null!=r?r:"",end:null!=s?s:""}}var P=a("./app/views/performance/landing/widgets/utils.tsx"),O=a("./app/views/performance/landing/widgets/widgetDefinitions.tsx"),D=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function C(t){const{ContainerActions:e,eventView:a,organization:i,location:s}=t,[l,u]=(0,r.useState)(0),v=t.fields[0],{fieldsList:E,vitalFields:C,sortField:b}=function(t){const{field:e,fields:a,vitalStops:i}=t,r=null==i?void 0:i.poor,s=null==i?void 0:i.meh;if(!(0,m.ri)(r)||!(0,m.ri)(s))return{sortField:a[0],fieldsList:a};const o="count_if(".concat(e,",greaterOrEquals,").concat(r,")"),n="equation|count_if(".concat(e,",greaterOrEquals,").concat(s,") - count_if(").concat(e,",greaterOrEquals,").concat(r,")"),l="equation|count_if(".concat(e,",greaterOrEquals,0) - count_if(").concat(e,",greaterOrEquals,").concat(s,")");return{sortField:o,vitalFields:{poorCountField:o,mehCountField:n,goodCountField:l},fieldsList:[o,"count_if(".concat(e,",greaterOrEquals,").concat(s,")"),"count_if(".concat(e,",greaterOrEquals,0)"),n,l]}}({field:v,fields:t.fields,vitalStops:t.chartDefinition.vitalStops}),M={list:(0,r.useMemo)((()=>({fields:b,component:e=>{const a=e.eventView.clone(),i=E.map((t=>({field:t})));a.sorts=[{kind:"desc",field:b}],a.fields=[{field:"transaction"},{field:"title"},{field:"project.id"},...i];const r=new S.MY(a.query);return a.query=r.formatString(),(0,D.tZ)(g.Z,{...e,eventView:a,location:t.location,limit:3,cursor:"0:0:1",noPagination:!0})},transform:w._})),[t.eventView,E,t.organization.slug]),chart:(0,r.useMemo)((()=>({enabled:t=>{var e,a;return!(null==t||null===(e=t.list)||void 0===e||null===(a=e.data)||void 0===a||!a.length)},fields:E,component:t=>{var e;const a=t.eventView.clone();return a.additionalConditions.setFilterValues("transaction",[null===(e=t.widgetData.list.data[l])||void 0===e?void 0:e.transaction]),(0,D.tZ)(L,{...o()(t,P.CJ),limit:1,currentSeriesNames:[b],includePrevious:!1,partial:!1,includeTransformedData:!0,query:a.getQueryWithAdditionalConditions(),interval:(0,d.ZS)({start:t.start,end:t.end,period:t.period},"medium")})},transform:Z})),[t.chartSetting,l])},F={[O.s.WORST_LCP_VITALS]:h.Zl.LCP,[O.s.WORST_FCP_VITALS]:h.Zl.FCP,[O.s.WORST_FID_VITALS]:h.Zl.FID,[O.s.WORST_CLS_VITALS]:h.Zl.CLS},q=()=>{};return(0,D.tZ)(R.I,{...t,Subtitle:e=>{var a,i;const r=null===(a=e.widgetData.list)||void 0===a?void 0:a.data[l];if(!r)return(0,D.tZ)(x.QE,{});const s={[F[t.chartSetting]]:N(r)};return(0,D.tZ)(x.QE,{children:(0,D.tZ)(y.JO,{isLoading:null===(i=e.widgetData.list)||void 0===i?void 0:i.isLoading,vital:F[t.chartSetting],data:s,showBar:!1,showDurationDetail:!1,showDetail:!0})})},EmptyComponent:x.xq,HeaderActions:o=>{const l=F[t.chartSetting],d=(0,f.i4)({orgSlug:i.slug,query:a.generateQueryStringObject(),vitalName:l,projectID:(0,_.qP)(s.query.project)});return(0,D.BX)(r.Fragment,{children:[(0,D.tZ)("div",{children:(0,D.tZ)(n.ZP,{onClick:q,to:d,size:"small","data-test-id":"view-all-button",children:(0,p.t)("View All")})}),(0,D.tZ)(e,{...o.widgetData.chart})]})},Queries:M,Visualizations:[{component:t=>(0,D.tZ)(T.S,{...t.widgetData.chart,...t,field:v,vitalFields:C,grid:t.grid}),height:t.chartHeight},{component:e=>(0,D.tZ)(x.ZP,{selectedIndex:l,setSelectedIndex:u,items:e.widgetData.list.data.map((o=>()=>{var n;const l=null==o?void 0:o.transaction,d=a.clone(),p=new S.MY(d.query);p.addFilterValues("transaction",[l]);const m=F[t.chartSetting];d.query=p.formatString();const g=(0,f.i4)({orgSlug:i.slug,query:d.generateQueryStringObject(),vitalName:m,projectID:(0,_.qP)(s.query.project)}),h={[F[t.chartSetting]]:N(o)};return(0,D.BX)(r.Fragment,{children:[(0,D.tZ)(x.qL,{to:g,children:(0,D.tZ)(c.Z,{value:l,maxLength:40})}),(0,D.tZ)(I,{children:(0,D.tZ)(y.JO,{isLoading:null===(n=e.widgetData.list)||void 0===n?void 0:n.isLoading,vital:F[t.chartSetting],data:h,showBar:!0,showDurationDetail:!1,showDetail:!1,showTooltip:!0,barHeight:20})}),(0,D.tZ)(x.Nm,{setSelectListIndex:u,onClick:()=>(0,A.kP)(o.transaction,t)})]})}))}),height:124,noPadding:!0}]})}function N(t){const e={poor:t.count_if_measurements_lcp_greaterOrEquals_4000||0,meh:t["equation[0]"]||0,good:t["equation[1]"]||0,p75:0};return{...e,total:e.poor+e.meh+e.good}}C.displayName="VitalWidget";const I=(0,i.Z)(x.S$,{target:"ejni1p10"})("width:120px;margin-left:",(0,u.Z)(1),";margin-right:",(0,u.Z)(1),";display:flex;align-items:center;justify-content:center;"),L=(0,v.Z)(l.Z)},"./app/views/performance/landing/widgets/widgets/vitalWidgetMetrics.tsx":(t,e,a)=>{a.d(e,{I:()=>D,b:()=>C}),a("../node_modules/core-js/modules/web.dom-collections.iterator.js");var i=a("../node_modules/react/index.js"),r=a("./app/components/button.tsx"),s=a("./app/components/truncate.tsx"),o=a("./app/locale.tsx"),n=a("./app/styles/space.tsx"),l=a("./app/utils.tsx"),d=a("./app/utils/discover/fields.tsx"),c=a("./app/utils/metrics/metricsRequest.tsx"),p=a("./app/utils/queryString.tsx"),u=a("./app/utils/tokenizeSearch.tsx"),m=a("./app/utils/useApi.tsx"),g=a("./app/views/performance/vitalDetail/utils.tsx"),h=a("./app/views/performance/vitalDetail/vitalChart.tsx"),_=a("./app/views/performance/landing/utils.tsx"),S=a("./app/views/performance/landing/vitalsCards.tsx"),v=a("./app/views/performance/landing/widgets/components/performanceWidget.tsx"),f=a("./app/views/performance/landing/widgets/components/selectableList.tsx"),T=a("./app/views/performance/landing/widgets/transforms/transformMetricsToList.tsx"),A=a("../node_modules/moment/moment.js"),y=a.n(A),R=a("./app/components/organizations/pageFilters/parse.tsx"),x=a("./app/views/performance/data.tsx");function w(t,e,a){var i;const{start:r,end:s,utc:o,interval:n,statsPeriod:d}=(0,R.fK)(t.location.query,{defaultStatsPeriod:x.GY}),c=t.Queries.chart.fields[0],{errored:p,loading:u,reloading:m,response:g}=e,h=null!==(i=null==g?void 0:g.groups.reduce(((t,e)=>{var a;return t[e.by.transaction]=[...null!==(a=t[e.by.transaction])&&void 0!==a?a:[],{seriesName:e.by.measurement_rating,data:g.intervals.map(((t,a)=>({name:y()(t).valueOf(),value:e.series[c][a]})))}],t}),{}))&&void 0!==i?i:{};return{loading:u,reloading:m,isLoading:u||m,isErrored:p,hasData:(0,l.ri)(g)&&!!g.groups.length,response:g,data:h,utc:"true"===o,interval:n,statsPeriod:null!=d?d:void 0,start:null!=r?r:"",end:null!=s?s:""}}var E=a("./app/views/performance/landing/widgets/widgetDefinitions.tsx"),Z=a("./app/views/performance/landing/widgets/widgets/vitalWidget.tsx"),P=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const O={[E.s.WORST_LCP_VITALS]:d.Zl.LCP,[E.s.WORST_FCP_VITALS]:d.Zl.FCP,[E.s.WORST_FID_VITALS]:d.Zl.FID,[E.s.WORST_CLS_VITALS]:d.Zl.CLS};function D(t){const e=(0,m.Z)(),{ContainerActions:a,eventView:d,organization:A,location:y,chartSetting:R}=t,[x,E]=(0,i.useState)(0),D=t.fields[0],N=O[R],I=A.slug,L={list:(0,i.useMemo)((()=>({fields:[D],component:({start:t,end:a,period:i,project:r,environment:s,children:o,fields:n})=>(0,P.tZ)(c.Z,{api:e,orgSlug:I,start:t,end:a,statsPeriod:i,project:r,environment:s,query:new u.MY(d.query).addFilterValues("measurement_rating",["poor"]).formatString(),field:(0,p.qP)(n),groupBy:["transaction"],orderBy:"-".concat((0,p.qP)(n)[0]),limit:3,children:o}),transform:T.P})),[d,D,A.slug]),chart:(0,i.useMemo)((()=>({enabled:t=>{var e,a;return!(null==t||null===(e=t.list)||void 0===e||null===(a=e.data)||void 0===a||!a.length)},fields:[D],component:({start:t,end:a,period:i,project:r,environment:s,children:o,fields:n,widgetData:l})=>(0,P.tZ)(c.Z,{api:e,orgSlug:I,start:t,end:a,statsPeriod:i,project:r,environment:s,query:new u.MY(d.query).addFilterValues("transaction",["[".concat(l.list.data.map((t=>t.transaction)).join(","),"]")]).formatString(),field:(0,p.qP)(n),groupBy:["transaction","measurement_rating"],children:o}),transform:w})),[R])},b=()=>{};return(0,P.tZ)(v.I,{...t,Subtitle:t=>{var e,a,i;const{widgetData:r}=t,s=null===(e=r.list)||void 0===e||null===(a=e.data[x])||void 0===a?void 0:a.transaction;if(!(null===(i=r.chart)||void 0===i?void 0:i.data[s]))return(0,P.tZ)(f.QE,{children:" "});const o={[N]:C({transaction:s,field:D,response:r.chart.response})};return(0,P.tZ)(f.QE,{children:(0,P.tZ)(S.JO,{isLoading:r.list.isLoading||r.chart.isLoading,vital:N,data:o,showBar:!1,showDurationDetail:!1,showDetail:!0})})},EmptyComponent:f.xq,HeaderActions:t=>{const e=(0,g.i4)({orgSlug:I,query:d.generateQueryStringObject(),vitalName:N,projectID:(0,p.qP)(y.query.project)});return(0,P.BX)(i.Fragment,{children:[(0,P.tZ)("div",{children:(0,P.tZ)(r.ZP,{onClick:b,to:e,size:"small","data-test-id":"view-all-button",children:(0,o.t)("View All")})}),(0,P.tZ)(a,{...t.widgetData.chart})]})},Queries:L,Visualizations:[{component:t=>{const e=t.widgetData.list.data[x].transaction;return(0,P.tZ)(h.S,{...t.widgetData.chart,data:(0,l.ri)(e)?t.widgetData.chart.data[e]:void 0,...t,field:D,vitalFields:{poorCountField:"poor",mehCountField:"meh",goodCountField:"good"},grid:{left:(0,n.Z)(0),right:(0,n.Z)(0),top:(0,n.Z)(2),bottom:(0,n.Z)(2)}})},height:160},{component:e=>{const{widgetData:a}=e;return(0,P.tZ)(f.ZP,{selectedIndex:x,setSelectedIndex:E,items:a.list.data.map((e=>()=>{const r=e.transaction;if(!r)return null;const o=d.clone(),n=new u.MY(o.query);n.addFilterValues("transaction",[r]),o.query=n.formatString();const l=(0,g.i4)({orgSlug:I,query:o.generateQueryStringObject(),vitalName:N,projectID:(0,p.qP)(y.query.project)}),c={[N]:C({transaction:r,field:D,response:a.chart.response})};return(0,P.BX)(i.Fragment,{children:[(0,P.tZ)(f.qL,{to:l,children:(0,P.tZ)(s.Z,{value:r,maxLength:40})}),(0,P.tZ)(Z.gt,{children:(0,P.tZ)(S.JO,{isLoading:a.list.isLoading||a.chart.isLoading,vital:N,data:c,showBar:!0,showDurationDetail:!1,showDetail:!1,showTooltip:!0,barHeight:20})}),(0,P.tZ)(f.Nm,{setSelectListIndex:E,onClick:()=>(0,_.kP)(r,t)})]})}))})},height:124,noPadding:!0}]})}function C({transaction:t,field:e,response:a}){var i;const r=null!==(i=t?null==a?void 0:a.groups.filter((e=>e.by.transaction===t)):null==a?void 0:a.groups)&&void 0!==i?i:[];return{poor:0,meh:0,good:0,p75:0,...r.reduce(((t,a)=>{var i;return t[a.by.measurement_rating]=null!==(i=a.totals[e])&&void 0!==i?i:0,t}),{}),total:r.reduce(((t,a)=>{var i;return t+(null!==(i=a.totals[e])&&void 0!==i?i:0)}),0)}}D.displayName="VitalWidgetMetrics"},"./app/views/performance/metricsSearchBar.tsx":(t,e,a)=>{a.d(e,{Z:()=>v});var i,r=a("../node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js"),s=(a("../node_modules/core-js/modules/web.dom-collections.iterator.js"),a("../node_modules/core-js/modules/es.string.replace.js"),a("../node_modules/react/index.js")),o=a("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),n=a("../node_modules/lodash/memoize.js"),l=a.n(n),d=a("./app/actionCreators/indicator.tsx"),c=a("./app/components/smartSearchBar/index.tsx"),p=a("./app/constants/index.tsx"),u=a("./app/locale.tsx"),m=a("./app/utils/metrics/getMetricsDataSource.tsx"),g=a("./app/utils/useApi.tsx"),h=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const _=new RegExp("^".concat(p.c$,"|\\").concat(p.ir),"g");function S({orgSlug:t,onSearch:e,onBlur:a,maxQueryLength:n,searchSource:p,projectIds:S,className:v,...f}){const T=(0,g.Z)(),[A,y]=(0,s.useState)([]);function R(t){return t.replace(_,"")}function x(e,a){return(i=e.key,T.requestPromise("/organizations/".concat(t,"/metrics/tags/").concat(i,"/"),{query:{project:S,datasource:(0,m.P)()}})).then((t=>t.map((({value:t})=>t))),(()=>{throw new Error("Unable to fetch tag values")}));var i}(0,s.useEffect)((()=>{!async function(){try{const e=await T.requestPromise("/organizations/".concat(t,"/metrics/tags/"),{query:{project:S.length?S:void 0,datasource:(0,m.P)()}});y(e)}catch{(0,d.Iw)((0,u.t)("Unable to fetch search bar tags"))}}()}),[S]);const w=A.reduce(((t,{key:e})=>(t[e]={key:e,name:e},t)),{});return(0,h.tZ)(o.ms,{children:({css:t})=>(0,h.tZ)(c.Z,{onGetTagValues:l()(x,(({key:t},e)=>"".concat(t,"-").concat(e))),supportedTags:w,prepareQuery:R,excludeEnvironment:!0,dropdownClassName:t(i||(i=(0,r.Z)(["\n            max-height: 300px;\n            overflow-y: auto;\n          "]))),onSearch:e,onBlur:a,maxQueryLength:n,searchSource:p,className:v,query:f.query,hasRecentSearches:!0})})}S.displayName="MetricsSearchBar";const v=S},"./app/views/performance/vitalDetail/vitalChart.tsx":(t,e,a)=>{a.d(e,{Z:()=>w,S:()=>Z}),a("../node_modules/core-js/modules/web.dom-collections.iterator.js"),a("../node_modules/core-js/modules/es.string.replace.js");var i=a("../node_modules/react-router/es/index.js"),r=a("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),s=a("./app/components/charts/chartZoom.tsx"),o=a("./app/components/charts/errorPanel.tsx"),n=a("./app/components/charts/eventsRequest.tsx"),l=a("./app/components/charts/lineChart.tsx"),d=a("./app/components/charts/releaseSeries.tsx"),c=a("./app/components/charts/styles.tsx"),p=a("./app/components/charts/transitionChart.tsx"),u=a("./app/components/charts/transparentLoadingMask.tsx"),m=a("./app/components/panels/index.tsx"),g=a("./app/components/questionTooltip.tsx"),h=a("./app/icons/index.tsx"),_=a("./app/locale.tsx"),S=a("./app/utils/discover/charts.tsx"),v=a("./app/utils/discover/fields.tsx"),f=a("./app/utils/getDynamicText.tsx"),T=a("./app/utils/useApi.tsx"),A=a("./app/views/performance/trends/utils.tsx"),y=a("./app/views/performance/vitalDetail/utils.tsx"),R=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function x({project:t,environment:e,location:a,organization:S,query:v,statsPeriod:x,router:w,start:E,end:Z,interval:P}){const O=(0,T.Z)(),D=(0,r.u)(),C=(0,y.iF)(a),N="p75(".concat(C,")"),{utc:I,legend:L,vitalPoor:b,markLines:M,chartOptions:F}=(0,y.EX)({theme:D,location:a,yAxis:N,vital:C});function q(t){const{selected:e}=t,r=Object.keys(e).filter((t=>!e[t])),s={...a,query:{...a.query,unselectedSeries:r}};i.browserHistory.push(s)}return(0,R.tZ)(m.s_,{children:(0,R.BX)(c.BO,{children:[(0,R.BX)(c.ws,{children:[(0,_.t)("Duration p75"),(0,R.tZ)(g.Z,{size:"sm",position:"top",title:(0,_.t)("The durations shown should fall under the vital threshold.")})]}),(0,R.tZ)(s.Z,{router:w,period:x,start:E,end:Z,utc:I,children:a=>(0,R.tZ)(n.Z,{api:O,organization:S,period:x,project:t,environment:e,start:E,end:Z,interval:P,showLoading:!1,query:v,includePrevious:!1,yAxis:[N],partial:!0,children:({timeseriesData:i,errored:r,loading:s,reloading:n})=>{if(r)return(0,R.tZ)(o.Z,{children:(0,R.tZ)(h.FC,{color:"gray500",size:"lg"})});const c=i&&D.charts.getColorPalette(i.length-2)||[],{smoothedResults:m}=(0,A.vq)(i),g=m?m.map((({seriesName:t,...e},a)=>({seriesName:(0,A.HF)(t)||"p75",...e,color:c[a],lineStyle:{opacity:1,width:2}}))):[],_=(0,y.vk)(g),S=Math.max(_,b);return F.yAxis.max=1.1*S,(0,R.tZ)(d.Z,{start:E,end:Z,period:x,utc:I,projects:t,environments:e,children:({releaseSeries:t})=>(0,R.BX)(p.Z,{loading:s,reloading:n,children:[(0,R.tZ)(u.Z,{visible:n}),(0,f.Z)({value:(0,R.tZ)(l.Z,{...a,...F,legend:L,onLegendSelectChanged:q,series:[...M,...t,...g]}),fixed:"Web Vitals Chart"})]})})}})})]})})}x.displayName="VitalChart";const w=(0,i.withRouter)(x);function E(t,e){return t===(null==e?void 0:e.poorCountField.replace("equation|",""))?y.SP.POOR:t===(null==e?void 0:e.mehCountField.replace("equation|",""))?y.SP.MEH:t===(null==e?void 0:e.goodCountField.replace("equation|",""))?y.SP.GOOD:void 0}function Z(t){const{field:e,data:a,loading:i,reloading:s,height:o,grid:n,utc:d,vitalFields:c}=t;if(!a||!c)return null;const m=(0,r.u)(),g={grid:n,seriesOptions:{showSymbol:!1},tooltip:{trigger:"axis",valueFormatter:(t,a)=>(0,S.CX)(t,c[0]===v.Zl.CLS?a:e)},xAxis:{show:!1},xAxes:void 0,yAxis:{axisLabel:{color:m.chartLabel,showMaxLabel:!1,formatter:t=>(0,S.gu)(t,e)}},utc:d,isGroupedByDate:!0,showTimeInTooltip:!0},h=a.filter((t=>!!E(t.seriesName,c))),_=null!=h&&h.length?h.map((({seriesName:t,...e})=>{const a=E(t,c)||"count";return{seriesName:a,...e,color:m[y.fL[a]],lineStyle:{opacity:1,width:2}}})):[];return(0,R.tZ)("div",{children:(0,R.BX)(p.Z,{loading:i,reloading:s,children:[(0,R.tZ)(u.Z,{visible:s}),(0,f.Z)({value:(0,R.tZ)(l.Z,{height:o,...g,onLegendSelectChanged:()=>{},series:[..._],isGroupedByDate:!0}),fixed:"Web Vitals Chart"})]})})}Z.displayName="_VitalChart"}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_landing_widgets_transforms_transformMetricsToArea_tsx-app_views_perform-b9f920.54d8c49bea8cf494d6f6974eecf83f30.js.map