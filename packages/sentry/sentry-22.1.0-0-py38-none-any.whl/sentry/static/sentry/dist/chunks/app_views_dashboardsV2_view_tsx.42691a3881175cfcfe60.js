"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_dashboardsV2_view_tsx"],{"./app/views/dashboardsV2/orgDashboards.tsx":(s,a,e)=>{e.d(a,{Z:()=>x});var o=e("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(e("../node_modules/core-js/modules/web.dom-collections.iterator.js"),e("../node_modules/core-js/modules/es.string.replace.js"),e("../node_modules/react/index.js"),e("../node_modules/react-router/es/index.js")),t=e("../node_modules/lodash/isEqual.js"),d=e.n(t),n=e("./app/components/asyncComponent.tsx"),i=e("./app/components/errors/notFound.tsx"),p=e("./app/components/loadingIndicator.tsx"),c=e("./app/components/sentryDocumentTitle.tsx"),h=e("./app/locale.tsx"),l=e("./app/styles/organization.tsx"),u=e("./app/utils/analytics.tsx"),b=e("./app/views/dashboardsV2/dashboard.tsx"),m=e("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class g extends n.Z{constructor(...s){super(...s),(0,o.Z)(this,"state",{loading:!0,reloading:!1,error:!1,errors:{},dashboards:[],selectedDashboard:null})}componentDidUpdate(s){d()(s.params.dashboardId,this.props.params.dashboardId)||this.remountComponent()}getEndpoints(){const{organization:s,params:a}=this.props,e="/organizations/".concat(s.slug,"/dashboards/"),o=[["dashboards",e]];return a.dashboardId&&(o.push(["selectedDashboard","".concat(e).concat(a.dashboardId,"/")]),(0,u.ec)({eventKey:"dashboards2.view",eventName:"Dashboards2: View dashboard",organization_id:parseInt(this.props.organization.id,10),dashboard_id:a.dashboardId})),o}onDashboardUpdate(s){this.setState({selectedDashboard:s})}getDashboards(){const{dashboards:s}=this.state;return Array.isArray(s)?s:[]}onRequestSuccess({stateKey:s,data:a}){const{params:e,organization:o,location:t}=this.props;if("selectedDashboard"===s)return void(o.features.includes("dashboard-grid-layout")&&this.setState({[s]:{...a,widgets:a.widgets.map(b.TE)}}));if(e.dashboardId)return;const d=a.length?a[0].id:"default-overview",n="/organizations/".concat(o.slug,"/dashboard/").concat(d,"/");r.browserHistory.replace({pathname:n,query:{...t.query}})}renderLoading(){return(0,m.tZ)(l.JH,{children:(0,m.tZ)(p.Z,{})})}renderBody(){const{children:s}=this.props,{selectedDashboard:a,error:e}=this.state;return s({error:e,dashboard:a,dashboards:this.getDashboards(),onDashboardUpdate:s=>this.onDashboardUpdate(s)})}renderError(s){return Object.values(this.state.errors).find((s=>s&&404===s.status))?(0,m.tZ)(i.Z,{}):super.renderError(s,!0)}renderComponent(){const{organization:s,location:a}=this.props;return s.features.includes("dashboards-basic")?(0,m.tZ)(c.Z,{title:(0,h.t)("Dashboards"),orgSlug:s.slug,children:super.renderComponent()}):(r.browserHistory.replace({pathname:"/organizations/".concat(s.slug,"/dashboards/"),query:{...a.query}}),null)}}const x=g},"./app/views/dashboardsV2/view.tsx":(s,a,e)=>{e.r(a),e.d(a,{default:()=>D,DashboardBasicFeature:()=>_}),e("../node_modules/core-js/modules/web.dom-collections.iterator.js"),e("../node_modules/core-js/modules/es.string.replace.js");var o=e("../node_modules/react/index.js"),r=e("../node_modules/react-router/es/index.js"),t=e("../node_modules/lodash/pick.js"),d=e.n(t),n=e("./app/actionCreators/dashboards.tsx"),i=e("./app/components/acl/feature.tsx"),p=e("./app/components/alert.tsx"),c=e("./app/components/errors/notFound.tsx"),h=e("./app/components/loadingIndicator.tsx"),l=e("./app/locale.tsx"),u=e("./app/styles/organization.tsx"),b=e("./app/utils/useApi.tsx"),m=e("./app/utils/withOrganization.tsx"),g=e("./app/views/dashboardsV2/detail.tsx"),x=e("./app/views/dashboardsV2/orgDashboards.tsx"),w=e("./app/views/dashboardsV2/types.tsx"),y=e("./app/views/dashboardsV2/utils.tsx"),Z=e("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const j=["start","end","utc","period","project","environment"];function v(s){const a=(0,b.Z)(),{organization:e,params:t,location:i}=s,p=t.dashboardId,l=e.slug,[u,m]=(0,o.useState)();return(0,o.useEffect)((()=>{p&&"default-overview"!==p&&(0,n.a_)(a,l,p);const s=(0,y.y1)(i.query);m(s),s&&r.browserHistory.replace({pathname:i.pathname,query:d()(i.query,j)})}),[a,l,p]),(0,Z.tZ)(_,{organization:e,children:(0,Z.tZ)(x.Z,{api:a,location:i,params:t,organization:e,children:({dashboard:a,dashboards:e,error:o,onDashboardUpdate:r})=>o?(0,Z.tZ)(c.Z,{}):a?(0,Z.tZ)(g.Z,{...s,initialState:u?w.n3.EDIT:w.n3.VIEW,dashboard:a,dashboards:e,onDashboardUpdate:r,newWidget:u}):(0,Z.tZ)(h.Z,{})})})}v.displayName="ViewEditDashboard";const D=(0,m.Z)(v),_=({organization:s,children:a})=>(0,Z.tZ)(i.Z,{hookName:"feature-disabled:dashboards-page",features:["organizations:dashboards-basic"],organization:s,renderDisabled:()=>(0,Z.tZ)(u.JH,{children:(0,Z.tZ)(p.Z,{type:"warning",children:(0,l.t)("You don't have access to this feature")})}),children:a});_.displayName="DashboardBasicFeature"}}]);
//# sourceMappingURL=../sourcemaps/app_views_dashboardsV2_view_tsx.74548f1078beedf779cba20e6a5b1567.js.map