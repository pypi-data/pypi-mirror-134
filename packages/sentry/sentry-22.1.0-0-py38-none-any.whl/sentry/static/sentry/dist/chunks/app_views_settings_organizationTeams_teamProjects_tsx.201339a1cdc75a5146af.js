"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_organizationTeams_teamProjects_tsx"],{"./app/views/settings/components/settingsProjectItem.tsx":(e,t,s)=>{s.d(t,{Z:()=>h});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),i=s("./app/components/idBadge/projectBadge.tsx"),r=s("./app/components/projects/bookmarkStar.tsx"),c=s("./app/styles/space.tsx"),p=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class d extends a.Component{constructor(...e){super(...e),(0,o.Z)(this,"state",{isBookmarked:this.props.project.isBookmarked}),(0,o.Z)(this,"handleToggleBookmark",(e=>{this.setState({isBookmarked:e})}))}render(){const{project:e,organization:t}=this.props;return(0,p.BX)(l,{children:[(0,p.tZ)(m,{organization:t,project:e,isBookmarked:this.state.isBookmarked,onToggle:this.handleToggleBookmark}),(0,p.tZ)(i.Z,{to:"/settings/".concat(t.slug,"/projects/").concat(e.slug,"/"),avatarSize:18,project:e})]})}}d.displayName="ProjectItem";const l=(0,n.Z)("div",{target:"e3cl2ic1"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),m=(0,n.Z)(r.Z,{target:"e3cl2ic0"})("margin-right:",(0,c.Z)(1),";margin-top:-",(0,c.Z)(.25),";"),h=d},"./app/views/settings/organizationTeams/teamProjects.tsx":(e,t,s)=>{s.r(t),s.d(t,{TeamProjects:()=>w,default:()=>B});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),i=s("./app/actionCreators/indicator.tsx"),r=s("./app/actions/projectActions.tsx"),c=s("./app/components/button.tsx"),p=s("./app/components/dropdownAutoComplete/index.tsx"),d=s("./app/components/dropdownButton.tsx"),l=s("./app/components/loadingError.tsx"),m=s("./app/components/loadingIndicator.tsx"),h=s("./app/components/pagination.tsx"),u=s("./app/components/panels/index.tsx"),g=s("./app/components/tooltip.tsx"),j=s("./app/icons/index.tsx"),Z=s("./app/locale.tsx"),x=s("./app/styles/space.tsx"),k=s("./app/utils.tsx"),P=s("./app/utils/withApi.tsx"),y=s("./app/utils/withOrganization.tsx"),f=s("./app/views/settings/components/emptyMessage.tsx"),v=s("./app/views/settings/components/settingsProjectItem.tsx"),b=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class w extends a.Component{constructor(...e){super(...e),(0,o.Z)(this,"state",{error:!1,loading:!0,pageLinks:null,unlinkedProjects:[],linkedProjects:[]}),(0,o.Z)(this,"fetchAll",(()=>{this.fetchTeamProjects(),this.fetchUnlinkedProjects()})),(0,o.Z)(this,"handleLinkProject",((e,t)=>{const{orgId:s,teamId:o}=this.props.params;this.props.api.request("/projects/".concat(s,"/").concat(e.slug,"/teams/").concat(o,"/"),{method:"add"===t?"POST":"DELETE",success:e=>{this.fetchAll(),r.Z.updateSuccess(e),(0,i.S9)("add"===t?(0,Z.t)("Successfully added project to team."):(0,Z.t)("Successfully removed project from team"))},error:()=>{(0,i.Iw)((0,Z.t)("Wasn't able to change project association."))}})})),(0,o.Z)(this,"handleProjectSelected",(e=>{const t=this.state.unlinkedProjects.find((t=>t.id===e.value));t&&this.handleLinkProject(t,"add")})),(0,o.Z)(this,"handleQueryUpdate",(e=>{this.fetchUnlinkedProjects(e.target.value)}))}componentDidMount(){this.fetchAll()}componentDidUpdate(e){e.params.orgId===this.props.params.orgId&&e.params.teamId===this.props.params.teamId||this.fetchAll(),e.location!==this.props.location&&this.fetchTeamProjects()}fetchTeamProjects(){const{location:e,params:{orgId:t,teamId:s}}=this.props;this.setState({loading:!0}),this.props.api.requestPromise("/organizations/".concat(t,"/projects/"),{query:{query:"team:".concat(s),cursor:e.query.cursor||""},includeAllArgs:!0}).then((([e,t,s])=>{var o;this.setState({loading:!1,error:!1,linkedProjects:e,pageLinks:null!==(o=null==s?void 0:s.getResponseHeader("Link"))&&void 0!==o?o:null})})).catch((()=>{this.setState({loading:!1,error:!0})}))}fetchUnlinkedProjects(e=""){const{params:{orgId:t,teamId:s}}=this.props;this.props.api.requestPromise("/organizations/".concat(t,"/projects/"),{query:{query:e?"!team:".concat(s," ").concat(e):"!team:".concat(s)}}).then((e=>{this.setState({unlinkedProjects:e})}))}projectPanelContents(e){const{organization:t}=this.props,s=new Set(t.access).has("org:write");return e.length?(0,k.Mx)(e).map((e=>(0,b.BX)(z,{children:[(0,b.tZ)(v.Z,{project:e,organization:t}),(0,b.tZ)(g.Z,{disabled:s,title:(0,Z.t)("You do not have enough permission to change project association."),children:(0,b.tZ)(c.ZP,{size:"small",disabled:!s,icon:(0,b.tZ)(j.JZ,{isCircled:!0,size:"xs"}),onClick:()=>{this.handleLinkProject(e,"remove")},children:(0,Z.t)("Remove")})})]},e.id))):(0,b.tZ)(f.Z,{size:"large",icon:(0,b.tZ)(j.Gy,{size:"xl"}),children:(0,Z.t)("This team doesn't have access to any projects.")})}render(){const{linkedProjects:e,unlinkedProjects:t,error:s,loading:o}=this.state;if(s)return(0,b.tZ)(l.Z,{onRetry:()=>this.fetchAll()});if(o)return(0,b.tZ)(m.Z,{});const n=new Set(this.props.organization.access),i=t.map((e=>({value:e.id,searchKey:e.slug,label:(0,b.tZ)(S,{children:e.slug})})));return(0,b.BX)(a.Fragment,{children:[(0,b.BX)(u.s_,{children:[(0,b.BX)(u.V9,{hasButtons:!0,children:[(0,b.tZ)("div",{children:(0,Z.t)("Projects")}),(0,b.tZ)("div",{style:{textTransform:"none"},children:n.has("org:write")?(0,b.tZ)(p.Z,{items:i,onChange:this.handleQueryUpdate,onSelect:this.handleProjectSelected,emptyMessage:(0,Z.t)("No projects"),alignMenu:"right",children:({isOpen:e})=>(0,b.tZ)(d.Z,{isOpen:e,size:"xsmall",children:(0,Z.t)("Add Project")})}):(0,b.tZ)(d.Z,{disabled:!0,title:(0,Z.t)("You do not have enough permission to associate a project."),size:"xsmall",children:(0,Z.t)("Add Project")})})]}),(0,b.tZ)(u.N,{children:this.projectPanelContents(e)})]}),(0,b.tZ)(h.Z,{pageLinks:this.state.pageLinks,...this.props})]})}}w.displayName="TeamProjects";const z=(0,n.Z)(u.Lv,{target:"eofet41"})("display:flex;align-items:center;justify-content:space-between;padding:",(0,x.Z)(2),";"),S=(0,n.Z)("div",{target:"eofet40"})("padding:",(0,x.Z)(.25)," 0;"),B=(0,P.Z)((0,y.Z)(w))}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationTeams_teamProjects_tsx.5e6dc69c200e93f0f7c9a416359e6055.js.map