"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_components_events_groupingInfo_index_tsx"],{"./app/components/events/groupingInfo/index.tsx":(t,e,n)=>{n.d(e,{B:()=>at,Z:()=>ct});var i=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/react/index.js")),s=n("./app/components/asyncComponent.tsx"),a=n("./app/components/button.tsx"),l=n("./app/components/events/eventDataSection.tsx"),c=n("./app/components/loadingIndicator.tsx"),p=n("./app/locale.tsx"),d=n("./app/styles/space.tsx"),h=n("./app/utils/withOrganization.tsx"),u=n("./app/components/dropdownAutoComplete/index.tsx"),g=n("./app/components/dropdownButton.tsx"),m=n("./app/components/tooltip.tsx"),Z=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class f extends s.Z{getDefaultState(){return{...super.getDefaultState(),configs:[]}}getEndpoints(){return[["configs","/grouping-configs/"]]}renderLoading(){return this.renderBody()}renderBody(){const{configId:t,eventConfigId:e,onSelect:n}=this.props,{configs:i}=this.state,o=i.map((({id:t,hidden:n})=>({value:t,label:(0,Z.tZ)(at,{isHidden:n,isActive:t===e,children:t})})));return(0,Z.tZ)(u.Z,{onSelect:n,items:o,children:({isOpen:n})=>(0,Z.tZ)(m.Z,{title:(0,p.t)("Click here to experiment with other grouping configs"),children:(0,Z.tZ)(b,{isOpen:n,size:"small",children:(0,Z.tZ)(at,{isActive:e===t,children:t})})})})}}const b=(0,o.Z)(g.Z,{target:"e4u5um40"})({name:"18zed2t",styles:"font-weight:inherit"}),v=f;var C=n("../node_modules/lodash/capitalize.js"),y=n.n(C),x=n("./app/components/buttonBar.tsx"),w=n("./app/components/events/interfaces/keyValueList.tsx"),k=n("./app/components/questionTooltip.tsx"),z=n("./app/icons/index.tsx"),N=n("./app/styles/overflowEllipsis.tsx"),S=n("./app/types/index.tsx"),O=n("../node_modules/lodash/isObject.js"),B=n.n(O);function I(t){if(null==t||!t.contributes)return!0;for(const e of t.values)if(B()(e)&&I(e))return!0;return!1}function j(t,e){if(B()(t)){if(!t.contributes&&!t.hint&&0===t.values.length)return!1;if(!e&&!t.contributes)return!1}return!0}const _=({component:t,showNonContributing:e})=>(0,Z.tZ)(r.Fragment,{children:t.values.filter((t=>j(t,e))).map(((n,i)=>(0,Z.tZ)(H,{children:B()(n)?(0,Z.tZ)(U,{component:n,showNonContributing:e}):(0,Z.tZ)(M,{valueType:t.name||t.id,children:"string"==typeof n||"number"==typeof n?n:JSON.stringify(n,null,2)})},i)))});_.displayName="GroupingComponentChildren";const G=_;class T extends r.Component{constructor(...t){super(...t),(0,i.Z)(this,"state",{collapsed:!0})}render(){const{items:t,maxVisibleItems:e}=this.props,{collapsed:n}=this.state,i=t.length>e;return(0,Z.BX)(r.Fragment,{children:[t.map(((o,r)=>!n||r<e?(0,Z.tZ)(H,{isCollapsible:i,children:o},r):r===e?(0,Z.tZ)(H,{children:(0,Z.tZ)(X,{size:"small",priority:"link",icon:(0,Z.tZ)(z.N_,{size:"8px"}),onClick:()=>this.setState({collapsed:!1}),children:(0,p._N)("show [numberOfFrames] similiar",{numberOfFrames:t.length-e})})},r):null)),!n&&t.length>e&&(0,Z.tZ)(H,{children:(0,Z.tZ)(X,{size:"small",priority:"link",icon:(0,Z.tZ)(z.JZ,{size:"8px"}),onClick:()=>this.setState({collapsed:!0}),children:(0,p._N)("collapse [numberOfFrames] similiar",{numberOfFrames:t.length-e})})})]})}}T.displayName="GroupingComponentFrames",(0,i.Z)(T,"defaultProps",{maxVisibleItems:2});const X=(0,o.Z)(a.ZP,{target:"enrkrz0"})("margin:",(0,d.Z)(.5)," 0;color:",(t=>t.theme.linkColor),";"),F=T,D=({component:t,showNonContributing:e})=>(0,Z.tZ)(r.Fragment,{children:(()=>{const n=[];return t.values.filter((t=>j(t,e))).forEach((t=>{const i=t.values.filter((t=>j(t,e))).map((t=>t.id)).sort(((t,e)=>t.localeCompare(e))).join(""),o=n[n.length-1];(null==o?void 0:o.key)===i?o.data.push(t):n.push({key:i,data:[t]})})),n})().map(((t,n)=>(0,Z.tZ)(F,{items:t.data.map(((t,n)=>(0,Z.tZ)(U,{component:t,showNonContributing:e},n)))},n)))});D.displayName="GroupingComponentStacktrace";const E=D,P=({component:t,showNonContributing:e})=>{const n=function(t){return t.values.every((t=>!B()(t)))}(t),i="stacktrace"===t.id?E:G;return(0,Z.BX)(A,{isContributing:t.contributes,children:[(0,Z.BX)("span",{children:[t.name||t.id,t.hint&&(0,Z.tZ)(V,{children:" (".concat(t.hint,")")})]}),(0,Z.tZ)(L,{isInline:n,children:(0,Z.tZ)(i,{component:t,showNonContributing:e})})]})};P.displayName="GroupingComponent";const L=(0,o.Z)("ul",{target:"e1rb8ztm4"})("padding:0;margin:0;list-style:none;&,&>li{display:",(t=>t.isInline?"inline":"block"),";}"),H=(0,o.Z)("li",{target:"e1rb8ztm3"})("padding:0;margin:",(0,d.Z)(.25)," 0 ",(0,d.Z)(.25)," ",(0,d.Z)(1.5),";",(t=>t.isCollapsible&&"\n    border-left: 1px solid ".concat(t.theme.innerBorder,";\n    margin: 0 0 -").concat((0,d.Z)(.25)," ").concat((0,d.Z)(1),";\n    padding-left: ").concat((0,d.Z)(.5),";\n  ")),";"),M=(0,o.Z)("code",{target:"e1rb8ztm2"})("display:inline-block;margin:",(0,d.Z)(.25)," ",(0,d.Z)(.5)," ",(0,d.Z)(.25)," 0;font-size:",(t=>t.theme.fontSizeSmall),";padding:0 ",(0,d.Z)(.25),";background:rgba(112, 163, 214, 0.1);color:",(t=>t.theme.textColor),";",(({valueType:t})=>("function"===t||"symbol"===t)&&"\n    font-weight: bold;\n    color: ".concat((t=>t.theme.textColor),";\n  ")),";"),A=(0,o.Z)("div",{target:"e1rb8ztm1"})("color:",(t=>t.isContributing?null:t.theme.textColor),";",M,",button{opacity:1;}"),V=(0,o.Z)("small",{target:"e1rb8ztm0"})({name:"1rawn5e",styles:"font-size:0.8em"}),U=P;function J(t,e){e.matched_rule&&t.push([(0,p.t)("Fingerprint rule"),(0,Z.BX)(tt,{children:[e.matched_rule,(0,Z.tZ)(k.Z,{size:"xs",position:"top",title:(0,p.t)("The server-side fingerprinting rule that produced the fingerprint.")})]},"type")]),e.values&&t.push([(0,p.t)("Fingerprint values"),e.values]),e.client_values&&t.push([(0,p.t)("Client fingerprint values"),(0,Z.BX)(tt,{children:[e.client_values,(0,Z.tZ)(k.Z,{size:"xs",position:"top",title:(0,p.t)("The client sent a fingerprint that was overridden by a server-side fingerprinting rule.")})]},"type")])}class R extends r.Component{constructor(...t){super(...t),(0,i.Z)(this,"state",{showNonContributing:!1}),(0,i.Z)(this,"handleShowNonContributing",(()=>{this.setState({showNonContributing:!0})})),(0,i.Z)(this,"handleHideNonContributing",(()=>{this.setState({showNonContributing:!1})}))}getVariantData(){var t,e;const{variant:n,showGroupingConfig:i}=this.props,o=[];let r;if(!this.state.showNonContributing&&null===n.hash)return[o,r];switch(null!==n.hash&&o.push([(0,p.t)("Hash"),(0,Z.BX)(tt,{children:[(0,Z.tZ)(et,{children:n.hash}),(0,Z.tZ)(k.Z,{size:"xs",position:"top",title:(0,p.t)("Events with the same hash are grouped together")})]},"hash")]),n.hashMismatch&&o.push([(0,p.t)("Hash mismatch"),(0,p.t)("hashing algorithm produced a hash that does not match the event")]),n.type){case S.bo.COMPONENT:r=n.component,o.push([(0,p.t)("Type"),(0,Z.BX)(tt,{children:[n.type,(0,Z.tZ)(k.Z,{size:"xs",position:"top",title:(0,p.t)("Uses a complex grouping algorithm taking event data into account")})]},"type")]),i&&null!==(t=n.config)&&void 0!==t&&t.id&&o.push([(0,p.t)("Grouping Config"),n.config.id]);break;case S.bo.CUSTOM_FINGERPRINT:o.push([(0,p.t)("Type"),(0,Z.BX)(tt,{children:[n.type,(0,Z.tZ)(k.Z,{size:"xs",position:"top",title:(0,p.t)("Overrides the default grouping by a custom fingerprinting rule")})]},"type")]),J(o,n);break;case S.bo.SALTED_COMPONENT:r=n.component,o.push([(0,p.t)("Type"),(0,Z.BX)(tt,{children:[n.type,(0,Z.tZ)(k.Z,{size:"xs",position:"top",title:(0,p.t)("Uses a complex grouping algorithm taking event data and a fingerprint into account")})]},"type")]),J(o,n),i&&null!==(e=n.config)&&void 0!==e&&e.id&&o.push([(0,p.t)("Grouping Config"),n.config.id])}return r&&o.push([(0,p.t)("Grouping"),(0,Z.tZ)($,{children:(0,Z.tZ)(U,{component:r,showNonContributing:this.state.showNonContributing})},r.id)]),[o,r]}renderTitle(){var t,e;const{variant:n}=this.props,i=null!==n.hash;let o;if(i)o=(0,p.t)("Contributing variant");else{var r;const t=null===(r=n.component)||void 0===r?void 0:r.hint;o=t?(0,p.t)("Non-contributing variant: %s",t):(0,p.t)("Non-contributing variant")}return(0,Z.tZ)(m.Z,{title:o,children:(0,Z.BX)(Q,{children:[(0,Z.tZ)(W,{isContributing:i}),(0,p.t)("By")," ",null!==(t=null===(e=n.description)||void 0===e?void 0:e.split(" ").map((t=>y()(t))).join(" "))&&void 0!==t?t:(0,p.t)("Nothing")]})})}renderContributionToggle(){const{showNonContributing:t}=this.state;return(0,Z.BX)(Y,{merged:!0,active:t?"all":"relevant",children:[(0,Z.tZ)(a.ZP,{barId:"relevant",size:"xsmall",onClick:this.handleHideNonContributing,children:(0,p.t)("Contributing values")}),(0,Z.tZ)(a.ZP,{barId:"all",size:"xsmall",onClick:this.handleShowNonContributing,children:(0,p.t)("All values")})]})}render(){const[t,e]=this.getVariantData();return(0,Z.BX)(q,{children:[(0,Z.BX)(K,{children:[this.renderTitle(),I(e)&&this.renderContributionToggle()]}),(0,Z.tZ)(w.Z,{data:t.map((t=>({key:t[0],subject:t[0],value:t[1]}))),isContextData:!0,isSorted:!1})]})}}R.displayName="GroupVariant";const q=(0,o.Z)("div",{target:"ekctgc27"})("margin-bottom:",(0,d.Z)(4),";"),K=(0,o.Z)("div",{target:"ekctgc26"})("display:flex;align-items:center;justify-content:space-between;margin-bottom:",(0,d.Z)(2),";@media (max-width: ",(t=>t.theme.breakpoints[0]),"){display:block;}"),Q=(0,o.Z)("h5",{target:"ekctgc25"})("font-size:",(t=>t.theme.fontSizeMedium),";margin:0;display:flex;align-items:center;"),W=(0,o.Z)((({isContributing:t,...e})=>t?(0,Z.tZ)(z.DL,{size:"sm",isCircled:!0,color:"green300",...e}):(0,Z.tZ)(z.bM,{size:"sm",isCircled:!0,color:"red300",...e})),{target:"ekctgc24"})("margin-right:",(0,d.Z)(1),";"),Y=(0,o.Z)(x.ZP,{target:"ekctgc23"})("justify-content:flex-end;@media (max-width: ",(t=>t.theme.breakpoints[0]),"){margin-top:",(0,d.Z)(.5),";}"),$=(0,o.Z)("div",{target:"ekctgc22"})("color:",(t=>t.theme.textColor),";"),tt=(0,o.Z)("div",{target:"ekctgc21"})("display:grid;align-items:center;grid-template-columns:max-content min-content;gap:",(0,d.Z)(.5),";"),et=(0,o.Z)("span",{target:"ekctgc20"})("@media (max-width: ",(t=>t.theme.breakpoints[0]),"){",N.Z,";width:210px;}"),nt=R;class it extends s.Z{constructor(...t){super(...t),(0,i.Z)(this,"toggle",(()=>{this.setState((t=>({isOpen:!t.isOpen,configOverride:t.isOpen?null:t.configOverride})))})),(0,i.Z)(this,"handleConfigSelect",(t=>{this.setState({configOverride:t.value},(()=>this.reloadData()))}))}getEndpoints(){var t;const{organization:e,event:n,projectId:i}=this.props;let o="/projects/".concat(e.slug,"/").concat(i,"/events/").concat(n.id,"/grouping-info/");return null!==(t=this.state)&&void 0!==t&&t.configOverride&&(o="".concat(o,"?config=").concat(this.state.configOverride)),[["groupInfo",o]]}getDefaultState(){return{...super.getDefaultState(),isOpen:!1,configOverride:null}}renderGroupInfoSummary(){const{groupInfo:t}=this.state;if(!t)return null;const e=Object.values(t).filter((t=>null!==t.hash&&null!==t.description)).map((t=>t.description)).sort(((t,e)=>t.toLowerCase().localeCompare(e.toLowerCase()))).join(", ");return(0,Z.tZ)(ot,{"data-test-id":"loaded-grouping-info",children:"(".concat((0,p.t)("grouped by")," ").concat(e||(0,p.t)("nothing"),")")})}renderGroupConfigSelect(){const{configOverride:t}=this.state,{event:e}=this.props,n=null!=t?t:e.groupingConfig.id;return(0,Z.tZ)(st,{children:(0,Z.tZ)(v,{eventConfigId:e.groupingConfig.id,configId:n,onSelect:this.handleConfigSelect})})}renderGroupInfo(){const{groupInfo:t,loading:e}=this.state,{showGroupingConfig:n}=this.props,i=t?Object.values(t).sort(((t,e)=>{var n,i,o,r;return t.hash&&!e.hash?-1:null!==(n=null===(i=t.description)||void 0===i?void 0:i.toLowerCase().localeCompare(null!==(o=null===(r=e.description)||void 0===r?void 0:r.toLowerCase())&&void 0!==o?o:""))&&void 0!==n?n:1})):[];return(0,Z.BX)(r.Fragment,{children:[n&&this.renderGroupConfigSelect(),e?(0,Z.tZ)(c.Z,{}):i.map(((t,e)=>(0,Z.BX)(r.Fragment,{children:[(0,Z.tZ)(nt,{variant:t,showGroupingConfig:n}),e<i.length-1&&(0,Z.tZ)(lt,{})]},t.key)))]})}renderLoading(){return this.renderBody()}renderBody(){const{isOpen:t}=this.state,e=(0,Z.BX)(r.Fragment,{children:[(0,p.t)("Event Grouping Information"),!t&&this.renderGroupInfoSummary()]}),n=(0,Z.tZ)(rt,{onClick:this.toggle,priority:"link",children:t?(0,p.t)("Hide Details"):(0,p.t)("Show Details")});return(0,Z.tZ)(l.Z,{type:"grouping-info",title:e,actions:n,children:t&&this.renderGroupInfo()})}}const ot=(0,o.Z)("small",{target:"eno4hz94"})("@media (max-width: ",(t=>t.theme.breakpoints[0]),"){display:block;margin:0!important;}"),rt=(0,o.Z)(a.ZP,{target:"eno4hz93"})("font-weight:700;color:",(t=>t.theme.subText),";&:hover,&:focus{color:",(t=>t.theme.textColor),";}"),st=(0,o.Z)("div",{target:"eno4hz92"})("margin-bottom:",(0,d.Z)(1.5),";margin-top:-",(0,d.Z)(1),";"),at=(0,o.Z)("span",{target:"eno4hz91"})("font-family:",(t=>t.theme.text.familyMono),";opacity:",(t=>t.isHidden?.5:null),";font-weight:",(t=>t.isActive?"bold":null),";font-size:",(t=>t.theme.fontSizeSmall),";"),lt=(0,o.Z)("hr",{target:"eno4hz90"})("padding-top:",(0,d.Z)(1),";border-top:1px solid ",(t=>t.theme.border),";"),ct=(0,h.Z)(it)}}]);
//# sourceMappingURL=../sourcemaps/app_components_events_groupingInfo_index_tsx.84c5d57a94658d5aec8c48c53acdd9bb.js.map