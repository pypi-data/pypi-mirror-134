"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[834],{7673:function(e,n){const t="true",r="false",o="null",c=new Map([["t",t],["f",r],["n",o]]),a=new Map([['"','"'],["\\","\\"],["/","/"],["b","\b"],["n","\n"],["f","\f"],["r","\r"],["t","\t"]]),u=new Map([["[","Punctuator"],["]","Punctuator"],["{","Punctuator"],["}","Punctuator"],[":","Punctuator"],[",","Punctuator"],[t,"Boolean"],[r,"Boolean"],[o,"Null"]]);class s extends Error{constructor(e,{line:n,column:t,index:r}){super(`${e} (${n}:${t})`),this.line=n,this.column=t,this.index=r}}class l extends s{constructor(e,n){super(`Unexpected character ${e} found.`,n)}}class i extends s{constructor(e){super(`Unexpected token ${e.type}(${e.value}) found.`,e.loc.start)}}class f extends s{constructor(e){super("Unexpected end of input found.",e)}}const m={comments:!1,ranges:!1};function p(e){return/[\s\n]/.test(e)}function d(e){return e>="0"&&e<="9"}function v(e){return d(e)||/[a-f]/i.test(e)}function h(e){return/[tfn]/.test(e)}function y(e){return d(e)||"."===e||"-"===e}function g(e,n){n=Object.freeze({...m,...n});let t=-1,r=1,o=0,s=!1;const i=[];function g(e,t,r,o){const c=r.offset+t.length;let a=n.ranges?{range:[r.offset,c]}:void 0;return{type:e,value:t,loc:{start:r,end:o||{line:r.line,column:r.column+t.length,offset:c}},...a}}function b(){let n=e.charAt(++t);return s?(r++,o=1,s=!1):o++,"\r"===n?(s=!0,"\n"===e.charAt(t+1)&&t++):"\n"===n&&(s=!0),n}function w(){return{line:r,column:o,offset:t}}function x(n){let r=c.get(n);if(e.slice(t,t+r.length)===r)return t+=r.length-1,o+=r.length-1,{value:r,c:b()};for(let o=1;o<r.length;o++)r[o]!==e.charAt(t+o)&&k(b())}function j(e){let n=e;for(e=b();e&&'"'!==e;){if("\\"===e)if(n+=e,e=b(),a.has(e))n+=e;else if("u"===e){n+=e;for(let t=0;t<4;t++)v(e=b())?n+=e:k(e)}else k(e);else n+=e;e=b()}return e||I(),n+=e,{value:n,c:b()}}function A(e){let n="";if("-"===e&&(n+=e,d(e=b())||k(e)),"0"===e)n+=e,d(e=b())&&k(e);else{(function(e){return e>="1"&&e<="9"})(e)||k(e);do{n+=e,e=b()}while(d(e))}if("."===e)do{n+=e,e=b()}while(d(e));if("e"===e||"E"===e)for(n+=e,"+"!==(e=b())&&"-"!==e||(n+=e,e=b());d(e);)n+=e,e=b();return{value:n,c:e}}function N(e){let n=e;if("/"===(e=b())){do{n+=e,e=b()}while(e&&"\r"!==e&&"\n"!==e);return{value:n,c:e}}if("*"===e){for(;e;)if(n+=e,"*"===(e=b())&&(n+=e,"/"===(e=b())))return n+=e,{value:n,c:e=b()};I()}k(e)}function k(e){throw new l(e,w())}function I(){throw new f(w())}let C=b();for(;t<e.length;){for(;p(C);)C=b();if(!C)break;const e=w();if(u.has(C))i.push(g(u.get(C),C,e)),C=b();else if(h(C)){const n=x(C);let t=n.value;C=n.c,i.push(g(u.get(t),t,e))}else if(y(C)){const n=A(C);let t=n.value;C=n.c,i.push(g("Number",t,e))}else if('"'===C){const n=j(C);let t=n.value;C=n.c,i.push(g("String",t,e))}else if("/"===C&&n.comments){const n=N(C);let t=n.value;C=n.c,i.push(g(t.startsWith("//")?"LineComment":"BlockComment",t,e,w()))}else k(C)}return i}const b={document:(e,n={})=>({type:"Document",body:e,...n}),string:(e,n={})=>({type:"String",value:e,...n}),number:(e,n={})=>({type:"Number",value:e,...n}),boolean:(e,n={})=>({type:"Boolean",value:e,...n}),null:(e={})=>({type:"Null",value:"null",...e}),array:(e,n={})=>({type:"Array",elements:e,...n}),object:(e,n={})=>({type:"Object",members:e,...n}),member:(e,n,t={})=>({type:"Member",name:e,value:n,...t})},w={tokens:!1,comments:!1,ranges:!1};function x(e){switch(e.type){case"Boolean":return"true"===e.value;case"Number":return Number(e.value);case"Null":return null;case"String":return function(e){let n=e.value.slice(1,-1),t="",r=n.indexOf("\\"),o=0;for(;r>=0;){t+=n.slice(o,r);const c=n.charAt(r+1);if(a.has(c))t+=a.get(c),o=r+2;else{if("u"!==c)throw new s(`Invalid escape \\${c}.`,{line:e.loc.start.line,column:e.loc.start.column+r,offset:e.loc.start.offset+r});{const c=n.slice(r+2,r+6);if(c.length<4||/[^0-9a-f]/i.test(c))throw new s(`Invalid unicode escape \\u${c}.`,{line:e.loc.start.line,column:e.loc.start.column+r,offset:e.loc.start.offset+r});t+=String.fromCharCode(parseInt(c,16)),o=r+6}}r=n.indexOf("\\",o)}return t+=n.slice(o),t}(e)}}const j=new Map([["Document",["body"]],["Object",["members"]],["Member",["name","value"]],["Array",["elements"]],["String",[]],["Number",[]],["Boolean",[]],["Null",[]]]);function A(e){return e&&"object"===typeof e}function N(e){return A(e)&&"string"===typeof e.type}function k(e,n){!function e(t,r){"function"===typeof n.enter&&n.enter(t,r);for(const n of j.get(t.type)){const r=t[n];A(r)&&(Array.isArray(r)?r.forEach((n=>e(n,t))):N(r)&&e(r,t))}"function"===typeof n.exit&&n.exit(t,r)}(e)}function I(e){switch(e.type){case"String":case"Number":case"Boolean":return e.value;case"Null":return null;case"Array":return e.elements.map(I);case"Object":{const n={};return e.members.forEach((e=>{n[I(e.name)]=I(e.value)})),n}case"Document":return I(e.body);case"Property":throw new Error("Cannot evaluate object property outside of an object.");default:throw new Error(`Unknown node type ${e.type}.`)}}n.hZ=function(e,n=(()=>!0)){const t=[];return k(e,{enter(e,n){t.push({node:e,parent:n,phase:"enter"})},exit(e,n){t.push({node:e,parent:n,phase:"exit"})}}),t.filter(n).values()},n.Qc=function(e,n){const t=g(e,{comments:!!(n=Object.freeze({...w,...n})).comments,ranges:!!n.ranges});let r=0;const o=n.comments?function e(){const n=t[r++];return n&&n.type.endsWith("Comment")?e():n}:function(){return t[r++]};function c(e,n){if(!e||e.value!==n)throw new i(e)}function a(e,t){return n.ranges?{range:[e.offset,t.offset]}:void 0}function u(e){const n=a(e.loc.start,e.loc.end);return{type:e.type,value:x(e),loc:{start:{...e.loc.start},end:{...e.loc.end}},...n}}function s(e){!function(e,n){if(!e||e.type!==n)throw new i(e)}(e,"String");const n=u(e);c(e=o(),":");const t=l(),r=a(n.loc.start,t.loc.end);return b.member(n,t,{loc:{start:{...n.loc.start},end:{...t.loc.end}},...r})}function l(e){switch((e=e||o()).type){case"String":case"Boolean":case"Number":case"Null":return u(e);case"Punctuator":if("{"===e.value)return function(e){c(e,"{");const n=[];let t=o();if(t&&"}"!==t.value)do{if(n.push(s(t)),t=o(),","!==t.value)break;t=o()}while(t);c(t,"}");const r=a(e.loc.start,t.loc.end);return b.object(n,{loc:{start:{...e.loc.start},end:{...t.loc.end}},...r})}(e);if("["===e.value)return function(e){c(e,"[");const n=[];let t=o();for(;t&&"]"!==t.value&&(n.push(l(t)),t=o(),","===t.value);)t=o();c(t,"]");const r=a(e.loc.start,t.loc.end);return b.array(n,{type:"Array",elements:n,loc:{start:{...e.loc.start},end:{...t.loc.end}},...r})}(e);default:throw new i(e)}}const f=l(),m=o();if(m)throw new i(m);const p={loc:{start:{line:1,column:1,offset:0},end:{...f.loc.end}}};return n.tokens&&(p.tokens=t),n.ranges&&(p.range=a(p.loc.start,p.loc.end)),b.document(f,p)}},1815:function(e,n,t){t.d(n,{Y:function(){return r}});var r={}},3834:function(e,n,t){t.r(n);var r=t(5666),o=t.n(r),c=t(7673),a=t(9604),u=t(1815);function s(e,n,t,r,o,c,a){try{var u=e[c](a),s=u.value}catch(l){return void t(l)}u.done?n(s):Promise.resolve(s).then(r,o)}function l(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var c=e.apply(n,t);function a(e){s(c,r,o,a,u,"next",e)}function u(e){s(c,r,o,a,u,"throw",e)}a(void 0)}))}}function i(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=[],r=!0,o=!1,c=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(t.push(a.value),!n||t.length!==n);r=!0);}catch(s){o=!0,c=s}finally{try{r||null==u.return||u.return()}finally{if(o)throw c}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function f(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var m="",p=[],d=[],v={};function h(e){return y.apply(this,arguments)}function y(){return(y=l(o().mark((function e(n){var t,r,c,a,u,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.ns,r=n.type,c=n.version,a="namespace=".concat(t,"&type=").concat(r,"&version=").concat(c),!v[a]){e.next=4;break}return e.abrupt("return",v[a]);case 4:return e.next=6,fetch("/api/registry/schema?namespace=".concat(t,"&type=").concat(r,"&version=").concat(c));case 6:if((u=e.sent).ok){e.next=11;break}return e.next=10,u.json();case 10:throw e.sent;case 11:return e.next=13,u.json();case 13:function o(e,n){var t=void 0===n?0:n;0===t&&e.title&&(l+=e.title+"\n\n");var r=e.properties||e.items.properties;r&&Object.keys(r).forEach((function(n){var c,a,u=r[n],s=null===(c=e.required)||void 0===c?void 0:c.find((function(e){return e===n}));l+=(0!==t?" ".repeat(2*t)+"- ":"- ")+"**"+n+"**"+(s?" _(required)_":"")+": `{".concat(u.type,"}` ").concat(null!==(a=u.title)&&void 0!==a?a:"_no description_","\n\n"),"object"===u.type&&o(u,t+1),"array"===u.type&&o(u,t+1)}))}return s=e.sent,l="",o(s),v[a]=l,e.abrupt("return",l);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a._m.init().then(l(o().mark((function e(n){var t,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("/api/registry/namespaces?with-types=true").then(l(o().mark((function e(t){var r,c,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=4;break}return e.next=3,t.json();case 3:throw e.sent;case 4:return e.next=6,t.json();case 6:r=e.sent,c=Object.keys(r),a=[],c.forEach((function(e){var n=r[e];n.types.forEach((function(t){a.push({type:"object",properties:{ns:{description:n.title,enum:[e]},type:{enum:[t.name]},version:{enum:[t.version]}}})}))})),n.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,trailingCommas:"ignore",allowComments:!0,schemas:[{uri:"http://fact-explorer/header-schema.json",fileMatch:["header.json"],schema:{type:"object",properties:{id:{type:"string"},aggIds:{type:"array",items:{type:"string"}},ns:{enum:c},type:{type:"string"},version:{type:"integer"}},anyOf:a}}]});case 11:case"end":return e.stop()}}),e)})))).catch((function(e){console.error("Could not fetch namespaces with types from registry."),console.error(e)})),t="fact-explorer.focusAggId",r="fact-explorer.mergeAggId",n.editor.registerCommand(t,(function(e,n){var r;u.Y.onFocusAggId?null===(r=u.Y.onFocusAggId)||void 0===r||r.call(u.Y,n.aggId):alert('Command "'.concat(t,'" is not handled correctly.'))})),n.editor.registerCommand(r,(function(e,n){var r;u.Y.onMergeAggId?null===(r=u.Y.onMergeAggId)||void 0===r||r.call(u.Y,n.aggId):alert('Command "'.concat(t,'" is not handled correctly.'))})),n.languages.registerHoverProvider("json",{provideHover:function(e,o){if("/result.json"===e.uri.path){var a="".concat(e.id,"-").concat(e.getVersionId());if(a!==m){var u=(0,c.Qc)(e.getValue()),s=[],l=[],v=!0,y=!1,g=void 0;try{for(var b,w=(0,c.hZ)(u,(function(e){return"enter"===e.phase}))[Symbol.iterator]();!(v=(b=w.next()).done);v=!0){var x=b.value,j=x.node;x.parent,x.phase;if("Member"===j.type&&"aggIds"===j.name.value&&"Array"===j.value.type){var A,N=j.value.elements.filter((function(e){return"String"===e.type}));(A=s).push.apply(A,f(N))}if("Object"===j.type&&2===j.members.length&&"header"===j.members[0].name.value&&"payload"===j.members[1].name.value){var k=i(j.members,2),I=k[0],C=k[1],O=I.value.members.find((function(e){return"ns"===e.name.value})).value.value,S=I.value.members.find((function(e){return"type"===e.name.value})).value.value,E=I.value.members.find((function(e){return"version"===e.name.value})).value.value;l.push({node:C,ns:O,type:S,version:E})}}}catch(_){y=!0,g=_}finally{try{v||null==w.return||w.return()}finally{if(y)throw g}}m=a,p=s,d=l}var P=p.find((function(e){return e.loc.start.line===o.lineNumber&&e.loc.end.line===o.lineNumber&&e.loc.start.column<=o.column&&e.loc.end.column>=o.column}));if(P){var M=encodeURIComponent(JSON.stringify({aggId:P.value}));return{range:new n.Range(P.loc.start.line,P.loc.start.column,P.loc.end.line,P.loc.end.column),contents:[{value:"[".concat("Focus","](command:").concat(t,"?").concat(M,' "').concat("Filter for this specific aggId.",'") | [').concat("Add to current filter","](command:").concat(r,"?").concat(M,' "').concat("Adds this specific aggId to the current filter.",'")'),isTrusted:!0}]}}var $=d.find((function(e){var n=e.node;return(n.loc.start.line<o.lineNumber||n.loc.start.line===o.lineNumber&&n.loc.start.column<=o.column)&&(n.loc.end.line>o.lineNumber||n.loc.end.line===o.lineNumber&&n.loc.end.column>=o.column)}));return $?h($).then((function(e){return{range:new n.Range(o.lineNumber,o.column,o.lineNumber,o.column),contents:[{value:e,isTrusted:!0}]}})).catch((function(e){return console.error("Could not fetch schema from registry."),console.error(e),null})):null}}});case 6:case"end":return e.stop()}}),e)}))))}}]);