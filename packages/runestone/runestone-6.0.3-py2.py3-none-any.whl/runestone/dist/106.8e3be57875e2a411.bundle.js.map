{"version":3,"file":"106.8e3be57875e2a411.bundle.js","mappings":"6IAoBe,MAAMA,EACjBC,YAAYC,GACRC,KAAKC,wBAA0B,IAAIC,SAC9BC,GAAaH,KAAKI,4BAA8BD,IAErDH,KAAKK,UAAW,OACoB,IAAzBC,OAAOC,gBACdD,OAAOC,cAAgB,IAE3BD,OAAOC,cAAcC,KAAKR,MACtBD,IACAC,KAAKS,IAAMV,EAAKU,IAChBT,KAAKU,aAAeX,EAAKW,aACzBV,KAAKW,cAAe,EAChBZ,EAAKa,QACLZ,KAAKa,SAAU,GAEfd,EAAKe,kBACLd,KAAKe,SAAWhB,EAAKgB,UAErBC,EAAEjB,EAAKkB,MAAMC,KAAK,YAClBlB,KAAKK,UAAW,EAEhBL,KAAKK,UAAW,EAEhBN,EAAKoB,cACLnB,KAAKmB,YAAcpB,EAAKoB,kBAEQ,IAAzBpB,EAAKqB,gBACZpB,KAAKoB,gBAAkBrB,EAAKqB,gBAG5BpB,KAAKoB,iBAAkB,OAKM,IAAtBrB,EAAKsB,aACZrB,KAAKqB,aAAetB,EAAKsB,aAMrBC,SAASC,KAAKC,QAAQ,iBAAmB,EACzCxB,KAAKqB,aAAeL,EAAE,sBAAsBS,OAE5CzB,KAAKqB,aAAe,KAGxBL,EAAEjB,EAAKkB,MAAMC,KAAK,oBAClBlB,KAAK0B,eAAiBV,EAAEjB,EAAKkB,MAAMC,KAAK,oBAGhDlB,KAAK2B,YAAc,IAAIC,QAAQ,CAC3B,eAAgB,kCAChBC,OAAQ,qBAOhBC,mBAAmBC,GACf,GAAI/B,KAAKU,aACL,OAEJ,IAAIsB,EAkCJ,OAjCAD,EAAUE,YAAcC,YAAYC,OACpCJ,EAAUK,kBAAoBF,YAAYG,WAC1CN,EAAUO,gBAAiB,IAAIC,MAAOC,oBAAsB,GACxDxC,KAAKyC,UACLV,EAAUU,QAAUzC,KAAKyC,SAEzBP,YAAYQ,sBAAwBR,YAAYS,SAAW,IAC3DX,EAAchC,KAAK4C,eAAeb,IAEjC/B,KAAKa,UAAWqB,YAAYW,OAC7BC,QAAQC,IAAI,iBAAmBC,KAAKC,UAAUlB,IAO9C/B,KAAKmB,cACLY,EAAUmB,OAASlD,KAAKmB,YAAYgC,QAChC,0BACA,IAEJpB,EAAUqB,MAAQ,iBAClBrB,EAAUsB,IAAM,cAChBrD,KAAK4C,eAAeb,IAG0B,mBAAvC,oBACU,QAAjBA,EAAUsB,KACO,GAAjBrD,KAAKK,UAEL,mBAAmC0B,EAAUmB,QAE1ClB,EAGXF,qBAAqBC,GACjB,IAAIC,EACJ,IAAIsB,EAAU,IAAIC,QACd,GAAGrB,YAAYsB,qCACf,CACIC,OAAQ,OACRC,QAAS1D,KAAK2B,YACdgC,KAAMX,KAAKC,UAAUlB,KAG7B,IACI,IAAI6B,QAAiBC,MAAMP,GAC3B,IAAKM,EAASE,GACV,MAAM,IAAIC,MAAM,gCAEpB/B,EAAc4B,EAASI,OACzB,MAAOC,GACDjE,KAAKa,SACLqD,MAAM,mDAAmDD,KAE7DnB,QAAQC,IAAI,UAAUkB,KAE1B,OAAOjC,EAOXF,kBAAkBC,GACd,IAAIoC,EAAe,OACnB,IAAInE,KAAKU,aAAT,CASA,GANAqB,EAAUI,OAASD,YAAYC,OAC/BJ,EAAUK,kBAAoBF,YAAYG,WAC1CN,EAAUO,gBAAiB,IAAIC,MAAOC,oBAAsB,IACxDxC,KAAKoE,WAAa,YAAarC,GAAc,KAC7CA,EAAUsC,UAAY,QAEtBnC,YAAYQ,sBAAwBR,YAAYS,SAAW,EAAG,CAC9D,IAAIW,EAAU,IAAIC,QACd,GAAGrB,YAAYsB,kCACf,CACIC,OAAQ,OACRC,QAAS1D,KAAK2B,YACdgC,KAAMX,KAAKC,UAAUlB,KAGzB6B,QAAiBC,MAAMP,GAC3B,IAAKM,EAASE,GACV,MAAM,IAAIC,MAAM,yBAEpBI,QAAqBP,EAASI,OAWlC,OATKhE,KAAKa,UAAWqB,YAAYW,OAC7BC,QAAQC,IAAI,WAAaC,KAAKC,UAAUlB,IAGM,mBAAvC,oBACU,GAAjB/B,KAAKK,UAEL,mBAAmC0B,EAAUmB,QAE1CiB,GAQXrC,kBAEIC,EAIAuC,GAAgB,GAGhB,IAAIC,EAAOvE,KAIX,GAHAA,KAAKwE,oBAAsB,IAAItE,SAAQ,SAAUC,EAASsE,GACtDF,EAAKG,WAAavE,KAElBH,KAAK0C,sBAAwB1C,KAAKU,aAAc,CAChD,IAAIQ,EAAO,GAcX,GAbAA,EAAKgC,OAASlD,KAAK2E,MACnBzD,EAAKiB,OAASD,YAAYC,OAC1BjB,EAAKkC,MAAQrB,EACT/B,KAAKU,cAAgBV,KAAKe,WAC1BG,EAAKH,SAAWf,KAAKe,SACrBG,EAAK0D,YAAc5E,KAAK4E,YACxB1D,EAAK2D,MAAQ7E,KAAK6E,OAElB7E,KAAKS,MACLS,EAAKT,IAAMT,KAAKS,KAKfyB,YAAY4C,eACZ5C,YAAY6C,OACb/E,KAAKoB,gBAgCLpB,KAAKgF,SAAS,IACdhF,KAAK0E,WAAW,iBAhClB,CACE,IAAIpB,EAAU,IAAIC,QACd,GAAGrB,YAAYsB,uCACf,CACIC,OAAQ,OACRE,KAAMX,KAAKC,UAAU/B,GACrBwC,QAAS1D,KAAK2B,cAGtB,IACI,IAAIiC,QAAiBC,MAAMP,GACvBM,EAASE,IACT5C,QAAa0C,EAASI,OACtB9C,EAAOA,EAAK+D,OACZjF,KAAKkF,sBAAsBhE,GAC3BlB,KAAK0E,WAAW,YAEhB5B,QAAQC,IACJ,+BAA+Ba,EAASuB,cAE5CnF,KAAKoF,oBACLpF,KAAK0E,WAAW,UAEtB,MAAOW,GACL,IACIrF,KAAKoF,oBACP,MAAOC,GACLvC,QAAQC,IAAIsC,WAQxBrF,KAAKoF,oBACLpF,KAAK0E,WAAW,SAGhBJ,GACAtE,KAAKsF,2BAKbA,2BAEItF,KAAKuF,aAAaC,UAAUC,IAAI,6BAEhCzF,KAAKI,8BAGT4E,SAAS9D,GAGL,OAAO,KAaXgE,sBAAsBhE,GAEL,OAATA,GAA0B,YAATA,GAAsBlB,KAAK0F,gBAAgBxE,IAC5DlB,KAAK2F,eAAezE,GACpBlB,KAAK4F,gBAAgB1E,IAErBlB,KAAKoF,oBAGbM,gBAAgBxE,GAEZ,GACqB,MAAjBA,EAAK2E,SACmB,IAAxBC,aAAaC,SACS,IAAtB/F,KAAKU,cACLV,KAAKa,QAEL,OAAO,EAEX,IAIImF,EAJAC,EAAKH,aAAaI,QAAQlG,KAAKmG,mBACnC,GAAW,OAAPF,EACA,OAAO,EAGX,IACID,EAAahD,KAAKoD,MAAMH,GAC1B,MAAOZ,GAKL,OAHAvC,QAAQC,IAAIsC,EAAIgB,SAChBP,aAAaQ,WAAWtG,KAAKmG,oBAEtB,EAEX,GAAIjF,EAAKqF,QAAUP,EAAWO,OAAQ,OAAO,EAC7C,IAAIC,EAAc,IAAIjE,KAAKyD,EAAWS,WAEtC,OADiB,IAAIlE,KAAKrB,EAAKuF,YACVD,EAGzBL,kBACI,OACIjE,YAAYwE,MACZ,IACAxE,YAAYC,OACZ,IACAnC,KAAK2E,MACL,SAGRgC,WAAWC,GAEP,IAAK5G,KAAKa,QAAS,CACf,IAAIgG,EAASC,SAASC,cAAc,KAChC/G,KAAK0B,gBACL1B,KAAKgH,QAAU,aAAahH,KAAK0B,kBAAkB1B,KAAKgH,mDAAmDhH,KAAK2E,gBAChH3D,EAAE6F,GAAQI,KAAKjH,KAAKgH,SACpBhG,EAAE6F,GAAQK,SAAS,GAAGN,eAEtB5F,EAAE6F,GAAQI,KAAKjH,KAAKgH,QAAU,KAAOhH,KAAK2E,MAAQ,KAClD3D,EAAE6F,GAAQK,SAAS,GAAGN,aACtB5F,EAAE6F,GAAQK,SAAS,GAAGN,mBAE1B5G,KAAK6G,OAASA,EAEd7G,KAAKuF,aAAa4B,YAAYN,IAItCO,kBACI,OAAOpH,KAAKqH,WAGhBC,qBACIxE,QAAQC,IACJ,yEAIRjB,yBACIgB,QAAQC,IACJ,uEAGRwE,iBACIzE,QAAQC,IACJ,qEAGRyE,qBACI1E,QAAQC,IACJ,yEAIR0E,WACI,MAAO,GAAGzH,KAAKF,YAAY4H,SAAS1H,KAAK2E,QAG7CgD,aAAaC,GAC+B,MAApCC,QAAQC,QAAQC,UAAU,EAAG,GAC7BF,QAAQG,IAAIC,MAAM,CAAC,UAAWJ,QAAQG,IAAKJ,IAE3CC,QAAQK,eAAe,CAACN,KAKpCtH,OAAOT,cAAgBA,G,WCnZvBmB,EAAEmH,OAAOC,KAAK,CACVC,GAAI,CACAC,cAAe,sBACfC,kBAAmB,WACnBC,oBAAqB,iB,WCJ7BxH,EAAEmH,OAAOC,KAAK,CACV,QAAS,CACLE,cAAe,yBACfC,kBAAmB,YACnBC,oBAAqB,e,yECOlBC,G,kBAAW,IAGP,MAAMC,UAAa,IAC9B5I,YAAYC,GACR4I,MAAM5I,GACN,IAAIkB,EAAOlB,EAAKkB,KAChBjB,KAAK0C,qBAAuB3C,EAAK2C,qBACjC1C,KAAK4I,SAAW3H,EAChBjB,KAAK2E,MAAQ1D,EAAK4H,GAClB7I,KAAK6F,QAAU,KAIf7F,KAAK8I,cAAgB9F,KAAKoD,MACtBpG,KAAK+I,eAAe/I,KAAK4I,UAAU3B,QAEvCjH,KAAKgJ,oBACLhJ,KAAKgH,QAAU,oBACfhH,KAAK2G,WAAW,aAChB3G,KAAKiJ,YAAY,SAAS,GAG9BF,eAAeG,GACX,OAAOlI,EAAEkI,GAAWC,KAAK,mCAK7BH,oBACIhJ,KAAKoJ,kBACLpJ,KAAKqJ,oBACLrJ,KAAKsJ,wBAELtI,EAAEhB,KAAK4I,UAAUW,YAAYvJ,KAAKuF,cAEtC6D,kBAEIpJ,KAAKuF,aAAeuB,SAASC,cAAc,OAC3C/F,EAAEhB,KAAKuF,cAAc2B,SAAS,uBAC9BlH,KAAKuF,aAAasD,GAAK7I,KAAK2E,MAE5B3D,EAAEhB,KAAK4I,UAAUY,WAAWC,QAAQC,SAAS1J,KAAKuF,cAElDvF,KAAK+I,eAAe/I,KAAKuF,cAAcoE,SAEvC,IAAIC,EAAK5I,EAAEhB,KAAKuF,cAAc4D,KAAK,UACnCS,EAAGC,KAAK,QAAS,qCACjBD,EAAGC,KAAK,aAAc,cACtB7J,KAAK8J,WAAaF,EAAGG,UAIrB,IAAK,IAAIC,KAAShK,KAAK8J,WACnB9I,EAAEgJ,GAAOC,OAAOjK,KAAKkK,eAAeC,KAAKnK,OAIjDkK,iBACIlK,KAAKqH,YAAa,EAKtBgC,oBAEIrJ,KAAKoK,aAAetD,SAASC,cAAc,UAC3C/G,KAAKoK,aAAaC,YAAcrJ,EAAEmH,KAAK,qBACvCnH,EAAEhB,KAAKoK,cAAcP,KAAK,CACtBS,MAAO,kBACP5C,KAAM,YACN6C,KAAM,WAEVvK,KAAKoK,aAAaI,iBACd,QACA,WACIxK,KAAKsH,qBACLtH,KAAKyK,oBACPN,KAAKnK,OACP,GAEJA,KAAKuF,aAAa4B,YAAYL,SAASC,cAAc,OACrD/G,KAAKuF,aAAa4B,YAAYL,SAASC,cAAc,OACrD/G,KAAKuF,aAAa4B,YAAYnH,KAAKoK,cAC/BpK,KAAK0C,uBACL1C,KAAK0K,cAAgB5D,SAASC,cAAc,UAC5C/F,EAAEhB,KAAK0K,eAAeb,KAAK,CACvBS,MAAO,kBACPzB,GAAI7I,KAAK4I,SAASC,GAAK,SACvB8B,SAAU,GACVjD,KAAM,YAEV1H,KAAK0K,cAAcL,YAAcrJ,EAAEmH,KAAK,uBACxCnI,KAAK0K,cAAcF,iBACf,QACA,WACIxK,KAAK4K,sBACPT,KAAKnK,OACP,GAEJA,KAAKuF,aAAa4B,YAAYnH,KAAK0K,gBAEvC1K,KAAKuF,aAAa4B,YAAYL,SAASC,cAAc,QAEzDuC,wBACItJ,KAAK6K,YAAc/D,SAASC,cAAc,OAC1C/G,KAAK6K,YAAYhC,GAAK7I,KAAK2E,MAAQ,YACnC3E,KAAKuF,aAAa4B,YAAYL,SAASC,cAAc,OACrD/G,KAAKuF,aAAa4B,YAAYnH,KAAK6K,aAKvClF,eAAezE,GACX,IAAI4J,EAEJ,IAII,GAFAA,EAAM9H,KAAKoD,MAAMlF,EAAKqF,SAEjBwE,MAAMC,QAAQF,GACf,MAAM,IAAI/G,MAEhB,MAAOsB,GAELyF,EAAM5J,EAAKqF,OAAO0E,MAAM,KAE5B,IAAK,IAAIC,EAAI,EAAGA,EAAIlL,KAAK8J,WAAW/D,OAAQmF,IACxClK,EAAEhB,KAAK8J,WAAWoB,IAAIrB,KAAK,QAASiB,EAAII,IAGvClL,KAAK8I,cAaN9I,KAAKsH,sBAZLtH,KAAKmL,YAAcjK,EAAKiK,YACxBnL,KAAK6F,QAAU3E,EAAK2E,QACpB7F,KAAKoL,eAAiBlK,EAAKkK,oBAGK,IAArBpL,KAAKmL,kBACY,IAAjBnL,KAAK6F,cACmB,IAAxB7F,KAAKoL,gBAEZpL,KAAKuH,kBAMjBnC,oBAEI,IAAIY,EACJ,IAAIhG,KAAKU,cAGCoF,aAAaC,OACb,EAAG,CACT,IAAIE,EAAKH,aAAaI,QAAQlG,KAAKmG,mBACnC,GAAW,OAAPF,EAAa,CACb,KACID,EAAahD,KAAKoD,MAAMH,IACHM,OACvB,MAAOlB,GAIL,OAFAvC,QAAQC,IAAIsC,EAAIgB,cAChBP,aAAaQ,WAAWtG,KAAKmG,mBAGjCnG,KAAK2F,eAAeK,KAIhCJ,gBAAgB1E,GACZ,IAAImK,EAAMrL,KAAKmG,kBACfL,aAAawF,QAAQD,EAAKrI,KAAKC,UAAU/B,IAG7CoG,qBAEItH,KAAKoL,eAAiB,GACtBpL,KAAKmL,YAAc,GACnBnL,KAAKuL,UAAY,GACjB,IAAK,IAAIL,EAAI,EAAGA,EAAIlL,KAAK8J,WAAW/D,OAAQmF,IACxClL,KAAKuL,UAAU/K,KAAKR,KAAK8J,WAAWoB,GAAGM,OACvCxL,KAAK0C,sBACDR,YAAYuJ,iBACZzL,KAAK0L,sBAIT1L,KAAK8I,gBACL9I,KAAK2L,kBACA3L,KAAKa,SACNb,KAAKuH,kBAKjBzF,uBAAuBrB,GACnB,IAAI8F,EAASvD,KAAKC,UAAUjD,KAAKuL,WAE7BK,GAAW,EACf5L,KAAK4F,gBAAgB,CACjBW,OAAQA,EACRE,UAAW,IAAIlE,OAEnB,IAAIrB,EAAO,CACPkC,MAAO,QACPC,IAAKkD,EACLA,OAAQA,EACRV,QAAS7F,KAAK6F,QAAU,IAAM,IAC9B3C,OAAQlD,KAAK2E,OAQjB,QANmB,IAARlE,IACPS,EAAKT,IAAMA,EACXmL,GAAW,GAEf1K,QAAalB,KAAK6L,aAAa3K,GAC/BA,EAAOA,EAAK+D,OACP2G,EAcL,OAbK5L,KAAK8I,gBAEN9I,KAAK4F,gBAAgB,CACjBW,OAAQA,EACRE,UAAWvF,EAAKuF,YAEpBzG,KAAK6F,QAAU3E,EAAK2E,QACpB7F,KAAKmL,YAAcjK,EAAKiK,YACxBnL,KAAKoL,eAAiBlK,EAAKkK,eACtBpL,KAAKa,SACNb,KAAKuH,kBAGNrG,EAiBXyK,kBAEI3L,KAAK6F,SAAU,EACf,IAAK,IAAIqF,EAAI,EAAGA,EAAIlL,KAAK8J,WAAW/D,OAAQmF,IAAK,CAC7C,IAAIY,EAAQ9L,KAAK8J,WAAWoB,GAAGM,MAE/B,GAAc,KAAVM,EACA9L,KAAKoL,eAAe5K,KAAK,MACzBR,KAAKmL,YAAY3K,KAAKQ,EAAEmH,KAAK,kBAC7BnI,KAAK6F,SAAU,MACZ,CAGH,IADA,IAAIkG,EAAM/L,KAAK8I,cAAcoC,IAAM,GAC1Bc,EAAI,EAAGA,EAAID,EAAIhG,OAAQiG,IAAK,CAEjC,GAAIA,IAAMD,EAAIhG,OAAS,EAAG,CACtB/F,KAAKmL,YAAY3K,KAAKuL,EAAIC,GAAa,UACvC,MAGJ,GAAI,UAAWD,EAAIC,IAKf,GAJWC,OACPF,EAAIC,GAAU,MACdD,EAAIC,GAAe,YAEdE,KAAKJ,GAAQ,CAClB9L,KAAKmL,YAAY3K,KAAKuL,EAAIC,GAAa,UACvC,WAED,CAEHlJ,QAAQqJ,OAAO,WAAYJ,EAAIC,IAC/B,IAAKI,EAAKC,GAAON,EAAIC,GAAW,OAE5BM,GAAUR,EACd,GAAIQ,GAAUF,GAAOE,GAAUD,EAAK,CAChCrM,KAAKmL,YAAY3K,KAAKuL,EAAIC,GAAa,UACvC,QAKZ,IAAIO,EAAmB,IAANP,GAAWD,EAAIhG,OAAS,EACzC/F,KAAKoL,eAAe5K,KAAK+L,GACpBA,IACDvM,KAAK6F,SAAU,IAI3B7F,KAAKyC,QACDzC,KAAKoL,eAAeoB,OAAOC,SAAS1G,OAAS/F,KAAK8J,WAAW/D,OAGrEwB,iBACI,GAAIvH,KAAK6F,QAAS,CACd7E,EAAEhB,KAAK6K,aAAahB,KAAK,QAAS,oBAClC,IAAK,IAAImC,EAAI,EAAGA,EAAIhM,KAAK8J,WAAW/D,OAAQiG,IACxChL,EAAEhB,KAAK8J,WAAWkC,IAAIU,YAAY,8BAEnC,CACsB,OAArB1M,KAAKmL,cACLnL,KAAKmL,YAAc,IAEvB,IAAK,IAAIa,EAAI,EAAGA,EAAIhM,KAAK8J,WAAW/D,OAAQiG,KACT,IAA3BhM,KAAKoL,eAAeY,GACpBhL,EAAEhB,KAAK8J,WAAWkC,IAAI9E,SAAS,0BAE/BlG,EAAEhB,KAAK8J,WAAWkC,IAAIU,YAAY,0BAG1C1L,EAAEhB,KAAK6K,aAAahB,KAAK,QAAS,sBAGtC,IADA,IAAI8C,EAAgB,OACXzB,EAAI,EAAGA,EAAIlL,KAAKmL,YAAYpF,OAAQmF,IACzCyB,GAAiB,OAAS3M,KAAKmL,YAAYD,GAAK,QAEpDyB,GAAiB,QAEc,GAA3B3M,KAAKmL,YAAYpF,SACjB4G,EAAgBA,EAAcC,MAC1B,WAAW7G,QACV,aAAaA,SAGtB/F,KAAK6K,YAAYgC,UAAYF,EACN,oBAAZ9E,SACP7H,KAAK2H,aAAab,SAASnD,MAOnC+H,sBACI1L,KAAK0K,cAAcC,UAAW,EAGlCC,qBACI,IAAI1J,EAAO,GACXA,EAAKgC,OAASlD,KAAK2E,MACnBzD,EAAKiB,OAASD,YAAYC,OAC1B2K,OAAOC,IACH,GAAG7K,YAAYsB,+CACftC,EACAlB,KAAKgN,aAGbA,YAAY9L,EAAM+L,EAAQC,GACtB,IAAIC,EAAUjM,EAAK+D,OAAOmI,IAEtBzJ,GADOzC,EAAK+D,OAAOoI,SACZ,WAEX,IAAK,IAAIC,KADT3J,GAAQ,yCACQwJ,EACZxJ,GACI,WACAwJ,EAAQG,GAAK/G,OACb,YACA4G,EAAQG,GAAKC,MACb,mBAER5J,GAAQ,WAeC3C,EAbL,0WAQA2C,EARA,oDAcD6J,QAGPhG,qBACI,IAAK,IAAI0D,EAAI,EAAGA,EAAIlL,KAAK8J,WAAW/D,OAAQmF,IACxClL,KAAK8J,WAAWoB,GAAGP,UAAW,GAS1C3J,EAAE8F,UAAUqD,KAAK,4BAA4B,WACzCnJ,EAAE,mCAAmCyM,MAAK,SAAUC,GAChD,IAAI3N,EAAO,CACPkB,KAAMjB,KACN0C,qBAAsBR,YAAYQ,sBAEtC,GAAkE,GAA9D1B,EAAEhB,MAAM2N,QAAQ,oCAAoC5H,OAEpD,IACI0C,EAASzI,KAAK6I,IAAM,IAAIH,EAAK3I,GAC/B,MAAOsF,GACLvC,QAAQC,IACJ,6CAA6C/C,KAAK6I,qCACtCxD,YCrajB,MAAMuI,UAAkBlF,EACnC5I,YAAYC,GACR4I,MAAM5I,GACNC,KAAK6N,gBAAgB7N,KAAK8N,UAC1B9N,KAAK+N,cACL/N,KAAKgO,uBAAwB,EAEjCD,cACI/M,EAAEhB,KAAKoK,cAAc6D,OACrBjN,EAAEhB,KAAK0K,eAAeuD,OAE1BJ,gBAAgBjG,GAGZ,IAAIsG,EAAcpH,SAASC,cAAc,OACrCoH,EAAWrH,SAASC,cAAc,OACtC/F,EAAEmN,GAAUtE,KAAK,CACbuE,IAAK,uBACLC,MAAO,2BAEXH,EAAYI,UAAY,UACxBJ,EAAYK,MAAQ,GACpBL,EAAY/G,YAAYgH,GACxBnN,EAAE4G,GAAW4G,QAAQN,GAEzBO,oBAEI,OAAQzO,KAAK6F,SACT,KAAK,EACD,MAAO,IACX,KAAK,EACD,MAAO,IACX,QACI,OAAO,MAGnB6I,eACI,IAAK,IAAIxD,EAAI,EAAGA,EAAIlL,KAAK8J,WAAW/D,OAAQmF,IACxClK,EAAEhB,KAAK8J,WAAWoB,IAAIwB,YAAY,0BAEtC1M,KAAK6K,YAAYwD,MAAMM,QAAU,OAGrCC,wBACI,IAAK,IAAI5E,KAAShK,KAAK8J,WACnB9I,EAAEgJ,GAAOC,OAAOjK,KAAKkK,eAAeC,KAAKnK,aAKb,IAA7BM,OAAOuO,oBACdvO,OAAOuO,kBAAoB,IAE/BvO,OAAOuO,kBAAkBC,eAAiB,SAAU/O,GAChD,OAAIA,EAAKa,MACE,IAAIgN,EAAU7N,GAElB,IAAI2I,EAAK3I","sources":["webpack://WebComponents/./runestone/common/js/runestonebase.js","webpack://WebComponents/./runestone/fitb/js/fitb-i18n.en.js","webpack://WebComponents/./runestone/fitb/js/fitb-i18n.pt-br.js","webpack://WebComponents/./runestone/fitb/js/fitb.js","webpack://WebComponents/./runestone/fitb/js/timedfitb.js"],"sourcesContent":["/* ********************************\n * |docname| - Runestone Base Class\n * ********************************\n * All runestone components should inherit from RunestoneBase. In addition all runestone components should do the following things:\n *\n * 1.   Ensure that they are wrapped in a div with the class runestone\n * 2.   Write their source AND their generated html to the database if the database is configured\n * 3.   Properly save and restore their answers using the checkServer mechanism in this base class. Each component must provide an implementation of:\n *\n *      -    checkLocalStorage\n *      -    setLocalStorage\n *      -    restoreAnswers\n *      -    disableInteraction\n *\n * 4.   provide a Selenium based unit test\n */\n\nimport { pageProgressTracker } from \"./bookfuncs.js\";\n//import \"./../styles/runestone-custom-sphinx-bootstrap.css\";\n\nexport default class RunestoneBase {\n    constructor(opts) {\n        this.component_ready_promise = new Promise(\n            (resolve) => (this._component_ready_resolve_fn = resolve)\n        );\n        this.optional = false;\n        if (typeof window.allComponents === \"undefined\") {\n            window.allComponents = [];\n        }\n        window.allComponents.push(this);\n        if (opts) {\n            this.sid = opts.sid;\n            this.graderactive = opts.graderactive;\n            this.showfeedback = true;\n            if (opts.timed) {\n                this.isTimed = true;\n            }\n            if (opts.enforceDeadline) {\n                this.deadline = opts.deadline;\n            }\n            if ($(opts.orig).data(\"optional\")) {\n                this.optional = true;\n            } else {\n                this.optional = false;\n            }\n            if (opts.selector_id) {\n                this.selector_id = opts.selector_id;\n            }\n            if (typeof opts.assessmentTaken !== \"undefined\") {\n                this.assessmentTaken = opts.assessmentTaken;\n            } else {\n                // default to true as this opt is only provided from a timedAssessment\n                this.assessmentTaken = true;\n            }\n            // This is for the selectquestion points\n            // If a selectquestion is part of a timed exam it will get\n            // the timedWrapper options.\n            if (typeof opts.timedWrapper !== \"undefined\") {\n                this.timedWrapper = opts.timedWrapper;\n            } else {\n                // However sometimes selectquestions\n                // are used in regular assignments.  The hacky way to detect this\n                // is to look for doAssignment in the URL and then grab\n                // the assignment name from the heading.\n                if (location.href.indexOf(\"doAssignment\") >= 0) {\n                    this.timedWrapper = $(\"h1#assignment_name\").text();\n                } else {\n                    this.timedWrapper = null;\n                }\n            }\n            if ($(opts.orig).data(\"question_label\")) {\n                this.question_label = $(opts.orig).data(\"question_label\");\n            }\n        }\n        this.jsonHeaders = new Headers({\n            \"Content-type\": \"application/json; charset=utf-8\",\n            Accept: \"application/json\",\n        });\n    }\n\n    // _`logBookEvent`\n    //----------------\n    // This function sends the provided ``eventInfo`` to the `hsblog endpoint` of the server. Awaiting this function returns either ``undefined`` (if Runestone services are not available) or the data returned by the server as a JavaScript object (already JSON-decoded).\n    async logBookEvent(eventInfo) {\n        if (this.graderactive) {\n            return;\n        }\n        let post_return;\n        eventInfo.course_name = eBookConfig.course;\n        eventInfo.clientLoginStatus = eBookConfig.isLoggedIn;\n        eventInfo.timezoneoffset = new Date().getTimezoneOffset() / 60;\n        if (this.percent) {\n            eventInfo.percent = this.percent;\n        }\n        if (eBookConfig.useRunestoneServices && eBookConfig.logLevel > 0) {\n            post_return = this.postLogMessage(eventInfo);\n        }\n        if (!this.isTimed || eBookConfig.debug) {\n            console.log(\"logging event \" + JSON.stringify(eventInfo));\n        }\n        // When selectquestions are part of an assignment especially toggle questions\n        // we need to count using the selector_id of the select question.\n        // We  also need to log an event for that selector so that we will know\n        // that interaction has taken place.  This is **independent** of how the\n        // autograder will ultimately grade the question!\n        if (this.selector_id) {\n            eventInfo.div_id = this.selector_id.replace(\n                \"-toggleSelectedQuestion\",\n                \"\"\n            );\n            eventInfo.event = \"selectquestion\";\n            eventInfo.act = \"interaction\";\n            this.postLogMessage(eventInfo);\n        }\n        if (\n            typeof pageProgressTracker.updateProgress === \"function\" &&\n            eventInfo.act != \"edit\" &&\n            this.optional == false\n        ) {\n            pageProgressTracker.updateProgress(eventInfo.div_id);\n        }\n        return post_return;\n    }\n\n    async postLogMessage(eventInfo) {\n        var post_return;\n        let request = new Request(\n            `${eBookConfig.new_server_prefix}/logger/bookevent`,\n            {\n                method: \"POST\",\n                headers: this.jsonHeaders,\n                body: JSON.stringify(eventInfo),\n            }\n        );\n        try {\n            let response = await fetch(request);\n            if (!response.ok) {\n                throw new Error(\"Failed to save the log entry\");\n            }\n            post_return = response.json();\n        } catch (e) {\n            if (this.isTimed) {\n                alert(`Error: Your action was not saved! The error was ${e}`);\n            }\n            console.log(`Error: ${e}`);\n        }\n        return post_return;\n    }\n    // .. _logRunEvent:\n    //\n    // logRunEvent\n    // -----------\n    // This function sends the provided ``eventInfo`` to the `runlog endpoint`. When awaited, this function returns the data (decoded from JSON) the server sent back.\n    async logRunEvent(eventInfo) {\n        let post_promise = \"done\";\n        if (this.graderactive) {\n            return;\n        }\n        eventInfo.course = eBookConfig.course;\n        eventInfo.clientLoginStatus = eBookConfig.isLoggedIn;\n        eventInfo.timezoneoffset = new Date().getTimezoneOffset() / 60;\n        if (this.forceSave || \"to_save\" in eventInfo === false) {\n            eventInfo.save_code = \"True\";\n        }\n        if (eBookConfig.useRunestoneServices && eBookConfig.logLevel > 0) {\n            let request = new Request(\n                `${eBookConfig.new_server_prefix}/logger/runlog`,\n                {\n                    method: \"POST\",\n                    headers: this.jsonHeaders,\n                    body: JSON.stringify(eventInfo),\n                }\n            );\n            let response = await fetch(request);\n            if (!response.ok) {\n                throw new Error(\"Failed to log the run\");\n            }\n            post_promise = await response.json();\n        }\n        if (!this.isTimed || eBookConfig.debug) {\n            console.log(\"running \" + JSON.stringify(eventInfo));\n        }\n        if (\n            typeof pageProgressTracker.updateProgress === \"function\" &&\n            this.optional == false\n        ) {\n            pageProgressTracker.updateProgress(eventInfo.div_id);\n        }\n        return post_promise;\n    }\n    /* Checking/loading from storage\n    **WARNING:**  DO NOT `await` this function!\n    This function, although async, does not explicitly resolve its promise by returning a value.  The reason for this is because it is called by the constructor for nearly every component.  In Javascript constructors cannot be async!\n\n    One of the recommended ways to handle the async requirements from within a constructor is to use an attribute as a promise and resolve that attribute at the appropriate time.\n    */\n    async checkServer(\n        // A string specifying the event name to use for querying the :ref:`getAssessResults` endpoint.\n        eventInfo,\n        // If true, this function will invoke ``indicate_component_ready()`` just before it returns. This is provided since most components are ready after this function completes its work.\n        //\n        // TODO: This defaults to false, to avoid causing problems with any components that haven't been updated and tested. After all Runestone components have been updated, default this to true and remove the extra parameter from most calls to this function.\n        will_be_ready = false\n    ) {\n        // Check if the server has stored answer\n        let self = this;\n        this.checkServerComplete = new Promise(function (resolve, reject) {\n            self.csresolver = resolve;\n        });\n        if (this.useRunestoneServices || this.graderactive) {\n            let data = {};\n            data.div_id = this.divid;\n            data.course = eBookConfig.course;\n            data.event = eventInfo;\n            if (this.graderactive && this.deadline) {\n                data.deadline = this.deadline;\n                data.rawdeadline = this.rawdeadline;\n                data.tzoff = this.tzoff;\n            }\n            if (this.sid) {\n                data.sid = this.sid;\n            }\n            // If we are NOT in practice mode and we are not in a peer exercise\n            // and assessmentTaken is true\n            if (\n                !eBookConfig.practice_mode &&\n                !eBookConfig.peer &&\n                this.assessmentTaken\n            ) {\n                let request = new Request(\n                    `${eBookConfig.new_server_prefix}/assessment/results`,\n                    {\n                        method: \"POST\",\n                        body: JSON.stringify(data),\n                        headers: this.jsonHeaders,\n                    }\n                );\n                try {\n                    let response = await fetch(request);\n                    if (response.ok) {\n                        data = await response.json();\n                        data = data.detail;\n                        this.repopulateFromStorage(data);\n                        this.csresolver(\"server\");\n                    } else {\n                        console.log(\n                            `HTTP Error getting results: ${response.statusText}`\n                        );\n                        this.checkLocalStorage(); // just go right to local storage\n                        this.csresolver(\"local\");\n                    }\n                } catch (err) {\n                    try {\n                        this.checkLocalStorage();\n                    } catch (err) {\n                        console.log(err);\n                    }\n                }\n            } else {\n                this.loadData({});\n                this.csresolver(\"not taken\");\n            }\n        } else {\n            this.checkLocalStorage(); // just go right to local storage\n            this.csresolver(\"local\");\n        }\n\n        if (will_be_ready) {\n            this.indicate_component_ready();\n        }\n    }\n\n    // This method assumes that ``this.componentDiv`` refers to the ``div`` containing the component, and that this component's ID is set.\n    indicate_component_ready() {\n        // Add a class to indicate the component is now ready.\n        this.containerDiv.classList.add(\"runestone-component-ready\");\n        // Resolve the ``this.component_ready_promise``.\n        this._component_ready_resolve_fn();\n    }\n\n    loadData(data) {\n        // for most classes, loadData doesn't do anything. But for Parsons, and perhaps others in the future,\n        // initialization can happen even when there's no history to be loaded\n        return null;\n    }\n\n    /**\n     * repopulateFromStorage is called after a successful API call is made to ``getAssessResults`` in\n     * the checkServer method in this class\n     *\n     * ``restoreAnswers,`` ``setLocalStorage`` and ``checkLocalStorage`` are defined in the child classes.\n     *\n     * @param {*} data - a JSON object representing the data needed to restore a previous answer for a component\n     * @param {*} status - the http status\n     * @param {*} whatever - ignored\n     */\n    repopulateFromStorage(data) {\n        // decide whether to use the server's answer (if there is one) or to load from storage\n        if (data !== null && data !== \"no data\" && this.shouldUseServer(data)) {\n            this.restoreAnswers(data);\n            this.setLocalStorage(data);\n        } else {\n            this.checkLocalStorage();\n        }\n    }\n    shouldUseServer(data) {\n        // returns true if server data is more recent than local storage or if server storage is correct\n        if (\n            data.correct === \"T\" ||\n            localStorage.length === 0 ||\n            this.graderactive === true ||\n            this.isTimed\n        ) {\n            return true;\n        }\n        let ex = localStorage.getItem(this.localStorageKey());\n        if (ex === null) {\n            return true;\n        }\n        let storedData;\n        try {\n            storedData = JSON.parse(ex);\n        } catch (err) {\n            // error while parsing; likely due to bad value stored in storage\n            console.log(err.message);\n            localStorage.removeItem(this.localStorageKey());\n            // definitely don't want to use local storage here\n            return true;\n        }\n        if (data.answer == storedData.answer) return true;\n        let storageDate = new Date(storedData.timestamp);\n        let serverDate = new Date(data.timestamp);\n        return serverDate >= storageDate;\n    }\n    // Return the key which to be used when accessing local storage.\n    localStorageKey() {\n        return (\n            eBookConfig.email +\n            \":\" +\n            eBookConfig.course +\n            \":\" +\n            this.divid +\n            \"-given\"\n        );\n    }\n    addCaption(elType) {\n        //someElement.parentNode.insertBefore(newElement, someElement.nextSibling);\n        if (!this.isTimed) {\n            var capDiv = document.createElement(\"p\");\n            if (this.question_label) {\n                this.caption = `Activity: ${this.question_label} ${this.caption}  <span class=\"runestone_caption_divid\">(${this.divid})</span>`;\n                $(capDiv).html(this.caption);\n                $(capDiv).addClass(`${elType}_caption`);\n            } else {\n                $(capDiv).html(this.caption + \" (\" + this.divid + \")\");\n                $(capDiv).addClass(`${elType}_caption`);\n                $(capDiv).addClass(`${elType}_caption_text`);\n            }\n            this.capDiv = capDiv;\n            //this.outerDiv.parentNode.insertBefore(capDiv, this.outerDiv.nextSibling);\n            this.containerDiv.appendChild(capDiv);\n        }\n    }\n\n    hasUserActivity() {\n        return this.isAnswered;\n    }\n\n    checkCurrentAnswer() {\n        console.log(\n            \"Each component should provide an implementation of checkCurrentAnswer\"\n        );\n    }\n\n    async logCurrentAnswer() {\n        console.log(\n            \"Each component should provide an implementation of logCurrentAnswer\"\n        );\n    }\n    renderFeedback() {\n        console.log(\n            \"Each component should provide an implementation of renderFeedback\"\n        );\n    }\n    disableInteraction() {\n        console.log(\n            \"Each component should provide an implementation of disableInteraction\"\n        );\n    }\n\n    toString() {\n        return `${this.constructor.name}: ${this.divid}`;\n    }\n\n    queueMathJax(component) {\n        if (MathJax.version.substring(0, 1) === \"2\") {\n            MathJax.Hub.Queue([\"Typeset\", MathJax.Hub, component]);\n        } else {\n            MathJax.typesetPromise([component]);\n        }\n    }\n}\n\nwindow.RunestoneBase = RunestoneBase;\n","$.i18n().load({\n    en: {\n        msg_no_answer: \"No answer provided.\",\n        msg_fitb_check_me: \"Check me\",\n        msg_fitb_compare_me: \"Compare me\",\n    },\n});\n","$.i18n().load({\n    \"pt-br\": {\n        msg_no_answer: \"Nenhuma resposta dada.\",\n        msg_fitb_check_me: \"Verificar\",\n        msg_fitb_compare_me: \"Comparar\"\n    },\n});\n","// *********\n// |docname|\n// *********\n// This file contains the JS for the Runestone fillintheblank component. It was created By Isaiah Mayerchak and Kirby Olson, 6/4/15 then revised by Brad Miller, 2/7/20.\n\"use strict\";\n\nimport RunestoneBase from \"../../common/js/runestonebase.js\";\nimport \"./fitb-i18n.en.js\";\nimport \"./fitb-i18n.pt-br.js\";\nimport \"../css/fitb.css\";\n\nexport var FITBList = {}; // Object containing all instances of FITB that aren't a child of a timed assessment.\n\n// FITB constructor\nexport default class FITB extends RunestoneBase {\n    constructor(opts) {\n        super(opts);\n        var orig = opts.orig; // entire <p> element\n        this.useRunestoneServices = opts.useRunestoneServices;\n        this.origElem = orig;\n        this.divid = orig.id;\n        this.correct = null;\n        // See comments in fitb.py for the format of ``feedbackArray`` (which is identical in both files).\n        //\n        // Find the script tag containing JSON and parse it. See `SO <https://stackoverflow.com/questions/9320427/best-practice-for-embedding-arbitrary-json-in-the-dom>`_. If this parses to ``false``, then no feedback is available; server-side grading will be performed.\n        this.feedbackArray = JSON.parse(\n            this.scriptSelector(this.origElem).html()\n        );\n        this.createFITBElement();\n        this.caption = \"Fill in the Blank\";\n        this.addCaption(\"runestone\");\n        this.checkServer(\"fillb\", true);\n    }\n    // Find the script tag containing JSON in a given root DOM node.\n    scriptSelector(root_node) {\n        return $(root_node).find(`script[type=\"application/json\"]`);\n    }\n    /*===========================================\n    ====   Functions generating final HTML   ====\n    ===========================================*/\n    createFITBElement() {\n        this.renderFITBInput();\n        this.renderFITBButtons();\n        this.renderFITBFeedbackDiv();\n        // replaces the intermediate HTML for this component with the rendered HTML of this component\n        $(this.origElem).replaceWith(this.containerDiv);\n    }\n    renderFITBInput() {\n        // The text [input] elements are created by the template.\n        this.containerDiv = document.createElement(\"div\");\n        $(this.containerDiv).addClass(\"alert alert-warning\");\n        this.containerDiv.id = this.divid;\n        // Copy the original elements to the container holding what the user will see.\n        $(this.origElem).children().clone().appendTo(this.containerDiv);\n        // Remove the script tag.\n        this.scriptSelector(this.containerDiv).remove();\n        // Set the class for the text inputs, then store references to them.\n        let ba = $(this.containerDiv).find(\":input\");\n        ba.attr(\"class\", \"form form-control selectwidthauto\");\n        ba.attr(\"aria-label\", \"input area\");\n        this.blankArray = ba.toArray();\n        // When a blank is changed mark this component as interacted with.\n        // And set a class on the component in case we want to render components that have been used\n        // differently\n        for (let blank of this.blankArray) {\n            $(blank).change(this.recordAnswered.bind(this));\n        }\n    }\n\n    recordAnswered() {\n        this.isAnswered = true;\n        //let rcontainer = this.containerDiv.closest(\".runestone\");\n        //rcontainer.addClass(\"answered\");\n    }\n\n    renderFITBButtons() {\n        // \"submit\" button and \"compare me\" button\n        this.submitButton = document.createElement(\"button\");\n        this.submitButton.textContent = $.i18n(\"msg_fitb_check_me\");\n        $(this.submitButton).attr({\n            class: \"btn btn-success\",\n            name: \"do answer\",\n            type: \"button\",\n        });\n        this.submitButton.addEventListener(\n            \"click\",\n            function () {\n                this.checkCurrentAnswer();\n                this.logCurrentAnswer();\n            }.bind(this),\n            false\n        );\n        this.containerDiv.appendChild(document.createElement(\"br\"));\n        this.containerDiv.appendChild(document.createElement(\"br\"));\n        this.containerDiv.appendChild(this.submitButton);\n        if (this.useRunestoneServices) {\n            this.compareButton = document.createElement(\"button\");\n            $(this.compareButton).attr({\n                class: \"btn btn-default\",\n                id: this.origElem.id + \"_bcomp\",\n                disabled: \"\",\n                name: \"compare\",\n            });\n            this.compareButton.textContent = $.i18n(\"msg_fitb_compare_me\");\n            this.compareButton.addEventListener(\n                \"click\",\n                function () {\n                    this.compareFITBAnswers();\n                }.bind(this),\n                false\n            );\n            this.containerDiv.appendChild(this.compareButton);\n        }\n        this.containerDiv.appendChild(document.createElement(\"div\"));\n    }\n    renderFITBFeedbackDiv() {\n        this.feedBackDiv = document.createElement(\"div\");\n        this.feedBackDiv.id = this.divid + \"_feedback\";\n        this.containerDiv.appendChild(document.createElement(\"br\"));\n        this.containerDiv.appendChild(this.feedBackDiv);\n    }\n    /*===================================\n    === Checking/loading from storage ===\n    ===================================*/\n    restoreAnswers(data) {\n        var arr;\n        // Restore answers from storage retrieval done in RunestoneBase.\n        try {\n            // The newer format encodes data as a JSON object.\n            arr = JSON.parse(data.answer);\n            // The result should be an array. If not, try comma parsing instead.\n            if (!Array.isArray(arr)) {\n                throw new Error();\n            }\n        } catch (err) {\n            // The old format didn't.\n            arr = data.answer.split(\",\");\n        }\n        for (var i = 0; i < this.blankArray.length; i++) {\n            $(this.blankArray[i]).attr(\"value\", arr[i]);\n        }\n        // Use the feedback from the server, or recompute it locally.\n        if (!this.feedbackArray) {\n            this.displayFeed = data.displayFeed;\n            this.correct = data.correct;\n            this.isCorrectArray = data.isCorrectArray;\n            // Only render if all the data is present; local storage might have old data missing some of these items.\n            if (\n                typeof this.displayFeed !== \"undefined\" &&\n                typeof this.correct !== \"undefined\" &&\n                typeof this.isCorrectArray !== \"undefined\"\n            ) {\n                this.renderFeedback();\n            }\n        } else {\n            this.checkCurrentAnswer();\n        }\n    }\n    checkLocalStorage() {\n        // Loads previous answers from local storage if they exist\n        var storedData;\n        if (this.graderactive) {\n            return;\n        }\n        var len = localStorage.length;\n        if (len > 0) {\n            var ex = localStorage.getItem(this.localStorageKey());\n            if (ex !== null) {\n                try {\n                    storedData = JSON.parse(ex);\n                    var arr = storedData.answer;\n                } catch (err) {\n                    // error while parsing; likely due to bad value stored in storage\n                    console.log(err.message);\n                    localStorage.removeItem(this.localStorageKey());\n                    return;\n                }\n                this.restoreAnswers(storedData);\n            }\n        }\n    }\n    setLocalStorage(data) {\n        let key = this.localStorageKey();\n        localStorage.setItem(key, JSON.stringify(data));\n    }\n\n    checkCurrentAnswer() {\n        // Start of the evaluation chain\n        this.isCorrectArray = [];\n        this.displayFeed = [];\n        this.given_arr = [];\n        for (var i = 0; i < this.blankArray.length; i++)\n            this.given_arr.push(this.blankArray[i].value);\n        if (this.useRunestoneServices) {\n            if (eBookConfig.enableCompareMe) {\n                this.enableCompareButton();\n            }\n        }\n        // Grade locally if we can't ask the server to grade.\n        if (this.feedbackArray) {\n            this.evaluateAnswers();\n            if (!this.isTimed) {\n                this.renderFeedback();\n            }\n        }\n    }\n\n    async logCurrentAnswer(sid) {\n        let answer = JSON.stringify(this.given_arr);\n        // Save the answer locally.\n        let feedback = true;\n        this.setLocalStorage({\n            answer: answer,\n            timestamp: new Date(),\n        });\n        let data = {\n            event: \"fillb\",\n            act: answer,\n            answer: answer,\n            correct: this.correct ? \"T\" : \"F\",\n            div_id: this.divid,\n        };\n        if (typeof sid !== \"undefined\") {\n            data.sid = sid;\n            feedback = false;\n        };\n        data = await this.logBookEvent(data);\n        data = data.detail;\n        if (!feedback) return;\n        if (!this.feedbackArray) {\n            // On success, update the feedback from the server's grade.\n            this.setLocalStorage({\n                answer: answer,\n                timestamp: data.timestamp,\n            });\n            this.correct = data.correct;\n            this.displayFeed = data.displayFeed;\n            this.isCorrectArray = data.isCorrectArray;\n            if (!this.isTimed) {\n                this.renderFeedback();\n            }\n        }\n        return data;\n    }\n\n    /*==============================\n    === Evaluation of answer and ===\n    ===     display feedback     ===\n    ==============================*/\n    // Inputs:\n    //\n    // - Strings entered by the student in ``this.blankArray[i].value``.\n    // - Feedback in ``this.feedbackArray``.\n    //\n    // Outputs:\n    //\n    // - ``this.displayFeed`` is an array of HTML feedback.\n    // - ``this.isCorrectArray`` is an array of true, false, or null (the question wasn't answered).\n    // - ``this.correct`` is true, false, or null (the question wasn't answered).\n    evaluateAnswers() {\n        // Keep track if all answers are correct or not.\n        this.correct = true;\n        for (var i = 0; i < this.blankArray.length; i++) {\n            var given = this.blankArray[i].value;\n            // If this blank is empty, provide no feedback for it.\n            if (given === \"\") {\n                this.isCorrectArray.push(null);\n                this.displayFeed.push($.i18n(\"msg_no_answer\"));\n                this.correct = false;\n            } else {\n                // Look through all feedback for this blank. The last element in the array always matches. If no feedback for this blank exists, use an empty list.\n                var fbl = this.feedbackArray[i] || [];\n                for (var j = 0; j < fbl.length; j++) {\n                    // The last item of feedback always matches.\n                    if (j === fbl.length - 1) {\n                        this.displayFeed.push(fbl[j][\"feedback\"]);\n                        break;\n                    }\n                    // If this is a regexp...\n                    if (\"regex\" in fbl[j]) {\n                        var patt = RegExp(\n                            fbl[j][\"regex\"],\n                            fbl[j][\"regexFlags\"]\n                        );\n                        if (patt.test(given)) {\n                            this.displayFeed.push(fbl[j][\"feedback\"]);\n                            break;\n                        }\n                    } else {\n                        // This is a number.\n                        console.assert(\"number\" in fbl[j]);\n                        var [min, max] = fbl[j][\"number\"];\n                        // Convert the given string to a number. While there are `lots of ways <https://coderwall.com/p/5tlhmw/converting-strings-to-number-in-javascript-pitfalls>`_ to do this; this version supports other bases (hex/binary/octal) as well as floats.\n                        var actual = +given;\n                        if (actual >= min && actual <= max) {\n                            this.displayFeed.push(fbl[j][\"feedback\"]);\n                            break;\n                        }\n                    }\n                }\n                // The answer is correct if it matched the first element in the array. A special case: if only one answer is provided, count it wrong; this is a misformed problem.\n                let is_correct = j === 0 && fbl.length > 1;\n                this.isCorrectArray.push(is_correct);\n                if (!is_correct) {\n                    this.correct = false;\n                }\n            }\n        }\n        this.percent =\n            this.isCorrectArray.filter(Boolean).length / this.blankArray.length;\n    }\n\n    renderFeedback() {\n        if (this.correct) {\n            $(this.feedBackDiv).attr(\"class\", \"alert alert-info\");\n            for (let j = 0; j < this.blankArray.length; j++) {\n                $(this.blankArray[j]).removeClass(\"input-validation-error\");\n            }\n        } else {\n            if (this.displayFeed === null) {\n                this.displayFeed = \"\";\n            }\n            for (let j = 0; j < this.blankArray.length; j++) {\n                if (this.isCorrectArray[j] !== true) {\n                    $(this.blankArray[j]).addClass(\"input-validation-error\");\n                } else {\n                    $(this.blankArray[j]).removeClass(\"input-validation-error\");\n                }\n            }\n            $(this.feedBackDiv).attr(\"class\", \"alert alert-danger\");\n        }\n        var feedback_html = \"<ul>\";\n        for (var i = 0; i < this.displayFeed.length; i++) {\n            feedback_html += \"<li>\" + this.displayFeed[i] + \"</li>\";\n        }\n        feedback_html += \"</ul>\";\n        // Remove the list if it's just one element.\n        if (this.displayFeed.length == 1) {\n            feedback_html = feedback_html.slice(\n                \"<ul><li>\".length,\n                -\"</li></ul>\".length\n            );\n        }\n        this.feedBackDiv.innerHTML = feedback_html;\n        if (typeof MathJax !== \"undefined\") {\n            this.queueMathJax(document.body)\n        }\n    }\n\n    /*==================================\n    === Functions for compare button ===\n    ==================================*/\n    enableCompareButton() {\n        this.compareButton.disabled = false;\n    }\n    // _`compareFITBAnswers`\n    compareFITBAnswers() {\n        var data = {};\n        data.div_id = this.divid;\n        data.course = eBookConfig.course;\n        jQuery.get(\n            `${eBookConfig.new_server_prefix}/assessment/gettop10Answers`,\n            data,\n            this.compareFITB\n        );\n    }\n    compareFITB(data, status, whatever) {\n        var answers = data.detail.res;\n        var misc = data.detail.miscdata;\n        var body = \"<table>\";\n        body += \"<tr><th>Answer</th><th>Count</th></tr>\";\n        for (var row in answers) {\n            body +=\n                \"<tr><td>\" +\n                answers[row].answer +\n                \"</td><td>\" +\n                answers[row].count +\n                \" times</td></tr>\";\n        }\n        body += \"</table>\";\n        var html =\n            \"<div class='modal fade'>\" +\n            \"    <div class='modal-dialog compare-modal'>\" +\n            \"        <div class='modal-content'>\" +\n            \"            <div class='modal-header'>\" +\n            \"                <button type='button' class='close' data-dismiss='modal' aria-hidden='true'>&times;</button>\" +\n            \"                <h4 class='modal-title'>Top Answers</h4>\" +\n            \"            </div>\" +\n            \"            <div class='modal-body'>\" +\n            body +\n            \"            </div>\" +\n            \"        </div>\" +\n            \"    </div>\" +\n            \"</div>\";\n        var el = $(html);\n        el.modal();\n    }\n\n    disableInteraction() {\n        for (var i = 0; i < this.blankArray.length; i++) {\n            this.blankArray[i].disabled = true;\n        }\n    }\n}\n\n/*=================================\n== Find the custom HTML tags and ==\n==   execute our code on them    ==\n=================================*/\n$(document).bind(\"runestone:login-complete\", function () {\n    $(\"[data-component=fillintheblank]\").each(function (index) {\n        var opts = {\n            orig: this,\n            useRunestoneServices: eBookConfig.useRunestoneServices,\n        };\n        if ($(this).closest(\"[data-component=timedAssessment]\").length == 0) {\n            // If this element exists within a timed component, don't render it here\n            try {\n                FITBList[this.id] = new FITB(opts);\n            } catch (err) {\n                console.log(\n                    `Error rendering Fill in the Blank Problem ${this.id}\n                     Details: ${err}`\n                );\n            }\n        }\n    });\n});\n","import FITB from \"./fitb.js\";\nexport default class TimedFITB extends FITB {\n    constructor(opts) {\n        super(opts);\n        this.renderTimedIcon(this.inputDiv);\n        this.hideButtons();\n        this.needsReinitialization = true;\n    }\n    hideButtons() {\n        $(this.submitButton).hide();\n        $(this.compareButton).hide();\n    }\n    renderTimedIcon(component) {\n        // renders the clock icon on timed components.    The component parameter\n        // is the element that the icon should be appended to.\n        var timeIconDiv = document.createElement(\"div\");\n        var timeIcon = document.createElement(\"img\");\n        $(timeIcon).attr({\n            src: \"../_static/clock.png\",\n            style: \"width:15px;height:15px\",\n        });\n        timeIconDiv.className = \"timeTip\";\n        timeIconDiv.title = \"\";\n        timeIconDiv.appendChild(timeIcon);\n        $(component).prepend(timeIconDiv);\n    }\n    checkCorrectTimed() {\n        // Returns if the question was correct, incorrect, or skipped (return null in the last case)\n        switch (this.correct) {\n            case true:\n                return \"T\";\n            case false:\n                return \"F\";\n            default:\n                return null;\n        }\n    }\n    hideFeedback() {\n        for (var i = 0; i < this.blankArray.length; i++) {\n            $(this.blankArray[i]).removeClass(\"input-validation-error\");\n        }\n        this.feedBackDiv.style.display = \"none\";\n    }\n\n    reinitializeListeners() {\n        for (let blank of this.blankArray) {\n            $(blank).change(this.recordAnswered.bind(this));\n        }\n    }\n}\n\nif (typeof window.component_factory === \"undefined\") {\n    window.component_factory = {};\n}\nwindow.component_factory.fillintheblank = function (opts) {\n    if (opts.timed) {\n        return new TimedFITB(opts);\n    }\n    return new FITB(opts);\n};\n"],"names":["RunestoneBase","constructor","opts","this","component_ready_promise","Promise","resolve","_component_ready_resolve_fn","optional","window","allComponents","push","sid","graderactive","showfeedback","timed","isTimed","enforceDeadline","deadline","$","orig","data","selector_id","assessmentTaken","timedWrapper","location","href","indexOf","text","question_label","jsonHeaders","Headers","Accept","async","eventInfo","post_return","course_name","eBookConfig","course","clientLoginStatus","isLoggedIn","timezoneoffset","Date","getTimezoneOffset","percent","useRunestoneServices","logLevel","postLogMessage","debug","console","log","JSON","stringify","div_id","replace","event","act","request","Request","new_server_prefix","method","headers","body","response","fetch","ok","Error","json","e","alert","post_promise","forceSave","save_code","will_be_ready","self","checkServerComplete","reject","csresolver","divid","rawdeadline","tzoff","practice_mode","peer","loadData","detail","repopulateFromStorage","statusText","checkLocalStorage","err","indicate_component_ready","containerDiv","classList","add","shouldUseServer","restoreAnswers","setLocalStorage","correct","localStorage","length","storedData","ex","getItem","localStorageKey","parse","message","removeItem","answer","storageDate","timestamp","email","addCaption","elType","capDiv","document","createElement","caption","html","addClass","appendChild","hasUserActivity","isAnswered","checkCurrentAnswer","renderFeedback","disableInteraction","toString","name","queueMathJax","component","MathJax","version","substring","Hub","Queue","typesetPromise","i18n","load","en","msg_no_answer","msg_fitb_check_me","msg_fitb_compare_me","FITBList","FITB","super","origElem","id","feedbackArray","scriptSelector","createFITBElement","checkServer","root_node","find","renderFITBInput","renderFITBButtons","renderFITBFeedbackDiv","replaceWith","children","clone","appendTo","remove","ba","attr","blankArray","toArray","blank","change","recordAnswered","bind","submitButton","textContent","class","type","addEventListener","logCurrentAnswer","compareButton","disabled","compareFITBAnswers","feedBackDiv","arr","Array","isArray","split","i","displayFeed","isCorrectArray","key","setItem","given_arr","value","enableCompareMe","enableCompareButton","evaluateAnswers","feedback","logBookEvent","given","fbl","j","RegExp","test","assert","min","max","actual","is_correct","filter","Boolean","removeClass","feedback_html","slice","innerHTML","jQuery","get","compareFITB","status","whatever","answers","res","miscdata","row","count","modal","each","index","closest","TimedFITB","renderTimedIcon","inputDiv","hideButtons","needsReinitialization","hide","timeIconDiv","timeIcon","src","style","className","title","prepend","checkCorrectTimed","hideFeedback","display","reinitializeListeners","component_factory","fillintheblank"],"sourceRoot":""}